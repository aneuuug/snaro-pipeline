<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SNARO — Pipeline</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&display=swap" rel="stylesheet">
    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Datos SABI - 10.141 empresas -->
    <script src="empresas_sabi.js"></script>
    <style>
        /* Connection Status Badge */
        .connection-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 6px;
        }
        .connection-badge.online { background: #d4edda; color: #155724; }
        .connection-badge.offline { background: #fff3cd; color: #856404; }
        .connection-badge .dot { width: 6px; height: 6px; border-radius: 50%; }
        .connection-badge.online .dot { background: #28a745; }
        .connection-badge.offline .dot { background: #ffc107; }

        /* Dark mode toggle */
        .theme-toggle {
            position: fixed;
            top: 12px;
            right: 90px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 1px solid #e0e0e0;
            background: #fff;
            cursor: pointer;
            font-size: 12px;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .theme-toggle:hover { background: #f5f5f5; }
        .theme-toggle.header-theme { display: none; }

        /* Dark mode styles */
        /* ============================================ */
        /* MODO OSCURO COMPLETO                         */
        /* ============================================ */
        body.dark { background: #141414; color: #e8e8e8; }

        /* Layout principal */
        body.dark .header { background: #141414; border-bottom-color: #2a2a2a; }
        body.dark .sidebar { background: #141414; border-right-color: #2a2a2a; }
        body.dark .main-content { background: #1a1a1a; }
        body.dark .logo-text { color: #fff; }
        body.dark .user-name { color: #bbb; }
        body.dark .sidebar-title { color: #888; }
        body.dark .sidebar-item { color: #aaa; }
        body.dark .sidebar-item:hover, body.dark .sidebar-item.active { color: #fff; background: transparent; }
        body.dark .page-title { color: #ddd; }

        /* Pipeline columnas — cada etapa con su color */
        body.dark .pipeline-column { background: #1e1e1e; }
        body.dark .column-header { border-bottom-color: #333; }
        body.dark .column-header h3 { color: #ddd; }
        body.dark .column-count { color: #bbb; }
        body.dark .col-contactado { background: #161d2a; }
        body.dark .col-contactado .column-count { color: #60a5fa; }
        body.dark .col-reunion { background: #231c10; }
        body.dark .col-reunion .column-count { color: #fbbf24; }
        body.dark .col-piloto { background: #1d162a; }
        body.dark .col-piloto .column-count { color: #a78bfa; }
        body.dark .col-cliente { background: #142214; }
        body.dark .col-cliente .column-count { color: #4ade80; }

        /* Tarjetas pipeline */
        body.dark .pipeline-card { background: #262626; border-color: #333; }
        body.dark .pipeline-card:hover { background: #333; }
        body.dark .client-card { background: #262626; border: 1px solid #333; }
        body.dark .client-card:hover { background: #303030; box-shadow: 0 4px 12px rgba(0,0,0,0.4); }
        body.dark .client-card .name { color: #fff; font-weight: 400; }
        body.dark .client-card .sector { color: #aaa; }
        body.dark .client-card .mrr { color: #ccc; }
        body.dark .client-card .mrr.active { color: #4ade80; }
        body.dark .card-date { color: #fb923c; }
        body.dark .empty-column { color: #666; }

        /* Prospect cards (vista lista) */
        body.dark .prospect-card { background: #222; border-color: #333; }
        body.dark .prospect-card:hover { background: #2a2a2a; }
        body.dark .prospect-card-enhanced { background: #222; border-color: #333; }
        body.dark .prospect-card-enhanced:hover { background: #2a2a2a; border-color: #444; }
        body.dark .prospect-main-info .company-name { color: #fff; }
        body.dark .tag-sector { background: #2a2a2a; color: #ddd; border: 1px solid #444; }
        body.dark .tag-location { background: #162030; color: #7dc4ff; border: 1px solid #1a3050; }
        body.dark .prospect-revenue-section { background: transparent; }
        body.dark .prospect-revenue-section .revenue-amount { color: #fff; }
        body.dark .revenue-amount { color: #fff; }
        body.dark .revenue-unit { color: #999; }

        /* Botones */
        body.dark .btn { background: #2a2a2a; color: #e0e0e0; border: 1px solid #444; }
        body.dark .btn:hover { background: #fff; color: #000; }
        body.dark .btn-primary { background: #fff; color: #000; border-color: #fff; }
        body.dark .btn-primary:hover { background: #e0e0e0; }
        body.dark .btn-add { background: rgba(255,255,255,0.1); color: #ddd; }
        body.dark .btn-add:hover { background: rgba(255,255,255,0.2); }
        body.dark .action-btn.primary { background: transparent; border-color: #555; color: #bbb; }
        body.dark .action-btn.primary:hover { border-color: #888; color: #fff; }
        body.dark .action-btn.secondary { background: #333; color: #ccc; }
        body.dark .action-btn.secondary:hover { background: #444; color: #fff; }
        body.dark .card-dismiss-btn { color: #666; }
        body.dark .card-dismiss-btn:hover { background: #333; color: #bbb; }
        body.dark .prospect-card-enhanced:hover .card-dismiss-btn { opacity: 1; }
        body.dark .detail-contact-btn { border-color: #555; color: #bbb; }
        body.dark .detail-contact-btn:hover { border-color: #888; color: #fff; }

        /* Modales */
        body.dark .modal-overlay { background: rgba(0,0,0,0.88); }
        body.dark .modal { background: #1e1e1e; border: 1px solid #333; }
        body.dark .modal-header { border-bottom-color: #333; }
        body.dark .modal-header h2 { color: #ddd; }
        body.dark .modal-close { color: #888; }
        body.dark .modal-close:hover { color: #fff; }

        /* Formularios */
        body.dark input, body.dark select, body.dark textarea { background: #2a2a2a; border-color: #444; color: #e8e8e8; }
        body.dark input:focus, body.dark select:focus, body.dark textarea:focus { border-color: #666; }
        body.dark .form-group label { color: #bbb; }
        body.dark input::placeholder, body.dark textarea::placeholder { color: #666; }
        body.dark .form-buttons .btn { border-color: #444; }

        /* Tabs */
        body.dark .tabs { border-bottom-color: #333; }
        body.dark .tabs .tab { color: #888; }
        body.dark .tabs .tab:hover { color: #ddd; }
        body.dark .tabs .tab.active { color: #fff; border-bottom-color: #fff; }

        /* Detail view */
        body.dark .client-detail-header h2 { color: #fff; }
        body.dark .client-detail-header .sector { color: #aaa; }
        body.dark .status-badge { background: #333; color: #ccc; border: 1px solid #444; }
        body.dark .status-badge.active { background: #fff; color: #000; }
        body.dark .detail-grid, body.dark .info-section { background: #222; }
        body.dark .info-grid { background: transparent; }
        body.dark .info-item { border-bottom-color: #2a2a2a; }
        body.dark .info-item .label { color: #999; }
        body.dark .info-item .value { color: #eee; }
        body.dark .notes-box { background: #262626; color: #ccc; }
        body.dark .move-section { border-top-color: #333; }
        body.dark .move-section select { background: #2a2a2a; border-color: #444; color: #e0e0e0; }

        /* Actividad */
        body.dark .activity-icon { background: #2a2a2a; color: #ccc; }
        body.dark .activity-content strong { color: #eee; }
        body.dark .activity-content p { color: #aaa; }
        body.dark .activity-date { color: #777; }

        /* Investigación */
        body.dark .investigation-box { background: #222; }
        body.dark .investigation-box h4 { color: #ddd; }
        body.dark .investigation-box .spinner { border-color: #444; border-top-color: #fff; }
        body.dark .investigation-box .loading-text { color: #aaa; }
        body.dark .alert-item .icon { color: #888; }
        body.dark .alert-item .text { color: #eee; }
        body.dark .alert-item .date { color: #999; }
        body.dark .opportunity-item { color: #ccc; }

        /* Tabla */
        body.dark .prospect-table { border-color: #333; }
        body.dark .prospect-table th { background: #222; border-color: #333; color: #bbb; }
        body.dark .prospect-table td { border-color: #2a2a2a; color: #ddd; }
        body.dark .prospect-table tr:hover td { background: #262626; }
        body.dark .prospect-table .company-name { color: #fff; }
        body.dark .prospect-table .badge-high { background: #fff; color: #000; }
        body.dark .prospect-table .badge-medium { background: #444; color: #eee; }
        body.dark .prospect-table .badge-low { background: #333; color: #aaa; }
        body.dark .quick-btn { background: #2a2a2a; border-color: #444; color: #bbb; }
        body.dark .quick-btn:hover { background: #444; color: #fff; }
        body.dark .quick-btn.interested { color: #4ade80; border-color: #4ade80; }
        body.dark .quick-btn.not-interested { color: #f87171; border-color: #f87171; }

        /* Tier badges */
        body.dark .tier-enterprise { background: #2a2a4e; color: #b8b8e8; }
        body.dark .tier-midmarket { background: #1a3050; color: #8cc8ff; }
        body.dark .tier-pyme { background: #1a3a3a; color: #7ee0e0; }
        body.dark .tier-micro { background: #3a2a1a; color: #e8b878; }

        /* Revenue bar */
        body.dark .revenue-bar-container { background: #2a2a2a; }

        /* Stats dashboard */
        body.dark .stats-dashboard { background: linear-gradient(135deg, #181818 0%, #111 100%); }
        body.dark .metric-label { color: #aaa; }
        body.dark .metric-value { color: #fff; }
        body.dark .main-metric .metric-label { color: #999; }

        /* Filtros */
        body.dark .filter-select, body.dark .filter-select-small { background: #2a2a2a; border-color: #444; color: #e0e0e0; }
        body.dark .view-btn { background: #2a2a2a; border-color: #444; color: #bbb; }
        body.dark .view-btn:hover { background: #333; }
        body.dark .view-btn.active { background: #fff; color: #000; }
        body.dark .filter-pill { background: #2a2a2a; border-color: #444; color: #ddd; }
        body.dark .filter-pill:hover { border-color: #888; }
        body.dark .filter-pill.active { background: #fff; color: #000; border-color: #fff; }

        /* Charts */
        body.dark .chart-card { background: #1e1e1e; border-color: #333; }
        body.dark .chart-card h3 { color: #fff; }
        body.dark .chart-bar-label { color: #ccc; }
        body.dark .chart-bar-container { background: #2a2a2a; }
        body.dark .chart-bar-value { color: #eee; }

        /* Conexión & theme toggle */
        body.dark .theme-toggle { background: #2a2a2a; border-color: #444; }
        body.dark .theme-toggle:hover { background: #444; }
        body.dark .connection-badge.online { background: #142a14; color: #6fcf97; border: 1px solid #1a3a1a; }
        body.dark .connection-badge.offline { background: #2a2210; color: #f2c94c; border: 1px solid #3d3520; }
        body.dark #syncBtn { background: #1e1e1e; color: #ccc; border-color: #444; }

        /* Estados vacíos */
        body.dark .empty-state { color: #999; }
        body.dark .empty-state .empty-hint { color: #777; }

        /* Resumen */
        body.dark .summary-label { color: #aaa; }
        body.dark .summary-hint { color: #888; }
        body.dark h5 { color: #ddd; }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            font-weight: 300;
            color: #000;
            background: #fff;
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        /* Header */
        .header {
            padding: 16px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #f0f0f0;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 14px;
            cursor: pointer;
        }

        .logo-container:hover .logo {
            opacity: 0.8;
        }

        .logo-container:hover .logo-text {
            color: #666;
        }

        .logo {
            height: 36px;
            width: auto;
            transition: opacity 0.2s;
        }

        .logo-text {
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 0.25em;
            color: #bbb;
            text-transform: uppercase;
            transition: color 0.2s;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-name {
            font-size: 13px;
            color: #666;
        }

        .user-avatar {
            width: 32px;
            height: 32px;
            background: #000;
            color: #fff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 400;
        }

        /* Layout */
        .main-container {
            display: flex;
            min-height: calc(100vh - 81px);
        }

        /* Sidebar */
        .sidebar {
            width: 200px;
            padding: 40px 24px 0;
            border-right: 1px solid #f0f0f0;
            display: flex;
            flex-direction: column;
            height: calc(100vh - 60px);
            position: sticky;
            top: 60px;
        }

        .sidebar-section {
            margin-bottom: 40px;
        }

        .sidebar-title {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 20px;
        }

        .sidebar-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 0;
            cursor: pointer;
            font-size: 13px;
            color: #666;
            transition: color 0.2s;
        }

        .sidebar-item:hover {
            color: #000;
        }

        .sidebar-item.active {
            color: #000;
            font-weight: 400;
        }

        .team-avatar {
            width: 24px;
            height: 24px;
            background: #f0f0f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: #666;
        }

        /* Content */
        .content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        /* Pipeline Summary */
        .pipeline-summary {
            display: flex;
            align-items: baseline;
            gap: 48px;
            margin-bottom: 48px;
            padding-bottom: 32px;
            border-bottom: 1px solid #f0f0f0;
        }

        .pipeline-metric {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .metric-value {
            font-size: 36px;
            font-weight: 300;
            letter-spacing: -0.02em;
        }

        .metric-value.small {
            font-size: 24px;
        }

        .metric-label {
            font-size: 11px;
            color: #999;
        }

        .main-metric .metric-value {
            font-size: 42px;
        }

        .main-metric .metric-label {
            color: #666;
        }

        /* Top Actions */
        .top-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .page-title {
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 0;
            border: 1px solid #000;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            font-weight: 400;
            transition: all 0.2s;
            background: #fff;
            color: #000;
        }

        .btn:hover {
            background: #000;
            color: #fff;
        }

        .btn-primary {
            background: #000;
            color: #fff;
        }

        .btn-primary:hover {
            background: #333;
        }

        .btn-add {
            position: fixed;
            bottom: 32px;
            right: 32px;
            width: 50px;
            height: 50px;
            border-radius: 14px;
            border: none;
            background: rgba(255,255,255,0.7);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            color: #000;
            font-size: 26px;
            font-weight: 300;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            padding: 0;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.05);
            z-index: 100;
        }

        .btn-add:hover {
            background: rgba(255,255,255,0.85);
            transform: scale(1.05);
        }

        /* Pipeline Board */
        .pipeline-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
        }

        .pipeline-column {
            background: #f8f8f8;
            padding: 20px;
            min-height: 400px;
            border-radius: 8px;
        }

        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 16px;
            margin-bottom: 12px;
        }

        .column-header h3 {
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.08em;
            text-transform: uppercase;
            color: #999;
        }

        .column-count {
            font-size: 11px;
            font-weight: 400;
            color: #666;
        }

        /* Semáforo */
        .semaforo {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 8px;
            flex-shrink: 0;
        }

        /* Client Cards */
        .client-card {
            position: relative;
            padding: 16px;
            margin-bottom: 8px;
            background: #fff;
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 4px;
            overflow: hidden;
        }

        .client-card:hover {
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }

        .client-card:last-child {
            margin-bottom: 0;
        }

        .client-card .name {
            font-size: 14px;
            font-weight: 400;
            margin-bottom: 4px;
        }

        .client-card .sector {
            font-size: 11px;
            color: #999;
            margin-bottom: 8px;
        }

        .client-card .mrr {
            font-size: 13px;
            color: #666;
            font-weight: 400;
        }

        .client-card .mrr.active {
            color: #22c55e;
        }

        .client-card.has-date {
            position: relative;
            padding-top: 32px;
        }

        .card-date {
            position: absolute;
            top: 12px;
            right: 12px;
            font-size: 10px;
            font-weight: 500;
            color: #f97316;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .col-cliente {
            background: #f8fdf8;
        }

        .col-cliente .column-count {
            color: #22c55e;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            z-index: 1000;
            justify-content: center;
            align-items: flex-start;
            padding: 60px 40px;
            overflow-y: auto;
        }

        .modal-overlay.active {
            display: flex;
        }

        .modal {
            background: #fff;
            width: 100%;
            max-width: 640px;
            border: 1px solid #e0e0e0;
        }

        .modal-header {
            padding: 24px 32px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
        }

        .modal-close {
            background: none;
            border: none;
            color: #999;
            font-size: 20px;
            cursor: pointer;
            padding: 0;
            line-height: 1;
        }

        .modal-close:hover {
            color: #000;
        }

        .modal-body {
            padding: 32px;
        }

        .detail-contact-btn {
            display: inline-block;
            background: transparent;
            border: 1px solid #ddd;
            border-radius: 0;
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: #888;
            padding: 10px 32px;
            cursor: pointer;
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }
        .detail-contact-btn:hover {
            border-color: #999;
            color: #555;
        }
        /* Form */
        .form-group {
            margin-bottom: 24px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 0;
            background: transparent;
            border: none;
            border-bottom: 1px solid #e0e0e0;
            color: #000;
            font-family: 'Inter', sans-serif;
            font-size: 14px;
            font-weight: 300;
            transition: border-color 0.2s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #000;
        }

        .form-group input::placeholder,
        .form-group textarea::placeholder {
            color: #ccc;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 32px;
        }

        /* Investigation Results */
        .investigation-box {
            background: #fafafa;
            padding: 32px;
            margin-top: 32px;
        }

        .investigation-box h4 {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 24px;
        }

        .investigation-box.loading {
            text-align: center;
            padding: 48px;
        }

        .investigation-box .spinner {
            width: 24px;
            height: 24px;
            border: 1px solid #e0e0e0;
            border-top-color: #000;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }

        .investigation-box .loading-text {
            font-size: 12px;
            color: #999;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 24px;
        }

        .info-item {
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item .label {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 6px;
        }

        .info-item .value {
            font-size: 16px;
            font-weight: 300;
        }

        .alerts-section {
            margin-top: 32px;
        }

        .alerts-section h5 {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 16px;
        }

        .alert-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            padding: 16px 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
        }

        .alert-item:last-child {
            border-bottom: none;
        }

        .alert-item .icon {
            color: #999;
        }

        .alert-item .text {
            color: #000;
        }

        .alert-item .date {
            font-size: 11px;
            color: #999;
            margin-top: 4px;
        }

        .alert-item.critical .icon {
            color: #000;
        }

        .opportunities-section {
            margin-top: 32px;
        }

        .opportunities-section h5 {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 16px;
        }

        .opportunity-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 13px;
            color: #444;
        }

        .opportunity-item:last-child {
            border-bottom: none;
        }

        /* Client Detail Modal */
        .client-detail-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 40px;
        }

        .client-detail-header h2 {
            font-size: 24px;
            font-weight: 300;
            letter-spacing: -0.02em;
            margin-bottom: 4px;
        }

        .client-detail-header .sector {
            font-size: 13px;
            color: #999;
        }

        .status-badge {
            font-size: 10px;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            padding: 8px 16px;
            background: #f5f5f5;
            color: #666;
        }

        .status-badge.active {
            background: #000;
            color: #fff;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 32px;
            margin-bottom: 32px;
            border-bottom: 1px solid #f0f0f0;
        }

        .tab {
            padding: 16px 0;
            font-size: 12px;
            color: #999;
            cursor: pointer;
            border-bottom: 1px solid transparent;
            margin-bottom: -1px;
            transition: all 0.2s;
        }

        .tab:hover {
            color: #666;
        }

        .tab.active {
            color: #000;
            border-color: #000;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Activity Log */
        .activity-log {
            list-style: none;
        }

        .activity-item {
            display: flex;
            gap: 16px;
            padding: 20px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            width: 32px;
            height: 32px;
            background: #f5f5f5;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            flex-shrink: 0;
        }

        .activity-content {
            flex: 1;
        }

        .activity-content strong {
            display: block;
            font-size: 13px;
            font-weight: 400;
            margin-bottom: 4px;
        }

        .activity-content p {
            font-size: 12px;
            color: #999;
        }

        .activity-date {
            font-size: 11px;
            color: #ccc;
        }

        /* Notes */
        .notes-box {
            background: #fafafa;
            padding: 24px;
            font-size: 13px;
            color: #666;
            line-height: 1.7;
        }

        /* Action buttons */
        .action-buttons {
            display: flex;
            gap: 12px;
            margin-top: 32px;
        }

        .action-buttons .btn {
            font-size: 11px;
        }

        /* Move selector */
        /* Informes */
        .informe-stage { margin-bottom: 40px; }
        .informe-stage-title {
            font-size: 10px; font-weight: 500; letter-spacing: 0.15em;
            text-transform: uppercase; color: #999; margin-bottom: 16px;
            padding-bottom: 8px; border-bottom: 1px solid #f0f0f0;
        }
        .informe-card {
            background: #fafafa; border-radius: 8px; padding: 24px;
            margin-bottom: 12px; cursor: pointer; transition: all 0.2s;
            border-left: 4px solid #e0e0e0;
        }
        .informe-card:hover { background: #f0f0f0; }
        .informe-card.stage-contactado { border-left-color: #3b82f6; }
        .informe-card.stage-reunion { border-left-color: #f59e0b; }
        .informe-card.stage-piloto { border-left-color: #8b5cf6; }
        .informe-card.stage-cliente { border-left-color: #22c55e; }
        .informe-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
        .informe-name { font-size: 16px; font-weight: 400; }
        .informe-badge {
            font-size: 10px; font-weight: 500; letter-spacing: 0.05em;
            padding: 4px 10px; border-radius: 12px; text-transform: uppercase;
        }
        .informe-badge.porcontactar { background: #f3f4f6; color: #374151; }
        .informe-badge.contactado { background: #dbeafe; color: #1e40af; }
        .informe-badge.reunion { background: #fef3c7; color: #92400e; }
        .informe-badge.piloto { background: #ede9fe; color: #5b21b6; }
        .informe-badge.cliente { background: #d1fae5; color: #065f46; }
        .informe-grid {
            display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px;
        }
        .informe-dato-label { font-size: 10px; color: #999; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 2px; }
        .informe-dato-value { font-size: 14px; font-weight: 300; }
        .informe-notes { margin-top: 12px; font-size: 12px; color: #666; font-style: italic; }
        .informe-empty { text-align: center; padding: 60px 20px; color: #999; font-size: 13px; }
        body.dark .informe-card { background: #222; border-left-color: #666; }
        body.dark .informe-card:hover { background: #2a2a2a; }
        body.dark .informe-card.stage-contactado { border-left-color: #60a5fa; }
        body.dark .informe-card.stage-reunion { border-left-color: #fbbf24; }
        body.dark .informe-card.stage-piloto { border-left-color: #a78bfa; }
        body.dark .informe-card.stage-cliente { border-left-color: #4ade80; }
        body.dark .informe-stage-title { border-bottom-color: #333; color: #aaa; }
        body.dark .informe-name { color: #fff; font-weight: 400; }
        body.dark .informe-dato-label { color: #999; }
        body.dark .informe-dato-value { color: #eee; }
        body.dark .informe-notes { color: #bbb; }
        body.dark .informe-badge.porcontactar { background: #333; color: #ccc; }
        body.dark .informe-badge.contactado { background: #1a2e4e; color: #7db8f0; }
        body.dark .informe-badge.reunion { background: #3d2e10; color: #fbbf24; }
        body.dark .informe-badge.piloto { background: #2d1f5e; color: #b09cf5; }
        body.dark .informe-badge.cliente { background: #143a20; color: #6fcf97; }

        .move-section {
            margin-top: 40px;
            padding-top: 32px;
            border-top: 1px solid #f0f0f0;
            display: flex;
            gap: 16px;
            align-items: center;
        }

        .move-section select {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            background: #fff;
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            cursor: pointer;
        }

        .move-section select:focus {
            outline: none;
            border-color: #000;
        }

        /* Form buttons */
        .form-buttons {
            display: flex;
            gap: 16px;
            margin-top: 32px;
        }

        .form-buttons .btn {
            flex: 1;
        }

        /* Empty state */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 14px;
        }

        .empty-state .empty-hint {
            font-size: 12px;
            color: #ccc;
            margin-top: 8px;
        }

        .empty-column {
            text-align: center;
            padding: 40px 16px;
            color: #ccc;
            font-size: 12px;
        }

        /* View Summary */
        .view-summary {
            margin-bottom: 48px;
        }

        .summary-main {
            display: flex;
            align-items: baseline;
            gap: 12px;
            margin-bottom: 8px;
        }

        .summary-number {
            font-size: 48px;
            font-weight: 300;
            letter-spacing: -0.03em;
        }

        .summary-label {
            font-size: 16px;
            color: #666;
        }

        .summary-hint {
            font-size: 12px;
            color: #999;
        }

        /* Filters & Toolbar */
        .filter-select {
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-family: 'Inter', sans-serif;
            font-size: 13px;
            min-width: 150px;
            cursor: pointer;
            background: #fff;
        }
        .filter-select-small {
            padding: 8px 12px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            font-family: 'Inter', sans-serif;
            font-size: 12px;
            cursor: pointer;
            background: #fff;
        }
        .view-btn {
            width: 32px;
            height: 32px;
            border: 1px solid #e0e0e0;
            background: #fff;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            color: #666;
        }
        .view-btn:hover { background: #f5f5f5; }
        .view-btn.active { background: #000; color: #fff; border-color: #000; }

        /* Prospect List */
        .prospect-list {
            display: flex;
            flex-direction: column;
        }
        .prospect-list.table-view {
            display: block;
        }

        /* Table View */
        .prospect-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }
        .prospect-table th {
            text-align: left;
            padding: 12px 16px;
            font-weight: 500;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #666;
            border-bottom: 2px solid #e0e0e0;
            background: #fafafa;
        }
        .prospect-table td {
            padding: 14px 16px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }
        .prospect-table tr:hover td {
            background: #f9f9f9;
        }
        .prospect-table .company-name {
            font-weight: 500;
            cursor: pointer;
        }
        .prospect-table .company-name:hover {
            text-decoration: underline;
        }
        .prospect-table .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 500;
        }
        .prospect-table .badge-high { background: #000; color: #fff; }
        .prospect-table .badge-medium { background: #e0e0e0; color: #333; }
        .prospect-table .badge-low { background: #f5f5f5; color: #999; }
        .quick-actions {
            display: flex;
            gap: 8px;
        }
        .quick-btn {
            width: 28px;
            height: 28px;
            border: 1px solid #e0e0e0;
            border-radius: 6px;
            background: #fff;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .quick-btn:hover { background: #f0f0f0; }
        .quick-btn.interested { color: #22c55e; border-color: #22c55e; }
        .quick-btn.not-interested { color: #ef4444; border-color: #ef4444; }

        /* Revenue Tiers System */
        .tier-badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0;
        }
        .tier-enterprise { background: #e3e3f0; color: #2a2a4e; }
        .tier-midmarket { background: #e8f0f7; color: #0f4c75; }
        .tier-pyme { background: #e6f4f4; color: #0d7377; }
        .tier-micro { background: #f7ede6; color: #c2703a; }

        /* Revenue Bar */
        .revenue-bar-container {
            width: 100%;
            height: 4px;
            background: #f0f0f0;
            border-radius: 2px;
            margin-top: 8px;
            overflow: hidden;
        }
        .revenue-bar {
            height: 100%;
            border-radius: 2px;
            transition: width 0.3s ease;
        }
        .revenue-bar.enterprise { background: linear-gradient(90deg, #1a1a2e, #16213e); }
        .revenue-bar.midmarket { background: linear-gradient(90deg, #0f4c75, #1b6ca8); }
        .revenue-bar.pyme { background: linear-gradient(90deg, #3d5a80, #5c7a9e); }
        .revenue-bar.micro { background: #ccc; }

        /* Stats Dashboard */
        .stats-dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 16px;
            margin-bottom: 24px;
            padding: 20px;
            background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 100%);
            border-radius: 12px;
        }
        .stat-card {
            padding: 20px 16px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        .stat-card:hover { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0,0,0,0.12); }
        .stat-card.active { transform: translateY(-3px); box-shadow: 0 8px 24px rgba(0,0,0,0.2); }

        /* Cuando hay filtro activo, las no seleccionadas se ponen grises */
        .stats-dashboard.has-filter .stat-card:not(.active) {
            background: #e5e5e5 !important;
            opacity: 0.6;
        }
        .stats-dashboard.has-filter .stat-card:not(.active) .stat-value,
        .stats-dashboard.has-filter .stat-card:not(.active) .stat-label,
        .stats-dashboard.has-filter .stat-card:not(.active) .stat-revenue {
            color: #888 !important;
        }
        .stats-dashboard.has-filter .stat-card:not(.active):hover {
            opacity: 0.8;
        }
        body.dark .stats-dashboard.has-filter .stat-card:not(.active) {
            background: #333 !important;
        }
        body.dark .stats-dashboard.has-filter .stat-card:not(.active) .stat-value,
        body.dark .stats-dashboard.has-filter .stat-card:not(.active) .stat-label,
        body.dark .stats-dashboard.has-filter .stat-card:not(.active) .stat-revenue {
            color: #666 !important;
        }
        .stat-card .stat-value { font-size: 32px; font-weight: 600; margin-bottom: 6px; }
        .stat-card .stat-label { font-size: 11px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 4px; }
        .stat-card .stat-revenue { font-size: 11px; opacity: 0.7; }

        /* Enterprise - Azul oscuro/negro premium */
        .stat-card.enterprise {
            background: linear-gradient(135deg, #1a1a2e 0%, #2d2d44 100%);
            color: #fff;
        }
        .stat-card.enterprise .stat-value { color: #fff; }
        .stat-card.enterprise .stat-label { color: rgba(255,255,255,0.9); }
        .stat-card.enterprise .stat-revenue { color: rgba(255,255,255,0.6); }

        /* Mid-Market - Azul corporativo */
        .stat-card.midmarket {
            background: linear-gradient(135deg, #0f4c75 0%, #1b6ca8 100%);
            color: #fff;
        }
        .stat-card.midmarket .stat-value { color: #fff; }
        .stat-card.midmarket .stat-label { color: rgba(255,255,255,0.9); }
        .stat-card.midmarket .stat-revenue { color: rgba(255,255,255,0.6); }

        /* PYME - Verde/teal */
        .stat-card.pyme {
            background: linear-gradient(135deg, #0d7377 0%, #14919b 100%);
            color: #fff;
        }
        .stat-card.pyme .stat-value { color: #fff; }
        .stat-card.pyme .stat-label { color: rgba(255,255,255,0.9); }
        .stat-card.pyme .stat-revenue { color: rgba(255,255,255,0.6); }

        /* Micro - Naranja/ámbar */
        .stat-card.micro {
            background: linear-gradient(135deg, #c2703a 0%, #e09556 100%);
            color: #fff;
        }
        .stat-card.micro .stat-value { color: #fff; }
        .stat-card.micro .stat-label { color: rgba(255,255,255,0.9); }
        .stat-card.micro .stat-revenue { color: rgba(255,255,255,0.6); }

        /* Revenue Display in Card */
        .revenue-display {
            display: flex;
            align-items: baseline;
            gap: 6px;
            margin-top: 6px;
        }
        .revenue-amount {
            font-size: 18px;
            font-weight: 500;
            color: #000;
        }
        .revenue-unit {
            font-size: 12px;
            color: #666;
        }
        /* Enhanced Prospect Card */
        .prospect-card-enhanced {
            position: relative;
            background: #fff;
            padding: 20px 24px;
            border-radius: 12px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 20px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #eee;
        }
        .prospect-card-enhanced:hover {
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            border-color: #ddd;
            transform: translateX(4px);
        }
        .prospect-card-enhanced .tier-indicator {
            width: 4px;
            height: 50px;
            border-radius: 2px;
            flex-shrink: 0;
        }
        /* Colores por tier - igual que el dashboard */
        .tier-indicator.enterprise { background: #1a1a2e; }
        .tier-indicator.midmarket { background: #0f4c75; }
        .tier-indicator.pyme { background: #0d7377; }
        .tier-indicator.micro { background: #c2703a; }

        .prospect-main-info { flex: 1; min-width: 0; }
        .prospect-main-info .company-name {
            font-size: 15px;
            font-weight: 500;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .company-tags { display: flex; gap: 8px; flex-wrap: wrap; }
        .tag-sector, .tag-location {
            font-size: 11px;
            padding: 4px 10px;
            border-radius: 12px;
            background: #f5f5f5;
            color: #555;
        }
        .tag-location { background: #f0f7ff; color: #0066cc; }

        .prospect-revenue-section {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            min-width: 100px;
            flex-shrink: 0;
            gap: 8px;
        }
        .prospect-revenue-section .revenue-amount {
            font-size: 22px;
            font-weight: 600;
            color: #1a1a2e;
        }
        .prospect-revenue-section .tier-badge {
            font-size: 9px;
        }

        .prospect-actions-inline {
            display: flex;
            gap: 8px;
            flex-shrink: 0;
        }
        .action-btn {
            padding: 10px 16px;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            font-family: 'Inter', sans-serif;
        }
        .action-btn.primary {
            background: transparent;
            color: #888;
            border: 1px solid #ddd;
            border-radius: 0;
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            padding: 6px 14px;
            font-weight: 400;
        }
        .action-btn.primary:hover {
            border-color: #999;
            color: #555;
        }
        .action-btn.secondary {
            background: #f5f5f5;
            color: #666;
            padding: 10px 12px;
        }
        .action-btn.secondary:hover { background: #eee; color: #333; }

        .card-dismiss-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 22px;
            height: 22px;
            border: none;
            background: transparent;
            border-radius: 50%;
            font-size: 10px;
            color: #ccc;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
            opacity: 0;
            transition: all 0.2s ease;
        }
        .prospect-card-enhanced:hover .card-dismiss-btn {
            opacity: 1;
        }
        .card-dismiss-btn:hover {
            background: #f0f0f0;
            color: #888;
        }
        /* Charts Section */
        .charts-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }
        .chart-card {
            background: #fff;
            border-radius: 12px;
            padding: 24px;
            border: 1px solid #eee;
        }
        .chart-card h3 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
        }
        .chart-bar-item {
            display: flex;
            align-items: center;
            margin-bottom: 12px;
            gap: 12px;
        }
        .chart-bar-label {
            width: 100px;
            font-size: 12px;
            color: #555;
            flex-shrink: 0;
        }
        .chart-bar-container {
            flex: 1;
            height: 24px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }
        .chart-bar-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
            min-width: 2px;
        }
        .chart-bar-value {
            width: 60px;
            font-size: 12px;
            font-weight: 500;
            text-align: right;
            color: #333;
            flex-shrink: 0;
        }
        /* Colores para sectores */
        .bar-energia { background: linear-gradient(90deg, #f59e0b, #fbbf24); }
        .bar-servicios { background: linear-gradient(90deg, #6366f1, #818cf8); }
        .bar-industria { background: linear-gradient(90deg, #64748b, #94a3b8); }
        .bar-construccion { background: linear-gradient(90deg, #f97316, #fb923c); }
        .bar-tecnologia { background: linear-gradient(90deg, #06b6d4, #22d3ee); }
        .bar-salud { background: linear-gradient(90deg, #ec4899, #f472b6); }
        .bar-alimentacion { background: linear-gradient(90deg, #22c55e, #4ade80); }
        .bar-logistica { background: linear-gradient(90deg, #8b5cf6, #a78bfa); }
        .bar-distribucion { background: linear-gradient(90deg, #14b8a6, #2dd4bf); }
        .bar-automocion { background: linear-gradient(90deg, #ef4444, #f87171); }
        .bar-default { background: linear-gradient(90deg, #9ca3af, #d1d5db); }
        /* Colores para provincias */
        .bar-bizkaia { background: linear-gradient(90deg, #1a1a2e, #2d2d44); }
        .bar-gipuzkoa { background: linear-gradient(90deg, #0f4c75, #1b6ca8); }
        .bar-araba { background: linear-gradient(90deg, #0d7377, #14919b); }
        .bar-euskadi { background: linear-gradient(90deg, #c2703a, #e09556); }

        body.dark .chart-card { background: #222; border-color: #333; }
        /* ============================================ */
        /* ESTILOS MÓVIL - DISEÑO PROFESIONAL */
        /* ============================================ */
        @media (max-width: 768px) {
            /* Ocultar sidebar en móvil */
            .sidebar {
                display: none;
            }

            /* Layout principal sin sidebar */
            .layout {
                grid-template-columns: 1fr;
            }

            /* Header compacto */
            .header {
                padding: 12px 16px;
                justify-content: center;
                position: relative;
            }
            .logo-container {
                justify-content: center;
            }
            .logo-container .logo {
                display: none;
            }
            .logo-text {
                font-size: 14px;
                text-align: center;
            }

            /* Contenido principal */
            .content {
                padding: 12px;
                padding-top: 75px; /* Espacio para el botón logo */
            }

            /* Stats dashboard 2x2 compacto */
            .stats-dashboard {
                grid-template-columns: 1fr 1fr;
                gap: 8px;
                padding: 12px;
                margin-bottom: 12px;
                border-radius: 16px;
            }
            .stat-card {
                padding: 14px 10px;
                border-radius: 12px;
            }
            .stat-card .stat-value {
                font-size: 22px;
            }
            .stat-card .stat-label {
                font-size: 8px;
                letter-spacing: 0.3px;
            }
            .stat-card .stat-revenue {
                font-size: 9px;
            }

            /* Filter pills - scroll horizontal limpio */
            .filter-pills {
                display: none; /* Ocultar en móvil - usar dashboard para filtrar */
            }

            /* Búsqueda prominente */
            .filters-bar {
                flex-direction: column !important;
                gap: 8px !important;
                margin-bottom: 12px !important;
            }
            .filters-bar input {
                width: 100% !important;
                padding: 14px 16px !important;
                font-size: 16px !important; /* Evita zoom en iOS */
                border-radius: 12px !important;
            }
            .filters-bar select,
            .filter-select {
                width: 100% !important;
                padding: 12px !important;
                font-size: 14px !important;
                border-radius: 10px !important;
            }

            /* Ocultar toolbar secundario */
            .toolbar {
                display: none !important;
            }

            /* View summary compacto */
            .view-summary {
                margin-bottom: 12px;
                padding: 0 4px;
            }
            .summary-number {
                font-size: 28px;
            }
            .summary-label {
                font-size: 13px;
            }
            .summary-hint {
                display: none;
            }

            /* ====== TARJETAS MÓVIL - DISEÑO PROFESIONAL ====== */

            .prospect-card-enhanced {
                position: relative;
                padding: 0;
                margin-bottom: 12px;
                border-radius: 10px;
                flex-direction: column;
                gap: 0;
                border: none;
                box-shadow: 0 1px 3px rgba(0,0,0,0.08);
                background: #fff;
                overflow: hidden;
            }
            .card-dismiss-btn {
                position: absolute;
                top: 12px;
                right: 12px;
                width: 24px;
                height: 24px;
                border: none;
                background: rgba(0,0,0,0.06);
                border-radius: 50%;
                font-size: 11px;
                color: #999;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                opacity: 1;
                z-index: 2;
                transition: all 0.2s ease;
            }
            .card-dismiss-btn:hover {
                background: rgba(0,0,0,0.12);
                color: #666;
            }

            .prospect-card-enhanced .tier-indicator {
                width: 100%;
                height: 3px;
                border-radius: 0;
            }

            .prospect-main-info {
                padding: 16px 16px 0;
            }
            .prospect-main-info .company-name {
                font-size: 15px;
                font-weight: 600;
                margin-bottom: 6px;
                color: #000;
                line-height: 1.3;
            }
            .company-tags {
                display: flex;
                gap: 0;
                flex-wrap: wrap;
                align-items: center;
            }
            .tag-sector, .tag-location {
                font-size: 12px;
                padding: 0;
                border-radius: 0;
                background: none;
                color: #888;
                font-weight: 400;
            }
            .tag-sector::after {
                content: "  ·  ";
                color: #ccc;
            }
            .tag-location {
                color: #888;
            }
            .company-tags .tier-badge {
                font-size: 9px;
                padding: 2px 6px;
                margin-left: 6px;
                border-radius: 3px;
            }

            .prospect-revenue-section {
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 14px 16px 16px;
                background: transparent;
                margin: 0;
                border-top: none;
            }
            .prospect-revenue-section .revenue-amount {
                font-size: 20px;
                font-weight: 700;
                color: #000;
            }
            .prospect-revenue-section .tier-badge {
                font-size: 8px;
                padding: 4px 8px;
                border-radius: 3px;
            }

            /* Botones de acción - Estilo Apple */
            .prospect-actions-inline {
                display: flex;
                gap: 8px;
                padding: 0;
                border-top: none;
                justify-content: flex-end;
                align-items: center;
            }
            .prospect-actions-inline .action-btn.primary {
                background: transparent;
                border: 1px solid #ddd;
                border-radius: 0;
                font-size: 9px;
                letter-spacing: 2px;
                text-transform: uppercase;
                padding: 6px 14px;
                font-weight: 400;
                color: #888;
            }

            /* Dark mode móvil */
            body.dark .prospect-card-enhanced {
                background: #1a1a1a;
                box-shadow: 0 1px 3px rgba(0,0,0,0.3);
            }
            body.dark .prospect-main-info .company-name {
                color: #fff;
            }
            body.dark .tag-sector,
            body.dark .tag-location {
                color: #666;
                background: none;
            }
            body.dark .prospect-revenue-section {
                background: transparent;
            }
            body.dark .prospect-revenue-section .revenue-amount {
                color: #fff;
            }
            body.dark .prospect-actions-inline .action-btn.primary {
                background: transparent;
                border-color: #333;
                color: #555;
            }
            body.dark .card-dismiss-btn {
                background: rgba(255,255,255,0.08);
                color: #666;
            }
            body.dark .card-dismiss-btn:hover {
                background: rgba(255,255,255,0.15);
                color: #999;
            }

            /* ====== PIPELINE MÓVIL ====== */
            .pipeline-summary {
                flex-direction: row;
                flex-wrap: wrap;
                gap: 8px;
                padding: 12px;
            }
            .pipeline-metric {
                flex: 1;
                min-width: calc(50% - 4px);
                text-align: center;
                padding: 12px 8px;
                background: #f5f5f5;
                border-radius: 12px;
            }
            body.dark .pipeline-metric {
                background: #222;
            }

            .pipeline-board {
                display: flex;
                overflow-x: auto;
                gap: 12px;
                padding: 0 12px;
                -webkit-overflow-scrolling: touch;
                scroll-snap-type: x mandatory;
            }
            .pipeline-column {
                min-width: 85vw;
                flex-shrink: 0;
                scroll-snap-align: center;
                border-radius: 16px;
            }

            /* Modal móvil */
            .modal {
                width: 100%;
                max-width: 100%;
                max-height: 100vh;
                margin: 0;
                border-radius: 0;
            }

            /* Ocultar toggle flotante en móvil */
            .theme-toggle:not(.header-theme) {
                display: none;
            }
            /* Toggle en header para móvil */
            .theme-toggle.header-theme {
                display: flex;
                position: absolute;
                right: 14px;
                top: 50%;
                transform: translateY(-50%);
                width: 32px;
                height: 32px;
                font-size: 14px;
                background: transparent;
                border: 1px solid #e5e5e5;
                border-radius: 50%;
                box-shadow: none;
            }
            body.dark .theme-toggle.header-theme {
                border-color: #3a3a3a;
            }
            .theme-toggle.header-theme:hover,
            .theme-toggle.header-theme:active {
                background: transparent;
            }
            .connection-badge {
                display: none;
            }
        }

        /* Menú móvil hamburguesa - oculto por defecto */
        .mobile-menu-btn,
        .mobile-menu,
        .mobile-menu-overlay {
            display: none;
        }

        @media (max-width: 768px) {
            /* Botón menú con logo */
            .mobile-menu-btn {
                display: flex;
                position: fixed;
                top: 2px;
                left: 4px;
                width: 68px;
                height: 68px;
                background: transparent;
                border: none;
                align-items: center;
                justify-content: center;
                z-index: 1001;
                cursor: pointer;
                padding: 0;
            }
            .mobile-menu-btn .mobile-menu-logo {
                width: 100%;
                height: 100%;
                object-fit: contain;
            }

            /* Overlay oscuro */
            .mobile-menu-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                background: rgba(0,0,0,0.5);
                z-index: 1002;
            }
            .mobile-menu-overlay.open {
                display: block;
            }

            /* Menú lateral */
            .mobile-menu {
                display: block;
                position: fixed;
                top: 0;
                left: -280px;
                width: 280px;
                height: 100vh;
                background: #fff;
                z-index: 1003;
                transition: left 0.3s ease;
                box-shadow: 2px 0 20px rgba(0,0,0,0.1);
            }
            .mobile-menu.open {
                left: 0;
            }
            body.dark .mobile-menu {
                background: #1a1a1a;
            }

            .mobile-menu-header {
                display: flex;
                justify-content: flex-end;
                align-items: center;
                padding: 12px 16px;
            }
            .mobile-menu-title {
                font-size: 20px;
                font-weight: 600;
                color: #1a1a2e;
                text-align: center;
            }
            body.dark .mobile-menu-title {
                color: #fff;
            }
            .mobile-menu-close {
                width: 32px;
                height: 32px;
                background: #f5f5f5;
                border: none;
                border-radius: 50%;
                font-size: 14px;
                cursor: pointer;
                color: #666;
            }
            body.dark .mobile-menu-close {
                background: #333;
                color: #aaa;
            }

            .mobile-menu-items {
                padding: 16px 12px;
            }
            .mobile-menu-item {
                display: flex;
                align-items: center;
                gap: 12px;
                width: 100%;
                padding: 16px;
                background: none;
                border: none;
                border-radius: 12px;
                font-size: 16px;
                font-family: 'Inter', sans-serif;
                color: #666;
                cursor: pointer;
                text-align: left;
                margin-bottom: 4px;
            }
            .mobile-menu-item:hover,
            .mobile-menu-item.active {
                background: #f5f5f5;
                color: #1a1a2e;
            }
            body.dark .mobile-menu-item {
                color: #888;
            }
            body.dark .mobile-menu-item:hover,
            body.dark .mobile-menu-item.active {
                background: #2a2a2a;
                color: #fff;
            }
            .mobile-menu-item span {
                font-size: 18px;
            }

            /* Header ajustado para el botón hamburguesa */
            .header {
                padding-left: 60px !important;
                padding-right: 60px !important;
            }
            .mobile-logout-btn {
                display: block;
                width: auto;
                margin: 24px 16px 16px;
                padding: 10px 16px;
                background: transparent;
                border: 1px solid #ddd;
                border-radius: 0;
                font-size: 9px;
                letter-spacing: 2px;
                text-transform: uppercase;
                color: #888;
                cursor: pointer;
                font-family: 'Inter', sans-serif;
                transition: all 0.3s ease;
                text-align: center;
            }
            .mobile-logout-btn:hover {
                border-color: #999;
                color: #555;
            }
            body.dark .mobile-logout-btn {
                border-color: #333;
                color: #555;
            }
            body.dark .mobile-logout-btn:hover {
                border-color: #555;
                color: #888;
            }
        }

        /* Móvil pequeño */
        @media (max-width: 480px) {
            .stats-dashboard {
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }
            .stat-card .stat-value {
                font-size: 20px;
            }
            .prospect-revenue-section .revenue-amount {
                font-size: 18px;
            }
        }

        /* Quick Filter Pills */
        .filter-pills {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            flex-wrap: wrap;
        }
        .filter-pill {
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            border: 1px solid #e0e0e0;
            background: #fff;
            cursor: pointer;
            transition: all 0.2s;
        }
        .filter-pill:hover { border-color: #000; }
        .filter-pill.active { background: #000; color: #fff; border-color: #000; }

        .prospect-card {
            background: #fff;
            padding: 20px 0;
            display: flex;
            align-items: center;
            gap: 16px;
            cursor: pointer;
            transition: all 0.2s;
            border-bottom: 1px solid #f0f0f0;
        }

        .prospect-card:hover {
            padding-left: 8px;
        }

        .prospect-card:last-child {
            border-bottom: none;
        }

        .priority-indicator {
            width: 3px;
            height: 40px;
            background: #e0e0e0;
            border-radius: 2px;
            flex-shrink: 0;
        }

        .prospect-card.priority-high .priority-indicator {
            background: #000;
        }

        .prospect-card.priority-medium .priority-indicator {
            background: #999;
        }

        .prospect-info {
            flex: 1;
        }

        .prospect-info .name {
            font-size: 15px;
            font-weight: 400;
            margin-bottom: 4px;
        }

        .prospect-info .meta {
            font-size: 12px;
            color: #666;
            margin-bottom: 4px;
        }

        .prospect-info .detail {
            font-size: 12px;
            color: #999;
        }

        .btn-move {
            width: 40px;
            height: 40px;
            background: #fafafa;
            border: none;
            border-radius: 50%;
            font-family: 'Inter', sans-serif;
            font-size: 16px;
            color: #999;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .btn-move:hover {
            background: #000;
            color: #fff;
        }

        /* Views */
        .view {
            display: none;
        }

        .view.active {
            display: block;
        }

        /* Calendar Layout */
        .calendar-layout {
            display: grid;
            grid-template-columns: 280px 1fr;
            gap: 48px;
            max-width: 900px;
        }

        /* Mini Calendar */
        .mini-calendar {
            background: #fafafa;
            padding: 24px;
            border-radius: 12px;
            height: fit-content;
        }

        .mini-cal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .mini-cal-title {
            font-size: 15px;
            font-weight: 500;
        }

        .mini-cal-nav {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 18px;
            color: #999;
            border-radius: 50%;
            transition: all 0.2s;
        }

        .mini-cal-nav:hover {
            background: #e0e0e0;
            color: #000;
        }

        .mini-cal-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            margin-bottom: 8px;
        }

        .mini-cal-weekdays span {
            text-align: center;
            font-size: 10px;
            font-weight: 500;
            color: #999;
            padding: 4px 0;
        }

        .mini-cal-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 2px;
        }

        .mini-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #333;
            cursor: pointer;
            border-radius: 50%;
            transition: all 0.15s;
            position: relative;
        }

        .mini-day:hover {
            background: #e0e0e0;
        }

        .mini-day.empty {
            color: transparent;
            pointer-events: none;
        }

        .mini-day.today {
            background: #000;
            color: #fff;
        }

        .mini-day.has-audit {
            font-weight: 500;
        }

        .mini-day.has-audit::after {
            content: '';
            position: absolute;
            bottom: 2px;
            width: 4px;
            height: 4px;
            background: #f97316;
            border-radius: 50%;
        }

        .mini-day.today.has-audit::after {
            background: #fff;
        }

        /* Audit Agenda */
        .audit-agenda {
            flex: 1;
        }

        .agenda-header {
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid #f0f0f0;
        }

        .agenda-title {
            font-size: 11px;
            font-weight: 500;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            color: #999;
        }

        .agenda-list {
            display: flex;
            flex-direction: column;
        }

        .audit-card {
            display: flex;
            gap: 16px;
            padding: 20px 0;
            border-bottom: 1px solid #f5f5f5;
        }

        .audit-card:last-child {
            border-bottom: none;
        }

        .audit-date-box {
            width: 48px;
            text-align: center;
            flex-shrink: 0;
        }

        .audit-date-day {
            font-size: 24px;
            font-weight: 400;
            line-height: 1;
            margin-bottom: 4px;
        }

        .audit-date-month {
            font-size: 11px;
            color: #999;
            text-transform: uppercase;
        }

        .audit-details {
            flex: 1;
        }

        .audit-company {
            font-size: 15px;
            font-weight: 400;
            margin-bottom: 4px;
        }

        .audit-type {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }

        .audit-tag {
            display: inline-block;
            font-size: 10px;
            padding: 4px 8px;
            background: #fff3e0;
            color: #f97316;
            border-radius: 4px;
        }

        .no-audits {
            text-align: center;
            padding: 48px 24px;
            color: #999;
        }

        .no-audits p {
            font-size: 14px;
            margin-bottom: 8px;
        }

        .no-audits-hint {
            font-size: 12px;
            color: #ccc;
        }

        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #f8f8f8;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        body.dark .login-screen {
            background: #0a0a0a;
        }
        .login-container {
            width: 100%;
            max-width: 300px;
            padding: 0 32px;
            text-align: center;
        }
        .login-logo {
            width: 80px;
            height: 80px;
            margin-bottom: 24px;
        }
        .login-subtitle {
            font-size: 10px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 3.5px;
            font-weight: 300;
        }
        .login-form {
            display: flex;
            flex-direction: column;
            margin-top: 60px;
        }
        .login-input {
            width: 100%;
            padding: 20px 0 12px 0;
            border: none;
            border-bottom: 1px solid #000;
            border-radius: 0;
            font-size: 13px;
            font-family: inherit;
            outline: none;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
            background: transparent;
            letter-spacing: 1px;
            text-align: center;
            color: #222;
        }
        .login-input::placeholder {
            color: #bbb;
            text-transform: uppercase;
            font-size: 9px;
            letter-spacing: 2.5px;
            font-weight: 300;
        }
        .login-input:focus {
            border-bottom-color: #000;
        }
        body.dark .login-input {
            border-bottom-color: #2a2a2a;
            color: #ddd;
        }
        body.dark .login-input:focus {
            border-bottom-color: #555;
        }
        body.dark .login-input::placeholder {
            color: #444;
        }
        .login-btn {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid #000;
            border-radius: 0;
            font-size: 9px;
            font-weight: 400;
            letter-spacing: 3px;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.35s ease;
            margin-top: 50px;
            background: transparent;
            color: #000;
        }
        .login-btn:hover {
            background: #000;
            color: #fff;
        }
        .login-btn.primary {
            background: transparent;
            color: #000;
        }
        body.dark .login-btn {
            border-color: #444;
            color: #888;
        }
        body.dark .login-btn:hover {
            background: #ddd;
            color: #111;
            border-color: #ddd;
        }
        .login-error {
            color: #b44;
            font-size: 9px;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-top: 28px;
            font-weight: 300;
            display: none;
        }
        body.dark .login-error {
            color: #c66;
        }
        .login-screen.hidden {
            display: none;
        }
        .app-container.hidden {
            display: none;
        }

        /* Logout in sidebar */
        #sidebarLogout .sidebar-item {
            font-size: 11px;
            color: #999;
        }
        #sidebarLogout .sidebar-item:hover {
            color: #666;
        }
        body.dark #sidebarLogout .sidebar-item {
            color: #555;
        }
        body.dark #sidebarLogout .sidebar-item:hover {
            color: #888;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <img src="logo.png" alt="SNARO" class="login-logo">
            <p class="login-subtitle">Pipeline de ventas</p>

            <form class="login-form" id="loginForm" onsubmit="handleLogin(event)">
                <input type="text" class="login-input" id="loginName" placeholder="Nombre y apellido" required>
                <input type="password" class="login-input" id="loginPassword" placeholder="Contraseña" required>
                <button type="submit" class="login-btn primary" id="loginBtn">Entrar</button>
            </form>

            <div class="login-error" id="loginError"></div>
        </div>
    </div>

    <!-- App Container -->
    <div class="app-container hidden" id="appContainer">

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Cambiar tema">☀️</button>

    <!-- Connection Badge -->
    <div style="position:fixed;top:12px;right:12px;display:flex;gap:8px;z-index:1000;align-items:center">
        <div id="connectionBadge" class="connection-badge offline" onclick="showSupabaseConfig()">
            <span class="dot"></span>
            <span id="connectionText">Local</span>
        </div>
        <button id="syncBtn" onclick="syncAllToCloud().then(()=>showNotification('Sincronizado con la nube'))" style="padding:6px 12px;border-radius:20px;border:1px solid #ddd;background:#fff;cursor:pointer;font-size:12px;display:none">Sincronizar</button>
    </div>

    <!-- Modal: Supabase Config -->
    <div class="modal-overlay" id="supabaseModal">
        <div class="modal" style="max-width: 480px;">
            <div class="modal-header">
                <h2>Configuración Nube</h2>
                <button class="modal-close" onclick="document.getElementById('supabaseModal').classList.remove('active')">×</button>
            </div>
            <div class="modal-body" id="supabaseModalContent">
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="logo-container" onclick="showView('pipeline')">
            <img src="logo.png" alt="SNARO" class="logo">
            <span class="logo-text">SNARO</span>
        </div>
        <button class="theme-toggle header-theme" onclick="toggleTheme()" title="Cambiar tema">☀️</button>
    </header>

    <div class="main-container">
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">Ventas</div>
                <div class="sidebar-item active" data-view="pipeline" onclick="showView('pipeline')">Pipeline</div>
                <div class="sidebar-item" data-view="porcontactar" onclick="showView('porcontactar')">Por contactar</div>
            </div>
            <div class="sidebar-section">
                <div class="sidebar-title">Gestión</div>
                <div class="sidebar-item" data-view="calendario" onclick="showView('calendario')">Calendario</div>
                <div class="sidebar-item" data-view="informes" onclick="showView('informes')">Informes</div>
            </div>
            <div class="sidebar-section" id="sidebarLogout" style="display: none; margin-top: auto; padding-bottom: 20px;">
                <div class="sidebar-item" onclick="logout()" style="color: #999;">Cerrar sesión</div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="content">
            <!-- View: Por Contactar -->
            <div class="view" id="view-porcontactar" style="display: none;">
                <!-- Header con título y contador -->
                <div class="view-summary" style="margin-bottom: 24px;">
                    <div class="summary-main">
                        <span class="summary-number" id="prospectCount">0</span>
                        <span class="summary-label">empresas por contactar</span>
                    </div>
                    <div class="summary-hint">Base de datos SABI · Empresas de Euskadi</div>
                </div>

                <!-- Dashboard de Segmentación por Facturación -->
                <div class="stats-dashboard" id="statsDashboard">
                    <div class="stat-card enterprise" onclick="filterByTier('enterprise')" id="statEnterprise">
                        <div class="stat-value" id="countEnterprise">0</div>
                        <div class="stat-label">Enterprise</div>
                        <div class="stat-revenue">> 100M€</div>
                    </div>
                    <div class="stat-card midmarket" onclick="filterByTier('midmarket')" id="statMidmarket">
                        <div class="stat-value" id="countMidmarket">0</div>
                        <div class="stat-label">Mid-Market</div>
                        <div class="stat-revenue">10M€ - 100M€</div>
                    </div>
                    <div class="stat-card pyme" onclick="filterByTier('pyme')" id="statPyme">
                        <div class="stat-value" id="countPyme">0</div>
                        <div class="stat-label">PYME</div>
                        <div class="stat-revenue">1M€ - 10M€</div>
                    </div>
                    <div class="stat-card micro" onclick="filterByTier('micro')" id="statMicro">
                        <div class="stat-value" id="countMicro">0</div>
                        <div class="stat-label">Micro</div>
                        <div class="stat-revenue">< 1M€</div>
                    </div>
                </div>

                <!-- Quick Filter Pills -->
                <div class="filter-pills" id="filterPills">
                    <button class="filter-pill active" onclick="filterByTier('')" data-tier="">Todas</button>
                    <button class="filter-pill" onclick="filterByTier('enterprise')" data-tier="enterprise">Enterprise (>100M€)</button>
                    <button class="filter-pill" onclick="filterByTier('midmarket')" data-tier="midmarket">Mid-Market (10-100M€)</button>
                    <button class="filter-pill" onclick="filterByTier('pyme')" data-tier="pyme">PYME (1-10M€)</button>
                    <button class="filter-pill" onclick="filterByTier('micro')" data-tier="micro">Micro (<1M€)</button>
                </div>

                <!-- Filtros principales -->
                <div class="filters-bar" style="display: flex; gap: 12px; margin-bottom: 16px; flex-wrap: wrap;">
                    <input type="text" id="searchProspects" placeholder="Buscar empresa..."
                           style="flex: 2; min-width: 200px; padding: 12px 16px; border: 1px solid #e0e0e0; border-radius: 8px; font-family: 'Inter', sans-serif; font-size: 13px;"
                           oninput="filterProspects()">
                    <select id="filterSector" class="filter-select" onchange="filterProspects()">
                        <option value="">Todos los sectores</option>
                        <option value="Energía">Energía</option>
                        <option value="Industria">Industria</option>
                        <option value="Automoción">Automoción</option>
                        <option value="Tecnología">Tecnología</option>
                        <option value="Construcción">Construcción</option>
                        <option value="Servicios">Servicios</option>
                        <option value="Salud">Salud</option>
                        <option value="Alimentación">Alimentación</option>
                        <option value="Logística">Logística</option>
                        <option value="Distribución">Distribución</option>
                    </select>
                    <select id="filterLocation" class="filter-select" onchange="filterProspects()">
                        <option value="">Todas las provincias</option>
                        <option value="Bizkaia">Bizkaia</option>
                        <option value="Gipuzkoa">Gipuzkoa</option>
                        <option value="Araba">Araba</option>
                    </select>
                    <select id="filterRevenue" class="filter-select" onchange="filterProspects()" style="display: none;">
                        <option value="">Cualquier facturación</option>
                        <option value="enterprise">> 100M€</option>
                        <option value="midmarket">10M€ - 100M€</option>
                        <option value="pyme">1M€ - 10M€</option>
                        <option value="micro">< 1M€</option>
                    </select>
                </div>

                <!-- Barra de herramientas -->
                <div class="toolbar" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid #f0f0f0;">
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span style="font-size: 12px; color: #666;">Ordenar:</span>
                        <select id="sortBy" class="filter-select-small" onchange="filterProspects()">
                            <option value="revenue-desc">Mayor facturación</option>
                            <option value="revenue-asc">Menor facturación</option>
                            <option value="name">Alfabético (A-Z)</option>
                            <option value="sector">Por sector</option>
                        </select>
                    </div>
                    <div style="display: flex; gap: 8px; align-items: center;">
                        <span style="font-size: 12px; color: #666; margin-right: 8px;" id="filteredCount">Mostrando 0</span>
                        <span style="font-size: 12px; color: #666;">Vista:</span>
                        <button class="view-btn active" id="viewCards" onclick="setProspectView('cards')" title="Tarjetas">▦</button>
                        <button class="view-btn" id="viewTable" onclick="setProspectView('table')" title="Tabla">☰</button>
                    </div>
                </div>

                <div class="prospect-list" id="prospectList">
                    <!-- Se carga dinámicamente con JavaScript -->
                </div>
            </div>

            <!-- View: Pipeline -->
            <div class="view" id="view-pipeline" style="display: block;">

            <!-- Pipeline Summary -->
            <div class="pipeline-summary">
                <div class="pipeline-metric main-metric">
                    <span class="metric-value" id="mrrPotencial">0€</span>
                    <span class="metric-label">MRR potencial en pipeline</span>
                </div>
                <div class="pipeline-metric">
                    <span class="metric-value small" id="mrrActual">0€</span>
                    <span class="metric-label">MRR actual</span>
                </div>
                <div class="pipeline-metric">
                    <span class="metric-value small" id="empresasActivas">0</span>
                    <span class="metric-label">empresas activas</span>
                </div>
            </div>

            <!-- Pipeline Board -->
            <div class="pipeline-board">
                <!-- Contactados -->
                <div class="pipeline-column" id="col-contactado">
                    <div class="column-header">
                        <h3>Contactado</h3>
                        <span class="column-count">0€</span>
                    </div>
                    <div class="empty-column">Sin empresas</div>
                </div>

                <!-- Reunión -->
                <div class="pipeline-column" id="col-reunion">
                    <div class="column-header">
                        <h3>Reunión</h3>
                        <span class="column-count">0€</span>
                    </div>
                    <div class="empty-column">Sin empresas</div>
                </div>

                <!-- Piloto -->
                <div class="pipeline-column" id="col-piloto">
                    <div class="column-header">
                        <h3>Piloto</h3>
                        <span class="column-count">0€</span>
                    </div>
                    <div class="empty-column">Sin empresas</div>
                </div>

                <!-- Cliente -->
                <div class="pipeline-column col-cliente" id="col-cliente">
                    <div class="column-header">
                        <h3>Cliente</h3>
                        <span class="column-count">0€</span>
                    </div>
                    <div class="empty-column">Sin clientes aún</div>
                </div>
            </div>
            </div>

            <!-- View: Calendario -->
            <div class="view" id="view-calendario" style="display: none;">
                <div class="calendar-layout">
                    <!-- Mini calendario -->
                    <div class="mini-calendar">
                        <div class="mini-cal-header">
                            <button class="mini-cal-nav" onclick="changeMonth(-1)">‹</button>
                            <span class="mini-cal-title" id="calendarMonth">Febrero 2026</span>
                            <button class="mini-cal-nav" onclick="changeMonth(1)">›</button>
                        </div>
                        <div class="mini-cal-weekdays">
                            <span>L</span><span>M</span><span>X</span><span>J</span><span>V</span><span>S</span><span>D</span>
                        </div>
                        <div class="mini-cal-grid" id="calendarDays"></div>
                    </div>

                    <!-- Lista de auditorías -->
                    <div class="audit-agenda">
                        <div class="agenda-header">
                            <span class="agenda-title">Próximas auditorías</span>
                        </div>
                        <div class="agenda-list" id="auditList">
                            <div class="no-audits">
                                <p>Sin auditorías programadas</p>
                                <p class="no-audits-hint">Las auditorías aparecerán aquí cuando añadas empresas</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- View: Informes -->
            <div class="view" id="view-informes" style="display: none;">
                <div class="top-actions">
                    <h1 class="page-title">Informes</h1>
                </div>
                <div id="informesContent"></div>
            </div>
        </main>
    </div>

    <!-- Floating Add Button -->
    <button class="btn-add" onclick="openAddModal()">+</button>

    <!-- Modal: Añadir Empresa -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <div class="modal-header">
                <h2>Nueva empresa</h2>
                <button class="modal-close" onclick="closeAddModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label>Nombre</label>
                        <input type="text" id="companyName" placeholder="Distribuciones García S.L.">
                    </div>
                    <div class="form-group">
                        <label>CIF</label>
                        <input type="text" id="companyCIF" placeholder="B12345678">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Sector</label>
                        <select id="companySector">
                            <option value="">Seleccionar</option>
                            <option value="distribucion">Distribución</option>
                            <option value="fabricacion">Fabricación</option>
                            <option value="logistica">Logística</option>
                            <option value="comercio">Comercio</option>
                            <option value="servicios">Servicios</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Contacto</label>
                        <input type="text" id="companyContact" placeholder="Nombre del contacto">
                    </div>
                </div>
                <div class="form-group">
                    <label>Notas</label>
                    <textarea id="companyNotes" rows="2" placeholder="Contexto, necesidades, cómo lo conociste"></textarea>
                </div>

                <button class="btn" style="width: 100%;" onclick="investigateCompany()">
                    Investigar empresa
                </button>

                <!-- Investigation Loading -->
                <div class="investigation-box loading" id="investigationLoading" style="display: none;">
                    <div class="spinner"></div>
                    <p class="loading-text">Investigando empresa</p>
                </div>

                <!-- Investigation Results -->
                <div class="investigation-box" id="investigationResults" style="display: none;">
                    <h4>Resultados</h4>

                    <div class="info-grid">
                        <div class="info-item">
                            <div class="label">Facturación</div>
                            <div class="value" id="resFacturacion">—</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Empleados</div>
                            <div class="value" id="resEmpleados">—</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Constitución</div>
                            <div class="value" id="resConstitucion">—</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Última auditoría</div>
                            <div class="value" id="resAuditoria">—</div>
                        </div>
                    </div>

                    <div class="alerts-section" id="alertsSection">
                        <h5>Alertas</h5>
                        <div id="alertsList"></div>
                    </div>

                    <div class="opportunities-section">
                        <h5>Oportunidades</h5>
                        <div id="opportunitiesList"></div>
                    </div>
                </div>

                <div class="form-buttons">
                    <button class="btn" onclick="closeAddModal()">Cancelar</button>
                    <button class="btn btn-primary" id="saveBtn" onclick="saveCompany()">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Detalle Cliente -->
    <div class="modal-overlay" id="clientDetailModal">
        <div class="modal" style="max-width: 720px;">
            <div class="modal-header">
                <h2>Empresa</h2>
                <button class="modal-close" onclick="closeClientDetail()">×</button>
            </div>
            <div class="modal-body">
                <div class="client-detail-header">
                    <div>
                        <h2 id="detailName">Gastronort S.L.</h2>
                        <p class="sector" id="detailSector">Distribución HORECA</p>
                    </div>
                    <span class="status-badge" id="detailStatus">Por contactar</span>
                </div>

                <div class="tabs">
                    <div class="tab active" onclick="showTab('info')">Información</div>
                    <div class="tab" onclick="showTab('activity')">Actividad</div>
                    <div class="tab" onclick="showTab('investigation')">Investigación</div>
                </div>

                <div class="tab-content active" id="tab-info">
                </div>

                <div class="tab-content" id="tab-activity">
                </div>

                <div class="tab-content" id="tab-investigation">
                </div>

                <div class="move-section">
                    <select id="moveStatusSelect">
                        <option value="porcontactar">Mover a: Por contactar</option>
                        <option value="contactado">Mover a: Contactado</option>
                        <option value="reunion">Mover a: Reunión</option>
                        <option value="piloto">Mover a: Piloto</option>
                        <option value="cliente">Mover a: Cliente</option>
                    </select>
                    <button class="btn btn-primary" onclick="updateCompanyStatus()">Actualizar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // SISTEMA DE PERSISTENCIA - localStorage
        // ============================================
        const STORAGE_KEY = 'snaro_pipeline_data';

        // Datos iniciales - 10.141 empresas de Euskadi (SABI Database)
        // Carga desde empresas_sabi.js - si no existe, usa fallback mínimo
        const initialProspects = typeof empresasSABI !== 'undefined' ? empresasSABI : [
            { id: 1, name: 'Empresa Demo', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Error: No se cargó empresas_sabi.js - Verifica que el archivo existe' }
        ];

        /* NOTA: El array original de 700 empresas ha sido eliminado.
           Ahora usamos las 10.141 empresas de SABI cargadas desde empresas_sabi.js
           Empresas anteriores eliminadas:
            { id: 93, name: 'Grupo Sagardi', ... },
            { id: 94, name: 'Azurmendi', sector: 'Servicios', location: 'Larrabetzu, Bizkaia', priority: 'high', detail: 'Restaurante 3 estrellas Michelin' },
            { id: 95, name: 'Arzak', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Restaurante 3 estrellas Michelin' },

            // MÁS INDUSTRIA
            { id: 96, name: 'Orkli', sector: 'Industria', location: 'Ordizia, Gipuzkoa', priority: 'high', detail: 'Componentes calefacción y solar' },
            { id: 97, name: 'Ulma Group', sector: 'Industria', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Construcción, packaging, agrícola' },
            { id: 98, name: 'Copreci', sector: 'Industria', location: 'Aretxabaleta, Gipuzkoa', priority: 'high', detail: 'Componentes electrodomésticos' },
            { id: 99, name: 'Orbea', sector: 'Industria', location: 'Mallabia, Bizkaia', priority: 'high', detail: 'Fabricante de bicicletas' },
            { id: 100, name: 'BH Bikes', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Fabricante de bicicletas' },
            { id: 101, name: 'Jata', sector: 'Industria', location: 'Abadiano, Bizkaia', priority: 'medium', detail: 'Electrodomésticos' },
            { id: 102, name: 'Arteche', sector: 'Industria', location: 'Mungia, Bizkaia', priority: 'high', detail: 'Equipos eléctricos. Cotiza en bolsa' },
            { id: 103, name: 'Zigor', sector: 'Industria', location: 'Igorre, Bizkaia', priority: 'medium', detail: 'SAIs y electrónica de potencia' },
            { id: 104, name: 'Egamaster', sector: 'Industria', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Herramientas profesionales' },
            { id: 105, name: 'Bellota Tools', sector: 'Industria', location: 'Legazpi, Gipuzkoa', priority: 'medium', detail: 'Herramientas agrícolas e industriales' },

            // MÁS TECNOLOGÍA
            { id: 106, name: 'BCSC (Basque Cybersecurity Centre)', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'high', detail: 'Centro ciberseguridad' },
            { id: 107, name: 'Sherpa.ai', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Inteligencia artificial' },
            { id: 108, name: 'Biolan', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Biosensores y diagnóstico' },
            { id: 109, name: 'Createc 3D', sector: 'Tecnología', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Impresión 3D industrial' },
            { id: 110, name: 'Savvy Data Systems', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'IoT e industria 4.0' },
            { id: 111, name: 'Lantek', sector: 'Tecnología', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Software para industria metálica' },
            { id: 112, name: 'Sisteplant', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'medium', detail: 'Software industrial y MES' },
            { id: 113, name: 'Innovae', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Realidad aumentada industrial' },
            { id: 114, name: 'Datik', sector: 'Tecnología', location: 'Donostia', priority: 'medium', detail: 'Visión artificial y AI' },

            // MÁS CONSTRUCCIÓN E INMOBILIARIA
            { id: 115, name: 'Neinor Homes', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Promotora inmobiliaria. Cotiza en bolsa' },
            { id: 116, name: 'Visesa', sector: 'Construcción', location: 'Bilbao', priority: 'medium', detail: 'Vivienda social Gobierno Vasco' },
            { id: 117, name: 'Grupo Eibar', sector: 'Construcción', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Promoción y construcción' },
            { id: 118, name: 'Construcciones ACR', sector: 'Construcción', location: 'Donostia', priority: 'medium', detail: 'Edificación y obra civil' },

            // NUEVAS EMPRESAS - BIZKAIA FABRICACIÓN
            { id: 129, name: 'Gestamp Bizkaia', sector: 'Fabricación', location: 'Abadino, Bizkaia', priority: 'high', detail: 'Multinacional componentes metálicos. 115 plantas en 24 países' },
            { id: 130, name: 'CIE Automotive', sector: 'Fabricación', location: 'Bilbao', priority: 'high', detail: 'Grupo industrial. Fundición, forja, mecanizado. 100+ plantas' },
            { id: 131, name: 'CIE Berriz', sector: 'Fabricación', location: 'Berriz, Bizkaia', priority: 'medium', detail: 'Planta de componentes de automoción' },
            { id: 132, name: 'Inyectametal', sector: 'Fabricación', location: 'Abadino, Bizkaia', priority: 'medium', detail: 'Especialistas en inyección de metal (MIM)' },
            { id: 133, name: 'Metálicas Cadagua SL', sector: 'Fabricación', location: 'Arrigorriaga, Bizkaia', priority: 'medium', detail: 'Fabricación y montaje estructuras metálicas' },
            { id: 134, name: 'Arcanor', sector: 'Calderería', location: 'Sondika, Bizkaia', priority: 'medium', detail: 'Calderería industrial e instalación tuberías' },
            { id: 135, name: 'Urkasa', sector: 'Fundición', location: 'Arrigorriaga, Bizkaia', priority: 'medium', detail: 'Piezas de fundición y mecanizado' },
            { id: 136, name: 'Fabricación Metales Duros SAL', sector: 'Fabricación', location: 'Basauri, Bizkaia', priority: 'medium', detail: 'Herramientas de metal duro' },
            { id: 137, name: 'Pekos Fabricación', sector: 'Fabricación', location: 'Artea, Bizkaia', priority: 'medium', detail: 'Válvulas de bola' },
            { id: 138, name: 'ITP Aero', sector: 'Aeronáutica', location: 'Zamudio, Bizkaia', priority: 'high', detail: 'Fabricación de turbinas y componentes aeronáuticos' },

            // NUEVAS EMPRESAS - BIZKAIA SUMINISTROS
            { id: 139, name: 'Suministros Agorreta', sector: 'Material Eléctrico', location: 'Bizkaia', priority: 'medium', detail: 'Distribuidor material eléctrico y automatización' },
            { id: 140, name: 'Suministros Ortiz', sector: 'Suministros Industriales', location: 'Bizkaia', priority: 'medium', detail: 'Ferretería y suministros industriales 40+ años' },
            { id: 141, name: 'Suminbao', sector: 'Suministros Industriales', location: 'Bilbao', priority: 'medium', detail: 'EPIs y vestuario laboral' },
            { id: 142, name: 'Comercial Marpla', sector: 'Suministros Industriales', location: 'Bizkaia', priority: 'medium', detail: 'Plásticos técnicos y semiproductos' },
            { id: 143, name: 'Aceros Uranga', sector: 'Siderurgia', location: 'Bizkaia', priority: 'medium', detail: 'Almacén aceros especiales y aleaciones' },

            // NUEVAS EMPRESAS - GIPUZKOA TRANSPORTE Y LOGÍSTICA
            { id: 144, name: 'Echemar', sector: 'Transporte', location: 'Gipuzkoa', priority: 'medium', detail: '28M€ facturación. Top 10 Euskadi' },
            { id: 145, name: 'Transportes Legazpi', sector: 'Transporte', location: 'Legazpi, Gipuzkoa', priority: 'medium', detail: 'Transporte mercancías industria local' },
            { id: 146, name: 'Transportes Zumarraga', sector: 'Transporte', location: 'Zumarraga, Gipuzkoa', priority: 'medium', detail: 'Transporte local y regional' },
            { id: 147, name: 'Gexa Transportes', sector: 'Logística', location: 'Oiartzun, Gipuzkoa', priority: 'high', detail: 'Desde 1982. Parque Logístico Lanbarren' },
            { id: 148, name: 'LGK Logística', sector: 'Logística', location: 'Gernika, Bizkaia', priority: 'medium', detail: 'Distribución diaria. Flota ecológica geolocalizada' },
            { id: 149, name: 'Grupo Logi Gipuzkoa', sector: 'Logística', location: 'Astigarraga, Gipuzkoa', priority: 'medium', detail: 'Delegación Gipuzkoa. Cobertura regional' },

            // NUEVAS EMPRESAS - GIPUZKOA MÁQUINA-HERRAMIENTA
            { id: 150, name: 'Danobat S. Coop', sector: 'Máquina-herramienta', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Fundada 1953. Líder rectificadoras y tornos CNC. Grupo Mondragon' },
            { id: 151, name: 'Fagor Automation', sector: 'Máquina-herramienta', location: 'Eskoriatza, Gipuzkoa', priority: 'high', detail: 'Cooperativa Mondragón. Sistemas CNC y digitalización' },
            { id: 152, name: 'Ibarmia', sector: 'Máquina-herramienta', location: 'Azkoitia, Gipuzkoa', priority: 'high', detail: 'Centros de mecanizado multieje. Exporta todo el mundo' },
            { id: 153, name: 'Soraluce', sector: 'Máquina-herramienta', location: 'Bergara, Gipuzkoa', priority: 'high', detail: 'Parte Danobatgroup. Fresadoras de alta precisión' },
            { id: 154, name: 'Mecanizados Kanter SA', sector: 'Mecanizado', location: 'Errenteria, Gipuzkoa', priority: 'medium', detail: 'Piezas sector aeronáutico. Alta precisión' },
            { id: 155, name: 'Mecanizados Mather SL', sector: 'Mecanizado', location: 'Hernani, Gipuzkoa', priority: 'medium', detail: 'Mecanizado general. Maquinaria CNC' },
            { id: 156, name: 'Mecanizados Osatu SL', sector: 'Mecanizado', location: 'Azkoitia, Gipuzkoa', priority: 'medium', detail: 'Piezas metálicas varios sectores' },
            { id: 157, name: 'Mecanizados Baikor SL', sector: 'Mecanizado', location: 'Arrasate, Gipuzkoa', priority: 'medium', detail: 'Servicios mecanizado zona Mondragón' },

            // NUEVAS EMPRESAS - GIPUZKOA SUMINISTROS
            { id: 158, name: 'Recambios Altuna', sector: 'Suministros Industriales', location: 'Gipuzkoa', priority: 'medium', detail: 'Distribuidor recambios automoción' },
            { id: 159, name: 'Ferretería Eroski', sector: 'Ferretería', location: 'Gipuzkoa', priority: 'low', detail: 'División ferretería y bricolaje del grupo' },

            // NUEVAS EMPRESAS - ARABA
            { id: 160, name: 'Ahorramas Plataforma Norte', sector: 'Gran Distribución', location: 'Araba', priority: 'medium', detail: 'Centro distribución región norte' },
            { id: 161, name: 'Barquín y Otxoa', sector: 'Transporte', location: 'Laudio, Araba', priority: 'high', detail: '40+ años. 150 camiones. Especialistas frío' },
            { id: 162, name: 'Trans Araba S. Coop.', sector: 'Transporte', location: 'Jundiz, Vitoria', priority: 'medium', detail: 'Cooperativa transporte basculante y excavación' },
            { id: 163, name: 'Transportes Hijos de Salvador', sector: 'Transporte', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Transporte mercancías y mudanzas' },
            { id: 164, name: 'Transportes Álava', sector: 'Transporte', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Transporte regional y nacional' },
            { id: 165, name: 'Dachser Vitoria', sector: 'Logística', location: 'Jundiz, Vitoria', priority: 'medium', detail: 'Multinacional alemana. Logística integral' },
            { id: 166, name: 'Aernnova', sector: 'Aeronáutica', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Diseño y fabricación aeroestructuras' },
            { id: 167, name: 'Recambios Vitoria', sector: 'Suministros Industriales', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Distribuidor recambios automoción' },

            // MÁQUINA-HERRAMIENTA (adicionales)
            { id: 168, name: 'Bost Machine Tools', sector: 'Máquina-herramienta', location: 'Asteasu, Gipuzkoa', priority: 'high', detail: 'Tornos verticales y horizontales de gran tamaño' },
            { id: 169, name: 'Etxe-Tar', sector: 'Máquina-herramienta', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Máquinas especiales y líneas transfer' },
            { id: 170, name: 'Zayer', sector: 'Máquina-herramienta', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Fresadoras de bancada fija y pórtico' },
            { id: 171, name: 'Goratu', sector: 'Máquina-herramienta', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Rectificadoras de alta precisión' },
            { id: 172, name: 'Juaristi', sector: 'Máquina-herramienta', location: 'Azkoitia, Gipuzkoa', priority: 'high', detail: 'Mandrinadoras y centros de mecanizado' },
            { id: 173, name: 'Geminis Lathes', sector: 'Máquina-herramienta', location: 'Elgoibar, Gipuzkoa', priority: 'medium', detail: 'Tornos paralelos y CNC' },
            { id: 174, name: 'CMZ', sector: 'Máquina-herramienta', location: 'Zaldibia, Gipuzkoa', priority: 'high', detail: 'Tornos CNC de alta producción' },
            { id: 175, name: 'Kondia', sector: 'Máquina-herramienta', location: 'Elgoibar, Gipuzkoa', priority: 'medium', detail: 'Fresadoras y centros de mecanizado' },
            { id: 176, name: 'Goialde', sector: 'Máquina-herramienta', location: 'Aretxabaleta, Gipuzkoa', priority: 'medium', detail: 'Máquinas especiales y automatización' },
            { id: 177, name: 'Ona Electroerosión', sector: 'Máquina-herramienta', location: 'Durango, Bizkaia', priority: 'high', detail: 'Máquinas de electroerosión por penetración e hilo' },
            { id: 178, name: 'Nicolás Correa', sector: 'Máquina-herramienta', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Fresadoras de grandes dimensiones' },
            { id: 179, name: 'DYE', sector: 'Máquina-herramienta', location: 'Mendaro, Gipuzkoa', priority: 'medium', detail: 'Taladradoras y mandrinadoras' },
            { id: 180, name: 'Overbeck', sector: 'Máquina-herramienta', location: 'Bilbao', priority: 'medium', detail: 'Rectificadoras de interiores' },
            { id: 181, name: 'MTE Machine Tool', sector: 'Máquina-herramienta', location: 'Itziar, Gipuzkoa', priority: 'medium', detail: 'Fresadoras tipo puente y gantry' },
            { id: 182, name: 'Latz', sector: 'Máquina-herramienta', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Máquinas de corte por láser y plasma' },

            // AUTOMOCIÓN Y FERROVIARIO
            { id: 183, name: 'Fagor Ederlan', sector: 'Automoción', location: 'Eskoriatza, Gipuzkoa', priority: 'high', detail: 'Fundición y mecanizado para automoción. Grupo Mondragón' },
            { id: 184, name: 'Batz', sector: 'Automoción', location: 'Igorre, Bizkaia', priority: 'high', detail: 'Estampación, utillaje y componentes. 2.500 empleados' },
            { id: 185, name: 'Maier', sector: 'Automoción', location: 'Ajangiz, Bizkaia', priority: 'high', detail: 'Inyección plástico para automoción. Grupo Mondragón' },
            { id: 186, name: 'Mondragón Assembly', sector: 'Automoción', location: 'Aretxabaleta, Gipuzkoa', priority: 'high', detail: 'Líneas de montaje automatizadas' },
            { id: 187, name: 'Cikautxo', sector: 'Automoción', location: 'Beizama, Gipuzkoa', priority: 'medium', detail: 'Componentes de caucho-metal para automoción' },
            { id: 188, name: 'CAF (Construcciones y Auxiliar de Ferrocarriles)', sector: 'Ferroviario', location: 'Beasain, Gipuzkoa', priority: 'high', detail: 'Fabricante de trenes y material rodante. 14.000 empleados' },
            { id: 189, name: 'Irizar', sector: 'Automoción', location: 'Ormaiztegi, Gipuzkoa', priority: 'high', detail: 'Fabricante de autobuses de lujo. Grupo cooperativo' },
            { id: 190, name: 'Egile', sector: 'Automoción', location: 'Mendaro, Gipuzkoa', priority: 'medium', detail: 'Componentes estampados para automoción' },
            { id: 191, name: 'Estampaciones Mayo', sector: 'Automoción', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Estampación en frío piezas automoción' },
            { id: 192, name: 'Industrias Alzuaran', sector: 'Automoción', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Mecanizado y montaje componentes' },
            { id: 193, name: 'KH Vives', sector: 'Automoción', location: 'Durango, Bizkaia', priority: 'medium', detail: 'Sistemas de climatización vehículos' },
            { id: 194, name: 'Epsilon Euskadi', sector: 'Automoción', location: 'Saratxo, Araba', priority: 'medium', detail: 'Composites y piezas ligeras automoción' },
            { id: 195, name: 'Grupo Antolin Irausa', sector: 'Automoción', location: 'Eskoriatza, Gipuzkoa', priority: 'medium', detail: 'Techos y componentes interiores' },

            // AERONÁUTICA
            { id: 196, name: 'Sener Aeroespacial', sector: 'Aeronáutica', location: 'Getxo, Bizkaia', priority: 'high', detail: 'Ingeniería aeroespacial y energía. 3.000 empleados' },
            { id: 197, name: 'Aciturri', sector: 'Aeronáutica', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Aeroestructuras y componentes aeronáuticos' },
            { id: 198, name: 'Alfa Precision Casting', sector: 'Aeronáutica', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Fundición de precisión para aeronáutica' },
            { id: 199, name: 'Novalti', sector: 'Aeronáutica', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Mecanizado aeronáutico de alta precisión' },
            { id: 200, name: 'Burulan', sector: 'Aeronáutica', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Utillaje y mecanizado aeronáutico' },
            { id: 201, name: 'Industria de Turbo Propulsores (ITP)', sector: 'Aeronáutica', location: 'Ajalvir', priority: 'high', detail: 'Motores aeronáuticos. Sede Zamudio' },
            { id: 202, name: 'ACORDE Technologies', sector: 'Aeronáutica', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Electrónica para aviación' },

            // SIDERURGIA Y FUNDICIÓN
            { id: 203, name: 'Sidenor', sector: 'Siderurgia', location: 'Basauri, Bizkaia', priority: 'high', detail: 'Aceros especiales para automoción e industria' },
            { id: 204, name: 'Tubacex', sector: 'Siderurgia', location: 'Llodio, Araba', priority: 'high', detail: 'Tubos de acero inoxidable. Cotiza en bolsa' },
            { id: 205, name: 'Tubos Reunidos', sector: 'Siderurgia', location: 'Amurrio, Araba', priority: 'high', detail: 'Tubos sin soldadura para oil & gas' },
            { id: 206, name: 'Acería de Álava', sector: 'Siderurgia', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Fundición de acero' },
            { id: 207, name: 'Forjas de Álava', sector: 'Siderurgia', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Piezas forjadas para automoción' },
            { id: 208, name: 'Fundiciones del Estanda', sector: 'Fundición', location: 'Lazkao, Gipuzkoa', priority: 'medium', detail: 'Fundición de hierro nodular' },
            { id: 209, name: 'Victaulic Iberia', sector: 'Fundición', location: 'Iurreta, Bizkaia', priority: 'medium', detail: 'Accesorios de unión para tuberías' },
            { id: 210, name: 'Fundición Inyectada Alavesa (FIALSA)', sector: 'Fundición', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Inyección de aluminio y zamak' },

            // ENERGÍA
            { id: 211, name: 'Gamesa Electric (Siemens Gamesa)', sector: 'Energía', location: 'Zamudio, Bizkaia', priority: 'high', detail: 'Fabricante aerogeneradores. 27.000 empleados' },
            { id: 212, name: 'Iberdrola', sector: 'Energía', location: 'Bilbao', priority: 'high', detail: 'Sede en Torre Iberdrola. Utility global' },
            { id: 213, name: 'Ingeteam', sector: 'Energía', location: 'Zamudio, Bizkaia', priority: 'high', detail: 'Electrónica de potencia y automatización. 4.000 empleados' },
            { id: 214, name: 'Ormazabal', sector: 'Energía', location: 'Igorre, Bizkaia', priority: 'high', detail: 'Soluciones de media tensión eléctrica' },
            { id: 215, name: 'Arteche Group', sector: 'Energía', location: 'Mungia, Bizkaia', priority: 'high', detail: 'Equipos eléctricos transformación y protección' },
            { id: 216, name: 'Zigor', sector: 'Energía', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'SAIs y soluciones de energía' },
            { id: 217, name: 'Solarpack', sector: 'Energía', location: 'Getxo, Bizkaia', priority: 'high', detail: 'Desarrollador energía solar fotovoltaica' },
            { id: 218, name: 'Petronor', sector: 'Energía', location: 'Muskiz, Bizkaia', priority: 'high', detail: 'Refinería de petróleo. Grupo Repsol' },
            { id: 219, name: 'Vidrala', sector: 'Envases', location: 'Llodio, Araba', priority: 'high', detail: 'Fabricante de envases de vidrio. Cotiza en bolsa' },

            // CONSTRUCCIÓN E INGENIERÍA
            { id: 220, name: 'Ulma', sector: 'Construcción', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Encofrados, andamios, packaging. Grupo Mondragón' },
            { id: 221, name: 'Orona', sector: 'Construcción', location: 'Hernani, Gipuzkoa', priority: 'high', detail: 'Ascensores y escaleras mecánicas. Grupo Mondragón' },
            { id: 222, name: 'Jaso', sector: 'Construcción', location: 'Itsasondo, Gipuzkoa', priority: 'medium', detail: 'Grúas torre para construcción' },
            { id: 223, name: 'Hormigones y Minas', sector: 'Construcción', location: 'Bilbao', priority: 'medium', detail: 'Producción de hormigón y áridos' },
            { id: 224, name: 'Zitrón', sector: 'Construcción', location: 'Abadiño, Bizkaia', priority: 'medium', detail: 'Ventilación industrial y túneles' },
            { id: 225, name: 'SAITEC', sector: 'Ingeniería', location: 'Derio, Bizkaia', priority: 'high', detail: 'Ingeniería civil y energías renovables' },
            { id: 226, name: 'IDOM', sector: 'Ingeniería', location: 'Bilbao', priority: 'high', detail: 'Ingeniería multidisciplinar. 4.500 empleados' },
            { id: 227, name: 'Tecnalia', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'high', detail: 'Centro de investigación aplicada líder en España' },
            { id: 228, name: 'Vicomtech', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Investigación en IA y visión artificial' },

            // BANCA Y SEGUROS
            { id: 229, name: 'Laboral Kutxa', sector: 'Banca', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Banco cooperativo. Grupo Mondragón' },
            { id: 230, name: 'Kutxabank', sector: 'Banca', location: 'Bilbao', priority: 'high', detail: 'Banco fusión de cajas vascas' },
            { id: 231, name: 'Seguros Bilbao', sector: 'Seguros', location: 'Bilbao', priority: 'medium', detail: 'Compañía de seguros regional' },
            { id: 232, name: 'Lagun Aro', sector: 'Seguros', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Seguros y EPSV. Grupo Mondragón' },

            // COOPERATIVAS Y RETAIL
            { id: 233, name: 'Corporación Mondragón', sector: 'Cooperativas', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Mayor grupo cooperativo del mundo. 80.000 empleados' },
            { id: 234, name: 'Eroski Center', sector: 'Retail', location: 'Elorrio, Bizkaia', priority: 'medium', detail: 'Red de supermercados de proximidad' },
            { id: 235, name: 'Forum Sport', sector: 'Retail', location: 'Bilbao', priority: 'medium', detail: 'Cadena de tiendas deportivas' },
            { id: 236, name: 'Optika', sector: 'Retail', location: 'Bilbao', priority: 'low', detail: 'Cadena de ópticas' },
            { id: 237, name: 'Eroski Viajes', sector: 'Retail', location: 'Elorrio, Bizkaia', priority: 'low', detail: 'Agencia de viajes del grupo' },

            // MÁS BODEGAS RIOJA ALAVESA
            { id: 238, name: 'Bodegas Valdelana', sector: 'Vinos', location: 'Elciego, Araba', priority: 'medium', detail: 'Bodega familiar desde 1583' },
            { id: 239, name: 'Bodegas Torre de Oña', sector: 'Vinos', location: 'Páganos, Araba', priority: 'medium', detail: 'Grupo La Rioja Alta' },
            { id: 240, name: 'Bodegas Viña Salceda', sector: 'Vinos', location: 'Elciego, Araba', priority: 'medium', detail: 'Vinos de autor Rioja Alavesa' },
            { id: 241, name: 'Bodegas Remelluri', sector: 'Vinos', location: 'Labastida, Araba', priority: 'high', detail: 'Vinos ecológicos premium' },
            { id: 242, name: 'Bodegas Remirez de Ganuza', sector: 'Vinos', location: 'Samaniego, Araba', priority: 'high', detail: 'Vinos de alta gama, parcelas únicas' },
            { id: 243, name: 'Bodegas Laukote', sector: 'Vinos', location: 'Laguardia, Araba', priority: 'medium', detail: 'Bodega familiar cuarta generación' },
            { id: 244, name: 'Bodegas El Fabulista', sector: 'Vinos', location: 'Laguardia, Araba', priority: 'medium', detail: 'Bodega subterránea histórica' },
            { id: 245, name: 'Bodegas Amaren', sector: 'Vinos', location: 'Villabuena de Álava', priority: 'medium', detail: 'Grupo Luis Cañas' },
            { id: 246, name: 'Bodegas D. Mateos', sector: 'Vinos', location: 'Laguardia, Araba', priority: 'low', detail: 'Bodega tradicional' },
            { id: 247, name: 'Bodegas Fernando Remírez de Ganuza', sector: 'Vinos', location: 'Samaniego, Araba', priority: 'high', detail: 'Vinos icónicos Rioja Alavesa' },
            { id: 248, name: 'Bodegas Izadi', sector: 'Vinos', location: 'Villabuena de Álava', priority: 'medium', detail: 'Grupo Artevino' },
            { id: 249, name: 'Bodegas Finca de los Arandinos', sector: 'Vinos', location: 'Entrena, Araba', priority: 'medium', detail: 'Bodega con hotel' },
            { id: 250, name: 'Bodegas Baigorri', sector: 'Vinos', location: 'Samaniego, Araba', priority: 'high', detail: 'Arquitectura vanguardista, enoturismo' },

            // ALIMENTACIÓN
            { id: 251, name: 'Angulas Aguinaga', sector: 'Alimentación', location: 'Irura, Gipuzkoa', priority: 'high', detail: 'Fabricante de surimi y La Gula del Norte' },
            { id: 252, name: 'Conservas Campos', sector: 'Alimentación', location: 'Bermeo, Bizkaia', priority: 'medium', detail: 'Conservas de pescado tradicionales' },
            { id: 253, name: 'Conservas Zallo', sector: 'Alimentación', location: 'Bermeo, Bizkaia', priority: 'medium', detail: 'Anchoas y conservas del Cantábrico' },
            { id: 254, name: 'Gestión Alday', sector: 'Alimentación', location: 'Lezama, Bizkaia', priority: 'medium', detail: 'Producción de pan y bollería' },
            { id: 255, name: 'Harinas Ogi', sector: 'Alimentación', location: 'Bilbao', priority: 'medium', detail: 'Fabricante de harinas y derivados' },
            { id: 256, name: 'Eroski Alimentación', sector: 'Alimentación', location: 'Elorrio, Bizkaia', priority: 'high', detail: 'División alimentaria del grupo Eroski' },
            { id: 257, name: 'Iparlat', sector: 'Lácteos', location: 'Urnieta, Gipuzkoa', priority: 'high', detail: 'Fabricante de lácteos (Kaiku, Ohi)' },
            { id: 258, name: 'Aceites Urzante', sector: 'Alimentación', location: 'Tudela', priority: 'medium', detail: 'Fabricante de aceites de oliva' },
            { id: 259, name: 'Chocolates Zahor', sector: 'Alimentación', location: 'Tolosa, Gipuzkoa', priority: 'medium', detail: 'Chocolate artesano tradicional' },
            { id: 260, name: 'Pastas Gallo (Planta Granollers)', sector: 'Alimentación', location: 'Bilbao', priority: 'medium', detail: 'Distribución norte de pastas' },

            // CONSTRUCCIÓN (adicionales)
            { id: 261, name: 'Construcciones Balzola', sector: 'Construcción', location: 'Balmaseda, Bizkaia', priority: 'high', detail: 'Constructora de obra civil y edificación' },
            { id: 262, name: 'Ferrovial Construcción Euskadi', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Delegación de Ferrovial en Euskadi' },
            { id: 263, name: 'Construcciones ACR', sector: 'Construcción', location: 'Bilbao', priority: 'medium', detail: 'Constructora local edificación' },
            { id: 264, name: 'Excavaciones Mugarra', sector: 'Construcción', location: 'Muxika, Bizkaia', priority: 'medium', detail: 'Movimiento de tierras y excavaciones' },
            { id: 265, name: 'Construcciones Amenábar', sector: 'Construcción', location: 'Donostia', priority: 'medium', detail: 'Constructora de Gipuzkoa' },
            { id: 266, name: 'AZVI Construcción Euskadi', sector: 'Construcción', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Obra civil y concesiones' },

            // TELECOMUNICACIONES Y TECNOLOGÍA
            { id: 267, name: 'Euskaltel', sector: 'Telecomunicaciones', location: 'Derio, Bizkaia', priority: 'high', detail: 'Operador de telecomunicaciones. Grupo MasMovil' },
            { id: 268, name: 'Sarenet', sector: 'Telecomunicaciones', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Proveedor de servicios de internet empresas' },
            { id: 269, name: 'Lantik', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Informática y sistemas para empresas' },
            { id: 270, name: 'Ibermática', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Servicios tecnológicos. 3.500 empleados' },
            { id: 271, name: 'Informatica64 Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Consultoría y desarrollo software' },
            { id: 272, name: 'Semantic Systems', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Desarrollo de software a medida' },
            { id: 273, name: 'Tecnologías Plexus', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Soluciones software para industria' },
            { id: 274, name: 'Ulma Embedded Solutions', sector: 'Tecnología', location: 'Oñati, Gipuzkoa', priority: 'medium', detail: 'Sistemas embebidos industriales' },
            { id: 275, name: 'Savvy Data Systems', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Industria 4.0 y digitalización' },
            { id: 276, name: 'Nexus Integra', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Plataforma SCADA y gestión energética' },
            { id: 277, name: 'Virtualware', sector: 'Tecnología', location: 'Basauri, Bizkaia', priority: 'medium', detail: 'Realidad virtual y simuladores' },
            { id: 278, name: 'Sherpa.ai', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Inteligencia artificial conversacional' },
            { id: 279, name: 'Lantek', sector: 'Tecnología', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Software CAD/CAM para chapa. Líder mundial' },
            { id: 280, name: 'Ideko', sector: 'Tecnología', location: 'Elgoibar, Gipuzkoa', priority: 'medium', detail: 'Centro tecnológico de máquina-herramienta' },

            // SANIDAD Y FARMACÉUTICA
            { id: 281, name: 'Clínica IMQ', sector: 'Sanidad', location: 'Bilbao', priority: 'high', detail: 'Grupo hospitalario privado líder en Euskadi' },
            { id: 282, name: 'Policlínica Gipuzkoa', sector: 'Sanidad', location: 'Donostia', priority: 'medium', detail: 'Hospital privado referencia Gipuzkoa' },
            { id: 283, name: 'Quirónsalud Vitoria', sector: 'Sanidad', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Hospital privado Álava' },
            { id: 284, name: 'Grupo Biofarmaceutico Faes Farma', sector: 'Farmacéutica', location: 'Leioa, Bizkaia', priority: 'high', detail: 'Farmacéutica española. Cotiza en bolsa' },
            { id: 285, name: 'Bial Industrial', sector: 'Farmacéutica', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Fabricación farmacéutica' },

            // MEDIOS DE COMUNICACIÓN
            { id: 286, name: 'El Correo', sector: 'Medios', location: 'Bilbao', priority: 'medium', detail: 'Diario líder en Euskadi. Grupo Vocento' },
            { id: 287, name: 'Diario Vasco', sector: 'Medios', location: 'Donostia', priority: 'medium', detail: 'Diario de referencia en Gipuzkoa' },
            { id: 288, name: 'Deia', sector: 'Medios', location: 'Bilbao', priority: 'low', detail: 'Diario en euskera y castellano' },
            { id: 289, name: 'EITB', sector: 'Medios', location: 'Bilbao', priority: 'high', detail: 'Radiotelevisión pública vasca' },

            // DEPORTE
            { id: 290, name: 'Athletic Club', sector: 'Deporte', location: 'Bilbao', priority: 'high', detail: 'Club de fútbol histórico. San Mamés' },
            { id: 291, name: 'Real Sociedad', sector: 'Deporte', location: 'Donostia', priority: 'high', detail: 'Club de fútbol. Anoeta' },
            { id: 292, name: 'Alavés', sector: 'Deporte', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Club de fútbol' },
            { id: 293, name: 'Bilbao Basket', sector: 'Deporte', location: 'Bilbao', priority: 'medium', detail: 'Club de baloncesto ACB' },
            { id: 294, name: 'Baskonia', sector: 'Deporte', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Club de baloncesto Euroliga' },

            // EDUCACIÓN
            { id: 295, name: 'Universidad de Deusto', sector: 'Educación', location: 'Bilbao', priority: 'high', detail: 'Universidad privada jesuita' },
            { id: 296, name: 'Mondragon Unibertsitatea', sector: 'Educación', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Universidad cooperativa' },
            { id: 297, name: 'UPV/EHU', sector: 'Educación', location: 'Leioa, Bizkaia', priority: 'high', detail: 'Universidad pública del País Vasco' },
            { id: 298, name: 'IMH', sector: 'Educación', location: 'Elgoibar, Gipuzkoa', priority: 'medium', detail: 'Instituto Máquina Herramienta. FP especializada' },
            { id: 299, name: 'CPES Nazaret', sector: 'Educación', location: 'Donostia', priority: 'low', detail: 'Centro de formación profesional' },
            { id: 300, name: 'Centro San Viator', sector: 'Educación', location: 'Sopuerta, Bizkaia', priority: 'low', detail: 'FP industrial y mecánica' },

            // INFRAESTRUCTURAS Y PUERTOS
            { id: 301, name: 'Puerto de Bilbao', sector: 'Logística', location: 'Bilbao', priority: 'high', detail: 'Autoridad Portuaria. Puerto comercial líder' },
            { id: 302, name: 'Puerto de Pasaia', sector: 'Logística', location: 'Pasaia, Gipuzkoa', priority: 'medium', detail: 'Puerto pesquero y comercial' },
            { id: 303, name: 'Aeropuerto de Bilbao', sector: 'Logística', location: 'Loiu, Bizkaia', priority: 'high', detail: 'Aeropuerto internacional Loiu' },
            { id: 304, name: 'Aeropuerto de Vitoria', sector: 'Logística', location: 'Foronda, Araba', priority: 'medium', detail: 'Hub de carga aérea' },
            { id: 305, name: 'Noatum Terminal Bilbao', sector: 'Logística', location: 'Puerto de Bilbao', priority: 'high', detail: 'Terminal de contenedores' },

            // ELECTRODOMÉSTICOS
            { id: 306, name: 'Fagor Electrodomésticos (liquidada)', sector: 'Electrodomésticos', location: 'Mondragón, Gipuzkoa', priority: 'low', detail: 'Histórica de electrodomésticos' },
            { id: 307, name: 'Cointra (Grupo Bosch)', sector: 'Electrodomésticos', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Calentadores y calderas' },
            { id: 308, name: 'Electrolux Vitoria', sector: 'Electrodomésticos', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Planta de fabricación' },

            // MECANIZADO Y FABRICACIÓN (adicionales)
            { id: 309, name: 'Talleres Aratz', sector: 'Mecanizado', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Mecanizado de precisión' },
            { id: 310, name: 'Mecanizados Lazkano', sector: 'Mecanizado', location: 'Elgoibar, Gipuzkoa', priority: 'medium', detail: 'CNC y torneado' },
            { id: 311, name: 'Laulagun Bearings', sector: 'Fabricación', location: 'Bergara, Gipuzkoa', priority: 'medium', detail: 'Rodamientos especiales gran tamaño' },
            { id: 312, name: 'Alcorta Forging Group', sector: 'Fabricación', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Forja de precisión para automoción' },
            { id: 313, name: 'GSB Forja', sector: 'Fabricación', location: 'Legutiano, Araba', priority: 'medium', detail: 'Piezas forjadas' },
            { id: 314, name: 'Bellota Herramientas', sector: 'Fabricación', location: 'Legazpi, Gipuzkoa', priority: 'high', detail: 'Herramientas manuales. Marca histórica' },
            { id: 315, name: 'Irimo Tools', sector: 'Fabricación', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Herramientas manuales profesionales' },
            { id: 316, name: 'Bahco (filial SNA Europe)', sector: 'Fabricación', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Herramientas de mano premium' },
            { id: 317, name: 'Copreci', sector: 'Fabricación', location: 'Aretxabaleta, Gipuzkoa', priority: 'high', detail: 'Componentes para electrodomésticos. Mondragón' },
            { id: 318, name: 'Orkli', sector: 'Fabricación', location: 'Ordizia, Gipuzkoa', priority: 'medium', detail: 'Componentes gas y calefacción' },
            { id: 319, name: 'Embega', sector: 'Fabricación', location: 'Eskoriatza, Gipuzkoa', priority: 'medium', detail: 'Embalajes industriales' },
            { id: 320, name: 'Lazpiur', sector: 'Fabricación', location: 'Bergara, Gipuzkoa', priority: 'medium', detail: 'Tornillería especial alta resistencia' },
            { id: 321, name: 'ULMA Conveyor Components', sector: 'Fabricación', location: 'Oñati, Gipuzkoa', priority: 'medium', detail: 'Rodillos y componentes para cintas transportadoras' },
            { id: 322, name: 'ULMA Forklift Trucks', sector: 'Fabricación', location: 'Oñati, Gipuzkoa', priority: 'medium', detail: 'Carretillas elevadoras' },

            // EQUIPAMIENTO HOSTELERÍA
            { id: 323, name: 'Fagor Industrial', sector: 'Equipamiento', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Cocinas industriales para hostelería' },
            { id: 324, name: 'Sammic', sector: 'Equipamiento', location: 'Azkoitia, Gipuzkoa', priority: 'high', detail: 'Maquinaria para hostelería y alimentación' },
            { id: 325, name: 'Jata', sector: 'Equipamiento', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Pequeño electrodoméstico' },
            { id: 326, name: 'Teka Vitoria', sector: 'Equipamiento', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Electrodomésticos de cocina' },

            // ENERGÍA Y TECNOLOGÍA (adicionales)
            { id: 327, name: 'Lointek', sector: 'Energía', location: 'Urduliz, Bizkaia', priority: 'high', detail: 'Equipos para energía termosolar' },
            { id: 328, name: 'Ditrel', sector: 'Energía', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Instalaciones eléctricas industriales' },
            { id: 329, name: 'Ikusi', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Telecomunicaciones e integración tecnológica' },
            { id: 330, name: 'Teltronic', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Comunicaciones críticas TETRA' },

            // SERVICIOS
            { id: 331, name: 'Lur Paisajistak', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Paisajismo y jardinería' },
            { id: 332, name: 'ISS Facility Services Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Servicios de limpieza y mantenimiento' },
            { id: 333, name: 'Eulen Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Servicios integrales empresas' },
            { id: 334, name: 'Bidafarma Euskadi', sector: 'Distribución Farmacéutica', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Distribución a farmacias' },
            { id: 335, name: 'Alliance Healthcare Euskadi', sector: 'Distribución Farmacéutica', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Mayorista farmacéutico' },

            // FABRICACIÓN Y MADERA
            { id: 336, name: 'Azkoyen Vitoria', sector: 'Fabricación', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Máquinas vending y sistemas de pago' },
            { id: 337, name: 'Gámiz', sector: 'Fabricación', location: 'Igorre, Bizkaia', priority: 'medium', detail: 'Madera laminada estructural' },
            { id: 338, name: 'Egoin', sector: 'Fabricación', location: 'Arakaldo, Bizkaia', priority: 'medium', detail: 'Estructuras de madera' },
            { id: 339, name: 'Finsa Euskadi', sector: 'Fabricación', location: 'Bilbao', priority: 'medium', detail: 'Tableros de madera' },
            { id: 340, name: 'Ondarlan', sector: 'Fabricación', location: 'Oñati, Gipuzkoa', priority: 'medium', detail: 'Puertas y cerramientos' },

            // DISTRIBUCIÓN (adicionales)
            { id: 341, name: 'Distribuciones JL', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Distribución productos de consumo' },
            { id: 342, name: 'Almacenes Moyua', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Ferretería al por mayor' },
            { id: 343, name: 'Ferretería del Norte', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Distribución ferretería industrial' },
            { id: 344, name: 'Suministros Bikain', sector: 'Distribución', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Material de soldadura e industrial' },
            { id: 345, name: 'Comercial Hostelera', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Equipamiento para hostelería' },
            { id: 346, name: 'El Almacén Hostelero', sector: 'Distribución', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Menaje y equipamiento hostelería' },
            { id: 347, name: 'Suministros Eléctricos de Álava', sector: 'Distribución', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Material eléctrico mayorista' },
            { id: 348, name: 'Rexel Euskadi', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Distribución material eléctrico' },
            { id: 349, name: 'BricoMart Barakaldo', sector: 'Distribución', location: 'Barakaldo, Bizkaia', priority: 'medium', detail: 'Bricolaje y construcción profesional' },
            { id: 350, name: 'Leroy Merlin Bilbao', sector: 'Distribución', location: 'Barakaldo, Bizkaia', priority: 'medium', detail: 'Bricolaje y decoración' },

            // ========== AMPLIACIÓN: MÁS EMPRESAS DE EUSKADI ==========

            // AUTOMOCIÓN - Más empresas
            { id: 351, name: 'Grupo Ampo', sector: 'Automoción', location: 'Idiazabal, Gipuzkoa', priority: 'high', detail: 'Válvulas industriales para oil&gas' },
            { id: 352, name: 'Alcorta Forging Group', sector: 'Automoción', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Forja y estampación automoción' },
            { id: 353, name: 'Alfa Forjas', sector: 'Automoción', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Piezas forjadas para vehículos' },
            { id: 354, name: 'Fundiciones del Estanda', sector: 'Automoción', location: 'Lazkao, Gipuzkoa', priority: 'medium', detail: 'Fundición para automoción' },
            { id: 355, name: 'Industrias Alzuaran', sector: 'Automoción', location: 'Legazpi, Gipuzkoa', priority: 'medium', detail: 'Componentes metálicos' },
            { id: 356, name: 'Matrici', sector: 'Automoción', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Matrices y moldes automoción' },
            { id: 357, name: 'Estampaciones Bizkaia', sector: 'Automoción', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Estampación metálica' },
            { id: 358, name: 'GKN Driveline', sector: 'Automoción', location: 'Zumaia, Gipuzkoa', priority: 'high', detail: 'Transmisiones para vehículos' },
            { id: 359, name: 'Tenneco Ermua', sector: 'Automoción', location: 'Ermua, Bizkaia', priority: 'high', detail: 'Sistemas de escape' },
            { id: 360, name: 'ZF TRW', sector: 'Automoción', location: 'Abadiano, Bizkaia', priority: 'high', detail: 'Sistemas de frenado' },

            // INDUSTRIA - Más empresas manufactureras
            { id: 361, name: 'Industrias Urtaran', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Fabricación maquinaria industrial' },
            { id: 362, name: 'Talleres Jaso', sector: 'Industria', location: 'Itsasondo, Gipuzkoa', priority: 'high', detail: 'Grúas industriales' },
            { id: 363, name: 'GH Cranes', sector: 'Industria', location: 'Beasain, Gipuzkoa', priority: 'high', detail: 'Grúas y polipastos' },
            { id: 364, name: 'Konecranes Euskadi', sector: 'Industria', location: 'Bilbao', priority: 'medium', detail: 'Equipos de elevación' },
            { id: 365, name: 'Urssa', sector: 'Industria', location: 'Azkoitia, Gipuzkoa', priority: 'medium', detail: 'Estructuras metálicas' },
            { id: 366, name: 'Nortemecánica', sector: 'Industria', location: 'Bilbao', priority: 'medium', detail: 'Calderería y mecanizado' },
            { id: 367, name: 'Talleres Zangas', sector: 'Industria', location: 'Durango, Bizkaia', priority: 'medium', detail: 'Mecanizado de precisión' },
            { id: 368, name: 'Mecanizados Aurki', sector: 'Industria', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Piezas mecanizadas' },
            { id: 369, name: 'Industrias Anayak', sector: 'Industria', location: 'Legutio, Araba', priority: 'high', detail: 'Fresadoras industriales' },
            { id: 370, name: 'CME Etxetar', sector: 'Industria', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'Máquinas transfer' },

            // TECNOLOGÍA - Más empresas tech
            { id: 371, name: 'Ulma Embedded Solutions', sector: 'Tecnología', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Sistemas embebidos' },
            { id: 372, name: 'Sarenet', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Proveedor internet empresas' },
            { id: 373, name: 'Euskaltel', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'high', detail: 'Telecomunicaciones' },
            { id: 374, name: 'Grupo MásMóvil Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Telecomunicaciones' },
            { id: 375, name: 'Itelazpi', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Red telecomunicaciones Gobierno Vasco' },
            { id: 376, name: 'Nextel', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Ingeniería de telecomunicaciones' },
            { id: 377, name: 'Irontec', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Desarrollo software y VoIP' },
            { id: 378, name: 'Anboto', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Procesamiento lenguaje natural' },
            { id: 379, name: 'Batura Mobile', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Apps móviles' },
            { id: 380, name: 'Plain Concepts', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Desarrollo software y cloud' },
            { id: 381, name: 'Tecnologías Plexus', sector: 'Tecnología', location: 'Donostia', priority: 'medium', detail: 'Electrónica y sistemas' },
            { id: 382, name: 'Ceit', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Centro investigación aplicada' },
            { id: 383, name: 'Lortek', sector: 'Tecnología', location: 'Ordizia, Gipuzkoa', priority: 'medium', detail: 'Tecnologías de unión' },
            { id: 384, name: 'Ideko', sector: 'Tecnología', location: 'Elgoibar, Gipuzkoa', priority: 'high', detail: 'I+D máquina-herramienta' },
            { id: 385, name: 'Gaiker', sector: 'Tecnología', location: 'Zamudio, Bizkaia', priority: 'medium', detail: 'Centro tecnológico' },

            // ENERGÍA - Más empresas
            { id: 386, name: 'Ormazabal', sector: 'Energía', location: 'Igorre, Bizkaia', priority: 'high', detail: 'Equipos distribución eléctrica' },
            { id: 387, name: 'Zigor', sector: 'Energía', location: 'Igorre, Bizkaia', priority: 'medium', detail: 'SAIs y electrónica potencia' },
            { id: 388, name: 'Jema Energy', sector: 'Energía', location: 'Lasarte-Oria, Gipuzkoa', priority: 'high', detail: 'Electrónica de potencia' },
            { id: 389, name: 'Cegasa', sector: 'Energía', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Pilas y almacenamiento energía' },
            { id: 390, name: 'Iberdrola Renovables', sector: 'Energía', location: 'Bilbao', priority: 'high', detail: 'Energías renovables' },
            { id: 391, name: 'Solarpack Corporación', sector: 'Energía', location: 'Getxo, Bizkaia', priority: 'high', detail: 'Plantas solares' },
            { id: 392, name: 'Norvento', sector: 'Energía', location: 'Bilbao', priority: 'medium', detail: 'Energía eólica' },
            { id: 393, name: 'Cie Automotive E-mobility', sector: 'Energía', location: 'Bilbao', priority: 'high', detail: 'Movilidad eléctrica' },
            { id: 394, name: 'Ingemar', sector: 'Energía', location: 'Erandio, Bizkaia', priority: 'medium', detail: 'Ingeniería energética' },
            { id: 395, name: 'EDF Solar', sector: 'Energía', location: 'Bilbao', priority: 'medium', detail: 'Autoconsumo solar' },

            // CONSTRUCCIÓN - Más empresas
            { id: 396, name: 'Construcciones Olabarri', sector: 'Construcción', location: 'Bilbao', priority: 'medium', detail: 'Edificación' },
            { id: 397, name: 'Eguinoa Construcciones', sector: 'Construcción', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Obra civil' },
            { id: 398, name: 'Construcciones Moyua', sector: 'Construcción', location: 'Bilbao', priority: 'medium', detail: 'Rehabilitación' },
            { id: 399, name: 'Grupo Jaureguizar', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Promoción inmobiliaria' },
            { id: 400, name: 'Habitat Inmobiliaria', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Promoción viviendas' },
            { id: 401, name: 'Construcciones Galindo', sector: 'Construcción', location: 'Bizkaia', priority: 'medium', detail: 'Edificación residencial' },
            { id: 402, name: 'Urbas', sector: 'Construcción', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Construcción y promoción' },
            { id: 403, name: 'Ferrovial Euskadi', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Infraestructuras' },
            { id: 404, name: 'Acciona Euskadi', sector: 'Construcción', location: 'Bilbao', priority: 'high', detail: 'Construcción sostenible' },
            { id: 405, name: 'Construcciones Murua', sector: 'Construcción', location: 'Gipuzkoa', priority: 'medium', detail: 'Obras públicas' },

            // SERVICIOS PROFESIONALES - Más empresas
            { id: 406, name: 'Baker Tilly', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Auditoría y consultoría' },
            { id: 407, name: 'Grant Thornton', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Auditoría y asesoría' },
            { id: 408, name: 'BDO Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Auditoría y consultoría' },
            { id: 409, name: 'Cuatrecasas', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Despacho de abogados' },
            { id: 410, name: 'Garrigues', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Asesoría jurídica y fiscal' },
            { id: 411, name: 'Uría Menéndez', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Bufete de abogados' },
            { id: 412, name: 'Gómez-Acebo & Pombo', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Abogados' },
            { id: 413, name: 'Grupo Eulen Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Facility services' },
            { id: 414, name: 'Clece Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Servicios auxiliares' },
            { id: 415, name: 'Ilunion Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Servicios diversos' },

            // SALUD - Más empresas
            { id: 416, name: 'Hospital de Basurto', sector: 'Salud', location: 'Bilbao', priority: 'high', detail: 'Hospital público referencia' },
            { id: 417, name: 'Hospital de Cruces', sector: 'Salud', location: 'Barakaldo, Bizkaia', priority: 'high', detail: 'Hospital universitario' },
            { id: 418, name: 'Hospital Donostia', sector: 'Salud', location: 'Donostia', priority: 'high', detail: 'Hospital público Gipuzkoa' },
            { id: 419, name: 'Clínica IMQ Zorrotzaurre', sector: 'Salud', location: 'Bilbao', priority: 'high', detail: 'Hospital privado' },
            { id: 420, name: 'Clínica Indautxu', sector: 'Salud', location: 'Bilbao', priority: 'medium', detail: 'Clínica privada' },
            { id: 421, name: 'Vithas San José', sector: 'Salud', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Hospital privado' },
            { id: 422, name: 'Dental Company Euskadi', sector: 'Salud', location: 'Bilbao', priority: 'medium', detail: 'Clínicas dentales' },
            { id: 423, name: 'Grupo Osarten', sector: 'Salud', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Servicios médicos' },
            { id: 424, name: 'Aita Menni', sector: 'Salud', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Salud mental' },
            { id: 425, name: 'Mutualia', sector: 'Salud', location: 'Bilbao', priority: 'medium', detail: 'Mutua de accidentes' },

            // ALIMENTACIÓN - Más empresas
            { id: 426, name: 'Angulas Aguinaga', sector: 'Alimentación', location: 'Irura, Gipuzkoa', priority: 'high', detail: 'La Gula del Norte. Surimi' },
            { id: 427, name: 'Eroski Alimentación', sector: 'Alimentación', location: 'Elorrio, Bizkaia', priority: 'high', detail: 'Producción propia' },
            { id: 428, name: 'Iparlat', sector: 'Alimentación', location: 'Urnieta, Gipuzkoa', priority: 'high', detail: 'Productos lácteos' },
            { id: 429, name: 'Guria', sector: 'Alimentación', location: 'Bizkaia', priority: 'medium', detail: 'Conservas de verduras' },
            { id: 430, name: 'Horno Artesano', sector: 'Alimentación', location: 'Bilbao', priority: 'medium', detail: 'Panadería industrial' },
            { id: 431, name: 'Panificadora Urrutia', sector: 'Alimentación', location: 'Durango, Bizkaia', priority: 'medium', detail: 'Pan y bollería' },
            { id: 432, name: 'Txapela', sector: 'Alimentación', location: 'Gipuzkoa', priority: 'medium', detail: 'Pintxos y catering' },
            { id: 433, name: 'Embutidos Ezquerra', sector: 'Alimentación', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Embutidos tradicionales' },
            { id: 434, name: 'Queserías Vascas', sector: 'Alimentación', location: 'Gipuzkoa', priority: 'medium', detail: 'Quesos artesanos' },
            { id: 435, name: 'Basque Label', sector: 'Alimentación', location: 'Bilbao', priority: 'high', detail: 'Marca gastronómica vasca' },

            // LOGÍSTICA - Más empresas
            { id: 436, name: 'Bergé Logística', sector: 'Logística', location: 'Puerto de Bilbao', priority: 'high', detail: 'Operador logístico portuario' },
            { id: 437, name: 'Noatum Logistics', sector: 'Logística', location: 'Bilbao', priority: 'high', detail: 'Logística internacional' },
            { id: 438, name: 'Ceva Logistics', sector: 'Logística', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Supply chain' },
            { id: 439, name: 'Kuehne + Nagel', sector: 'Logística', location: 'Bilbao', priority: 'high', detail: 'Logística global' },
            { id: 440, name: 'FM Logistic', sector: 'Logística', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Almacenaje y distribución' },
            { id: 441, name: 'XPO Logistics', sector: 'Logística', location: 'Bizkaia', priority: 'high', detail: 'Transporte y logística' },
            { id: 442, name: 'Palibex', sector: 'Logística', location: 'Bilbao', priority: 'medium', detail: 'Paletería exprés' },
            { id: 443, name: 'Carreras Grupo Logístico', sector: 'Logística', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Transporte frigorífico' },
            { id: 444, name: 'Marcotran', sector: 'Logística', location: 'Bizkaia', priority: 'medium', detail: 'Transporte de mercancías' },
            { id: 445, name: 'Ontime', sector: 'Logística', location: 'Bilbao', priority: 'medium', detail: 'Última milla' },

            // RETAIL Y COMERCIO - Más empresas
            { id: 446, name: 'Zara (Inditex) Euskadi', sector: 'Distribución', location: 'Bilbao', priority: 'high', detail: 'Moda' },
            { id: 447, name: 'Mango Euskadi', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Moda' },
            { id: 448, name: 'Primark Bilbao', sector: 'Distribución', location: 'Bilbao', priority: 'high', detail: 'Moda low cost' },
            { id: 449, name: 'Fnac Bilbao', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Cultura y tecnología' },
            { id: 450, name: 'Worten', sector: 'Distribución', location: 'Bizkaia', priority: 'medium', detail: 'Electrónica' },
            { id: 451, name: 'Conforama', sector: 'Distribución', location: 'Barakaldo, Bizkaia', priority: 'medium', detail: 'Muebles y decoración' },
            { id: 452, name: 'Aki', sector: 'Distribución', location: 'Bizkaia', priority: 'medium', detail: 'Bricolaje' },
            { id: 453, name: 'Lidl Euskadi', sector: 'Distribución', location: 'Euskadi', priority: 'high', detail: 'Supermercados discount' },
            { id: 454, name: 'Aldi Euskadi', sector: 'Distribución', location: 'Euskadi', priority: 'high', detail: 'Supermercados discount' },
            { id: 455, name: 'Carrefour Euskadi', sector: 'Distribución', location: 'Euskadi', priority: 'high', detail: 'Hipermercados' },

            // HOSTELERÍA Y TURISMO - Más empresas
            { id: 456, name: 'Hotel Carlton', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Hotel histórico 5 estrellas' },
            { id: 457, name: 'Gran Hotel Domine', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Hotel de diseño' },
            { id: 458, name: 'Hotel María Cristina', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Hotel lujo festival cine' },
            { id: 459, name: 'Hotel de Londres', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Hotel histórico' },
            { id: 460, name: 'Barceló Nervión', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Hotel negocios' },
            { id: 461, name: 'Ibis Bilbao Centro', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Hotel económico' },
            { id: 462, name: 'Tryp Arenal', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Hotel urbano' },
            { id: 463, name: 'Restaurante Nerua', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: '1 estrella Michelin' },
            { id: 464, name: 'Restaurante Mina', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: '1 estrella Michelin' },
            { id: 465, name: 'Restaurante Elkano', sector: 'Servicios', location: 'Getaria, Gipuzkoa', priority: 'high', detail: '1 estrella Michelin. Pescados' },

            // EDUCACIÓN - Más centros
            { id: 466, name: 'Universidad del País Vasco (UPV/EHU)', sector: 'Servicios', location: 'Leioa, Bizkaia', priority: 'high', detail: 'Universidad pública' },
            { id: 467, name: 'Tecnun (Universidad Navarra)', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Ingeniería' },
            { id: 468, name: 'ESIC Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Escuela de negocios' },
            { id: 469, name: 'Deusto Business School', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'MBA y posgrados' },
            { id: 470, name: 'Cámara de Comercio Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Formación empresarial' },
            { id: 471, name: 'Cámara de Comercio Gipuzkoa', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Formación empresarial' },
            { id: 472, name: 'CIPB', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'FP industrial' },
            { id: 473, name: 'Egibide', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'FP' },
            { id: 474, name: 'Politeknika Ikastegia Txorierri', sector: 'Servicios', location: 'Derio, Bizkaia', priority: 'medium', detail: 'FP tecnológica' },
            { id: 475, name: 'San Viator Ikastetxea', sector: 'Servicios', location: 'Sopuerta, Bizkaia', priority: 'medium', detail: 'FP' },

            // BANCA Y SEGUROS - Más empresas
            { id: 476, name: 'Caixabank Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Banca retail' },
            { id: 477, name: 'Santander Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Banca' },
            { id: 478, name: 'Bankinter Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Banca' },
            { id: 479, name: 'Abanca Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Banca' },
            { id: 480, name: 'Mapfre Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Seguros' },
            { id: 481, name: 'Axa Seguros Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguros' },
            { id: 482, name: 'Zurich Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguros' },
            { id: 483, name: 'Allianz Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguros' },
            { id: 484, name: 'Santalucía Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguros' },
            { id: 485, name: 'Mutua Madrileña Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguros' },

            // MEDIOS DE COMUNICACIÓN
            { id: 486, name: 'EITB', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Televisión y radio pública vasca' },
            { id: 487, name: 'El Correo', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Periódico Vocento' },
            { id: 488, name: 'Diario Vasco', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Periódico Gipuzkoa' },
            { id: 489, name: 'Deia', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Periódico' },
            { id: 490, name: 'Berria', sector: 'Servicios', location: 'Andoain, Gipuzkoa', priority: 'medium', detail: 'Periódico en euskera' },
            { id: 491, name: 'Radio Bilbao (SER)', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Emisora de radio' },
            { id: 492, name: 'Onda Vasca', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Radio' },
            { id: 493, name: 'Hamaika TB', sector: 'Servicios', location: 'Andoain, Gipuzkoa', priority: 'medium', detail: 'TV local en euskera' },

            // OCIO Y DEPORTE
            { id: 494, name: 'Athletic Club', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Club de fútbol' },
            { id: 495, name: 'Real Sociedad', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Club de fútbol' },
            { id: 496, name: 'Deportivo Alavés', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Club de fútbol' },
            { id: 497, name: 'SD Eibar', sector: 'Servicios', location: 'Eibar, Gipuzkoa', priority: 'medium', detail: 'Club de fútbol' },
            { id: 498, name: 'Bilbao Basket', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Club de baloncesto' },
            { id: 499, name: 'Baskonia', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Club de baloncesto ACB' },
            { id: 500, name: 'Bizkaia Arena (BEC)', sector: 'Servicios', location: 'Barakaldo, Bizkaia', priority: 'high', detail: 'Recinto ferial y eventos' },

            // PYMES INDUSTRIALES - Bizkaia
            { id: 501, name: 'Talleres Galarraga', sector: 'Industria', location: 'Derio, Bizkaia', priority: 'low', detail: 'Mecanizado' },
            { id: 502, name: 'Mecanizados Bikandi', sector: 'Industria', location: 'Amorebieta, Bizkaia', priority: 'low', detail: 'Piezas industriales' },
            { id: 503, name: 'Industrias Lebario', sector: 'Industria', location: 'Igorre, Bizkaia', priority: 'low', detail: 'Fabricación metálica' },
            { id: 504, name: 'Tornillería Ugarte', sector: 'Industria', location: 'Durango, Bizkaia', priority: 'low', detail: 'Tornillería especial' },
            { id: 505, name: 'Estampaciones Deba', sector: 'Industria', location: 'Ermua, Bizkaia', priority: 'low', detail: 'Estampación' },
            { id: 506, name: 'Troqueles Durango', sector: 'Industria', location: 'Durango, Bizkaia', priority: 'low', detail: 'Matricería' },
            { id: 507, name: 'Recubrimientos Gasteiz', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'low', detail: 'Tratamientos superficiales' },
            { id: 508, name: 'Galvanizados Norte', sector: 'Industria', location: 'Bizkaia', priority: 'low', detail: 'Galvanizado' },
            { id: 509, name: 'Pintura Industrial Vizcaya', sector: 'Industria', location: 'Bizkaia', priority: 'low', detail: 'Pintura industrial' },
            { id: 510, name: 'Calderería Artia', sector: 'Industria', location: 'Bizkaia', priority: 'low', detail: 'Calderería ligera' },

            // PYMES INDUSTRIALES - Gipuzkoa
            { id: 511, name: 'Mecanizados Sarasola', sector: 'Industria', location: 'Azkoitia, Gipuzkoa', priority: 'low', detail: 'CNC' },
            { id: 512, name: 'Talleres Irizar', sector: 'Industria', location: 'Ormaiztegi, Gipuzkoa', priority: 'low', detail: 'Mecanizado' },
            { id: 513, name: 'Matricería Goitia', sector: 'Industria', location: 'Eibar, Gipuzkoa', priority: 'low', detail: 'Moldes' },
            { id: 514, name: 'Fundiciones Aranzabal', sector: 'Industria', location: 'Bergara, Gipuzkoa', priority: 'low', detail: 'Fundición' },
            { id: 515, name: 'Forjas Mondragón', sector: 'Industria', location: 'Mondragón, Gipuzkoa', priority: 'low', detail: 'Forja' },
            { id: 516, name: 'Tratamientos Térmicos Goi', sector: 'Industria', location: 'Gipuzkoa', priority: 'low', detail: 'Temple y revenido' },
            { id: 517, name: 'Electropulidos Urola', sector: 'Industria', location: 'Gipuzkoa', priority: 'low', detail: 'Acabados' },
            { id: 518, name: 'Soldadura Tolosaldea', sector: 'Industria', location: 'Tolosa, Gipuzkoa', priority: 'low', detail: 'Soldadura especializada' },
            { id: 519, name: 'Montajes Industriales Deba', sector: 'Industria', location: 'Deba, Gipuzkoa', priority: 'low', detail: 'Montajes' },
            { id: 520, name: 'Automatismos Irura', sector: 'Industria', location: 'Irura, Gipuzkoa', priority: 'low', detail: 'Automatización' },

            // PYMES INDUSTRIALES - Araba
            { id: 521, name: 'Mecanizados Aramaio', sector: 'Industria', location: 'Aramaio, Araba', priority: 'low', detail: 'Mecanizado' },
            { id: 522, name: 'Talleres Salvatierra', sector: 'Industria', location: 'Salvatierra, Araba', priority: 'low', detail: 'Reparaciones' },
            { id: 523, name: 'Industrias Rivabellosa', sector: 'Industria', location: 'Rivabellosa, Araba', priority: 'low', detail: 'Fabricación' },
            { id: 524, name: 'Montajes Llodio', sector: 'Industria', location: 'Llodio, Araba', priority: 'low', detail: 'Montajes industriales' },
            { id: 525, name: 'Estructuras Metálicas Álava', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'low', detail: 'Estructuras' },

            // COMERCIOS Y SERVICIOS LOCALES - Bilbao
            { id: 526, name: 'Perfumería Egia', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Perfumería tradicional' },
            { id: 527, name: 'Librería Cámara', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Librería histórica' },
            { id: 528, name: 'Joyería Gordillo', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Joyería' },
            { id: 529, name: 'Ópticas Arana', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Óptica' },
            { id: 530, name: 'Deportes Bizkaia', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Artículos deportivos' },
            { id: 531, name: 'Electrodomésticos Tien21', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Electrodomésticos' },
            { id: 532, name: 'Muebles Bidasoa', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Mobiliario' },
            { id: 533, name: 'Floristería Moyua', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Floristería' },
            { id: 534, name: 'Tintorería Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Tintorería' },
            { id: 535, name: 'Gimnasio Metropolitan', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Gimnasio premium' },

            // STARTUPS Y EMPRESAS INNOVADORAS
            { id: 536, name: 'Ticketbis (StubHub)', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Reventa de entradas (vendida a eBay)' },
            { id: 537, name: 'Lookiero', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Personal shopper online' },
            { id: 538, name: 'Multiverse Computing', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Computación cuántica' },
            { id: 539, name: 'Pivotal', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Software empresarial' },
            { id: 540, name: 'Wave Application', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Proptech' },
            { id: 541, name: 'Bookndo', sector: 'Tecnología', location: 'Bilbao', priority: 'low', detail: 'Reservas online' },
            { id: 542, name: 'GamersWalk', sector: 'Tecnología', location: 'Bilbao', priority: 'low', detail: 'Gaming y esports' },
            { id: 543, name: 'Sngular Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Consultoría digital' },
            { id: 544, name: 'NTT Data Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Consultoría IT' },
            { id: 545, name: 'Capgemini Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Consultoría y tecnología' },

            // MÁS EMPRESAS COOPERATIVAS MONDRAGÓN
            { id: 546, name: 'Eroski S. Coop', sector: 'Distribución', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Distribución alimentaria' },
            { id: 547, name: 'Caja Laboral', sector: 'Servicios', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Banca cooperativa' },
            { id: 548, name: 'Lagun Aro', sector: 'Servicios', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Previsión social' },
            { id: 549, name: 'Fagor Ederlan', sector: 'Automoción', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Fundición automoción' },
            { id: 550, name: 'Ulma Construcción', sector: 'Construcción', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Encofrados y andamios' },
            { id: 551, name: 'Ulma Packaging', sector: 'Industria', location: 'Oñati, Gipuzkoa', priority: 'high', detail: 'Maquinaria envasado' },
            { id: 552, name: 'Ulma Agrícola', sector: 'Industria', location: 'Oñati, Gipuzkoa', priority: 'medium', detail: 'Invernaderos' },
            { id: 553, name: 'Fagor Industrial', sector: 'Industria', location: 'Mondragón, Gipuzkoa', priority: 'high', detail: 'Equipamiento hostelería' },
            { id: 554, name: 'Orkli', sector: 'Industria', location: 'Ordizia, Gipuzkoa', priority: 'high', detail: 'Componentes solar y calefacción' },
            { id: 555, name: 'Copreci', sector: 'Industria', location: 'Aretxabaleta, Gipuzkoa', priority: 'high', detail: 'Componentes electrodomésticos' },

            // AGENCIAS Y CONSULTORAS
            { id: 556, name: 'Grupo Noticias', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Grupo editorial' },
            { id: 557, name: 'McCann Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Agencia publicidad' },
            { id: 558, name: 'Ogilvy Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Agencia publicidad' },
            { id: 559, name: 'Havas Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Agencia publicidad' },
            { id: 560, name: 'MRM Partners', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Marketing digital' },
            { id: 561, name: 'The Mood Project', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Branding' },
            { id: 562, name: 'Ondoan', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Instalaciones' },
            { id: 563, name: 'LKS Ingeniería', sector: 'Servicios', location: 'Mondragón, Gipuzkoa', priority: 'medium', detail: 'Ingeniería y arquitectura' },
            { id: 564, name: 'Idom', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Ingeniería y consultoría' },
            { id: 565, name: 'Tecnalia Research', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'high', detail: 'Investigación aplicada' },

            // FARMACIA Y PARAFARMACIA
            { id: 566, name: 'Farmacia Bidebieta', sector: 'Salud', location: 'Donostia', priority: 'low', detail: 'Farmacia' },
            { id: 567, name: 'Farmacia Abando', sector: 'Salud', location: 'Bilbao', priority: 'low', detail: 'Farmacia' },
            { id: 568, name: 'Farmacias Trébol', sector: 'Salud', location: 'Bizkaia', priority: 'low', detail: 'Cadena farmacias' },
            { id: 569, name: 'Ortopedia Bizkaia', sector: 'Salud', location: 'Bilbao', priority: 'low', detail: 'Ortopedia' },
            { id: 570, name: 'Óptica Universitaria', sector: 'Salud', location: 'Bilbao', priority: 'low', detail: 'Óptica' },

            // EMPRESAS DE LIMPIEZA Y MANTENIMIENTO
            { id: 571, name: 'Garbialdi', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Limpieza industrial' },
            { id: 572, name: 'Limpiezas Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Limpieza' },
            { id: 573, name: 'Mantenimiento Norte', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Mantenimiento edificios' },
            { id: 574, name: 'Jardinería Vizcaya', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Jardinería' },
            { id: 575, name: 'Plagas Control', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Control de plagas' },

            // AUTOESCUELAS Y FORMACIÓN VIAL
            { id: 576, name: 'Autoescuela Leioa', sector: 'Servicios', location: 'Leioa, Bizkaia', priority: 'low', detail: 'Autoescuela' },
            { id: 577, name: 'Autoescuela Irrintzi', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Autoescuela' },
            { id: 578, name: 'Academia Gorbea', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Oposiciones' },
            { id: 579, name: 'Academia Adams Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Oposiciones' },
            { id: 580, name: 'MasterD Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Formación' },

            // INMOBILIARIAS
            { id: 581, name: 'Engel & Völkers Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Inmobiliaria lujo' },
            { id: 582, name: 'Tecnocasa Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Inmobiliaria' },
            { id: 583, name: 'Redpiso Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Inmobiliaria' },
            { id: 584, name: 'Century 21 Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Inmobiliaria' },
            { id: 585, name: 'Comprarcasa', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Inmobiliaria' },

            // EMPRESAS QUÍMICAS Y FARMAQUÍMICAS
            { id: 586, name: 'Petronor', sector: 'Industria', location: 'Muskiz, Bizkaia', priority: 'high', detail: 'Refinería' },
            { id: 587, name: 'Industrias Químicas del Nervión', sector: 'Industria', location: 'Bizkaia', priority: 'medium', detail: 'Química industrial' },
            { id: 588, name: 'Quimicas Meristem', sector: 'Industria', location: 'Gipuzkoa', priority: 'low', detail: 'Química agrícola' },
            { id: 589, name: 'Pinturas Hempel', sector: 'Industria', location: 'Bizkaia', priority: 'medium', detail: 'Pinturas marinas' },
            { id: 590, name: 'Jotun Paints Euskadi', sector: 'Industria', location: 'Bizkaia', priority: 'medium', detail: 'Pinturas industriales' },

            // TRANSPORTE PÚBLICO Y MOVILIDAD
            { id: 591, name: 'Metro Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Transporte metro' },
            { id: 592, name: 'Euskotren', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Ferrocarril vasco' },
            { id: 593, name: 'Bizkaibus', sector: 'Servicios', location: 'Bizkaia', priority: 'high', detail: 'Autobuses interurbanos' },
            { id: 594, name: 'Bilbobus', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Autobuses urbanos' },
            { id: 595, name: 'Lurraldebus', sector: 'Servicios', location: 'Gipuzkoa', priority: 'high', detail: 'Autobuses Gipuzkoa' },
            { id: 596, name: 'Tuvisa', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'high', detail: 'Autobuses Vitoria' },
            { id: 597, name: 'Tranvía de Vitoria', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Tranvía' },
            { id: 598, name: 'Funicular de Artxanda', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Funicular turístico' },

            // EMPRESAS DE EVENTOS
            { id: 599, name: 'Euskalduna Jauregia', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Palacio congresos' },
            { id: 600, name: 'Kursaal', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Centro congresos' },
            { id: 601, name: 'Bilbao Exhibition Centre', sector: 'Servicios', location: 'Barakaldo, Bizkaia', priority: 'high', detail: 'Feria y eventos' },
            { id: 602, name: 'Festival de Cine San Sebastián', sector: 'Servicios', location: 'Donostia', priority: 'high', detail: 'Festival cine' },
            { id: 603, name: 'BBK Live', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Festival música' },
            { id: 604, name: 'Bilbao BBK Live', sector: 'Servicios', location: 'Kobetamendi, Bizkaia', priority: 'high', detail: 'Festival música' },
            { id: 605, name: 'Azkena Rock Festival', sector: 'Servicios', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Festival rock' },

            // GESTORÍAS Y ASESORÍAS
            { id: 606, name: 'Gestoría Mungia', sector: 'Servicios', location: 'Mungia, Bizkaia', priority: 'low', detail: 'Gestoría' },
            { id: 607, name: 'Asesoría Deusto', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Asesoría fiscal' },
            { id: 608, name: 'Gestoría Barakaldo', sector: 'Servicios', location: 'Barakaldo, Bizkaia', priority: 'low', detail: 'Gestoría' },
            { id: 609, name: 'ETL Global Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Asesoría internacional' },
            { id: 610, name: 'Addwill', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Consultoría estratégica' },

            // CONCESIONARIOS COCHES
            { id: 611, name: 'Lurauto', sector: 'Distribución', location: 'Bizkaia', priority: 'medium', detail: 'Concesionario multimarca' },
            { id: 612, name: 'Leioa Wagen', sector: 'Distribución', location: 'Leioa, Bizkaia', priority: 'medium', detail: 'Volkswagen' },
            { id: 613, name: 'Berri Auto', sector: 'Distribución', location: 'Bilbao', priority: 'medium', detail: 'Toyota' },
            { id: 614, name: 'Grupo Santogal', sector: 'Distribución', location: 'Bizkaia', priority: 'medium', detail: 'Multimarca' },
            { id: 615, name: 'Autobeltran', sector: 'Distribución', location: 'Gipuzkoa', priority: 'low', detail: 'Vehículos' },
            { id: 616, name: 'Laboral Auto', sector: 'Distribución', location: 'Mondragón, Gipuzkoa', priority: 'low', detail: 'Vehículos' },

            // ENERGÍAS RENOVABLES Y MEDIO AMBIENTE
            { id: 617, name: 'EVE (Ente Vasco Energía)', sector: 'Energía', location: 'Bilbao', priority: 'high', detail: 'Agencia energética vasca' },
            { id: 618, name: 'Ihobe', sector: 'Servicios', location: 'Bilbao', priority: 'high', detail: 'Sociedad pública medio ambiente' },
            { id: 619, name: 'Naturgas', sector: 'Energía', location: 'Bilbao', priority: 'medium', detail: 'Distribución gas' },
            { id: 620, name: 'Holaluz Euskadi', sector: 'Energía', location: 'Bilbao', priority: 'medium', detail: 'Comercializadora verde' },
            { id: 621, name: 'Goiener', sector: 'Energía', location: 'Ordizia, Gipuzkoa', priority: 'medium', detail: 'Cooperativa energía' },
            { id: 622, name: 'Ekiola', sector: 'Energía', location: 'Gipuzkoa', priority: 'medium', detail: 'Autoconsumo colectivo' },

            // TRATAMIENTO DE RESIDUOS
            { id: 623, name: 'FCC Medio Ambiente Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Gestión residuos' },
            { id: 624, name: 'Cespa', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Recogida residuos' },
            { id: 625, name: 'Contenur', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Contenedores plástico' },
            { id: 626, name: 'Saica Natur', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Reciclaje papel' },
            { id: 627, name: 'Ecoembes Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Reciclaje envases' },

            // INDUSTRIA NAVAL
            { id: 628, name: 'Astilleros Zamakona', sector: 'Industria', location: 'Santurtzi, Bizkaia', priority: 'high', detail: 'Construcción naval' },
            { id: 629, name: 'La Naval', sector: 'Industria', location: 'Sestao, Bizkaia', priority: 'high', detail: 'Astillero' },
            { id: 630, name: 'Balenciaga', sector: 'Industria', location: 'Zumaia, Gipuzkoa', priority: 'medium', detail: 'Astillero' },
            { id: 631, name: 'Murueta', sector: 'Industria', location: 'Murueta, Bizkaia', priority: 'medium', detail: 'Reparación naval' },
            { id: 632, name: 'Astander', sector: 'Industria', location: 'Erandio, Bizkaia', priority: 'medium', detail: 'Reparaciones navales' },

            // EMPRESAS TEXTILES
            { id: 633, name: 'Olatu', sector: 'Industria', location: 'Gipuzkoa', priority: 'low', detail: 'Confección' },
            { id: 634, name: 'Tex Euskadi', sector: 'Industria', location: 'Bizkaia', priority: 'low', detail: 'Textil técnico' },
            { id: 635, name: 'Uniformes Norte', sector: 'Industria', location: 'Bilbao', priority: 'low', detail: 'Ropa laboral' },

            // CONSULTORÍA AMBIENTAL
            { id: 636, name: 'Neiker', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'high', detail: 'Instituto investigación agraria' },
            { id: 637, name: 'Azti', sector: 'Tecnología', location: 'Pasaia, Gipuzkoa', priority: 'high', detail: 'Investigación marina y alimentaria' },
            { id: 638, name: 'BC3 Basque Centre Climate', sector: 'Tecnología', location: 'Leioa, Bizkaia', priority: 'high', detail: 'Investigación cambio climático' },
            { id: 639, name: 'Labein-Tecnalia', sector: 'Tecnología', location: 'Derio, Bizkaia', priority: 'high', detail: 'I+D construcción' },
            { id: 640, name: 'CIC Nanogune', sector: 'Tecnología', location: 'Donostia', priority: 'high', detail: 'Nanotecnología' },

            // AGENCIAS DE VIAJES
            { id: 641, name: 'Viajes Eroski', sector: 'Servicios', location: 'Elorrio, Bizkaia', priority: 'medium', detail: 'Agencia viajes' },
            { id: 642, name: 'Halcón Viajes Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Agencia viajes' },
            { id: 643, name: 'Barceló Viajes Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Agencia viajes' },
            { id: 644, name: 'El Corte Inglés Viajes', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Agencia viajes' },
            { id: 645, name: 'Pangea Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Viajes premium' },

            // CLÍNICAS VETERINARIAS
            { id: 646, name: 'Hospital Veterinario Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Veterinaria' },
            { id: 647, name: 'AniCura Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Hospital veterinario' },
            { id: 648, name: 'Clínica Veterinaria Getxo', sector: 'Servicios', location: 'Getxo, Bizkaia', priority: 'low', detail: 'Veterinaria' },

            // EMPRESAS DE SEGURIDAD
            { id: 649, name: 'Securitas Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguridad privada' },
            { id: 650, name: 'Prosegur Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Seguridad' },
            { id: 651, name: 'Grupo Control Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Vigilancia' },

            // EMPRESAS DE SOFTWARE ESPECIALIZADAS
            { id: 652, name: 'Bilbomática', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Software sector público' },
            { id: 653, name: 'Informatica68', sector: 'Tecnología', location: 'Bizkaia', priority: 'low', detail: 'Software empresarial' },
            { id: 654, name: 'Gfi Informatique', sector: 'Tecnología', location: 'Bilbao', priority: 'medium', detail: 'Servicios IT' },
            { id: 655, name: 'Sopra Steria Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Consultoría digital' },
            { id: 656, name: 'Atos Euskadi', sector: 'Tecnología', location: 'Bilbao', priority: 'high', detail: 'Servicios IT' },

            // TALLERES DE AUTOMOCIÓN
            { id: 657, name: 'Norauto Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Taller coches' },
            { id: 658, name: 'Midas Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Taller rápido' },
            { id: 659, name: 'Aurgi', sector: 'Distribución', location: 'Bizkaia', priority: 'low', detail: 'Accesorios coche' },
            { id: 660, name: 'Feu Vert Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Taller y accesorios' },

            // COWORKINGS Y ESPACIOS DE INNOVACIÓN
            { id: 661, name: 'BTEK', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Centro interpretación tecnología' },
            { id: 662, name: 'Bilbao Berrikuntza Faktoria', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Hub innovación' },
            { id: 663, name: 'As Fabrik', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Incubadora startups' },
            { id: 664, name: 'Impact Hub Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Coworking' },
            { id: 665, name: 'Talent Garden Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Campus innovación' },

            // PAPELERÍAS Y MATERIAL DE OFICINA
            { id: 666, name: 'Folder Euskadi', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Papelería' },
            { id: 667, name: 'Staples Euskadi', sector: 'Distribución', location: 'Bizkaia', priority: 'medium', detail: 'Material oficina' },
            { id: 668, name: 'Ofiservice', sector: 'Distribución', location: 'Bilbao', priority: 'low', detail: 'Suministros oficina' },

            // EMPRESAS DE PACKAGING
            { id: 669, name: 'Smurfit Kappa Nervión', sector: 'Industria', location: 'Durango, Bizkaia', priority: 'high', detail: 'Embalaje cartón' },
            { id: 670, name: 'DS Smith Bilbao', sector: 'Industria', location: 'Bizkaia', priority: 'medium', detail: 'Packaging' },
            { id: 671, name: 'Saica Pack Vitoria', sector: 'Industria', location: 'Vitoria-Gasteiz', priority: 'medium', detail: 'Embalaje' },

            // EMPRESAS DE BEBIDAS
            { id: 672, name: 'La Salve', sector: 'Alimentación', location: 'Bilbao', priority: 'medium', detail: 'Cerveza artesana' },
            { id: 673, name: 'Basqueland Brewing', sector: 'Alimentación', location: 'Hernani, Gipuzkoa', priority: 'medium', detail: 'Cerveza craft' },
            { id: 674, name: 'Lur Brewery', sector: 'Alimentación', location: 'Bizkaia', priority: 'low', detail: 'Cerveza artesana' },
            { id: 675, name: 'Txakolí Ameztoi', sector: 'Alimentación', location: 'Getaria, Gipuzkoa', priority: 'medium', detail: 'Bodega txakolí' },
            { id: 676, name: 'Bodegas Itsasmendi', sector: 'Alimentación', location: 'Gernika, Bizkaia', priority: 'medium', detail: 'Txakolí Bizkaia' },

            // SIDRERÍAS Y GASTRONOMÍA
            { id: 677, name: 'Sidrería Petritegi', sector: 'Alimentación', location: 'Astigarraga, Gipuzkoa', priority: 'medium', detail: 'Sidrería tradicional' },
            { id: 678, name: 'Sidrería Zelaia', sector: 'Alimentación', location: 'Hernani, Gipuzkoa', priority: 'low', detail: 'Sidrería' },
            { id: 679, name: 'Asador Etxebarri', sector: 'Servicios', location: 'Axpe, Bizkaia', priority: 'high', detail: '1 estrella Michelin. Parrilla' },
            { id: 680, name: 'Mugaritz', sector: 'Servicios', location: 'Errenteria, Gipuzkoa', priority: 'high', detail: '2 estrellas Michelin' },

            // MÁS PYMES VARIADAS
            { id: 681, name: 'Carpintería Arteaga', sector: 'Industria', location: 'Bizkaia', priority: 'low', detail: 'Carpintería madera' },
            { id: 682, name: 'Carpintería Metálica Deusto', sector: 'Industria', location: 'Bilbao', priority: 'low', detail: 'Cerrajería' },
            { id: 683, name: 'Electricidad Indautxu', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Instalaciones eléctricas' },
            { id: 684, name: 'Fontanería Santutxu', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Fontanería' },
            { id: 685, name: 'Climatización Bizkaia', sector: 'Servicios', location: 'Bizkaia', priority: 'low', detail: 'Aire acondicionado' },
            { id: 686, name: 'Ascensores Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Ascensores' },
            { id: 687, name: 'Otis Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Ascensores' },
            { id: 688, name: 'Schindler Euskadi', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Ascensores' },
            { id: 689, name: 'Thyssenkrupp Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Ascensores' },
            { id: 690, name: 'Kone Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Ascensores' },

            // NOTARÍAS Y REGISTROS
            { id: 691, name: 'Notaría Plaza Nueva', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Notaría' },
            { id: 692, name: 'Notaría Gran Vía', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Notaría' },
            { id: 693, name: 'Registro Propiedad Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Registro' },

            // CENTROS DEPORTIVOS
            { id: 694, name: 'Supera Bilbao', sector: 'Servicios', location: 'Bilbao', priority: 'medium', detail: 'Gimnasio' },
            { id: 695, name: 'Altafit Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Gimnasio low cost' },
            { id: 696, name: 'Basic Fit Euskadi', sector: 'Servicios', location: 'Bizkaia', priority: 'medium', detail: 'Gimnasio 24h' },
            { id: 697, name: 'Anaitasuna', sector: 'Servicios', location: 'Bilbao', priority: 'low', detail: 'Club deportivo' },
            { id: 698, name: 'Club Deportivo Bizkaia', sector: 'Servicios', location: 'Getxo, Bizkaia', priority: 'low', detail: 'Club deportivo' },
            { id: 699, name: 'Real Club de Tenis San Sebastián', sector: 'Servicios', location: 'Donostia', priority: 'medium', detail: 'Club tenis' },
            { id: 700, name: 'Golf Neguri', sector: 'Servicios', location: 'Getxo, Bizkaia', priority: 'medium', detail: 'Club golf' },
        *** FIN DEL ARRAY ELIMINADO ***/

        // Estado de la aplicación
        let appData = {
            prospects: [],
            pipeline: {
                contactado: [],
                reunion: [],
                piloto: [],
                cliente: []
            }
        };

        // ============================================
        // SISTEMA DE FACTURACIÓN Y TIERS
        // ============================================

        // Variable global para filtro de tier activo
        let activeTierFilter = '';

        // Extraer facturación del campo detail (formato: "Facturación: 11358M€ · 0 empleados")
        function parseRevenue(detail) {
            if (!detail) return 0;
            const match = detail.match(/Facturación:\s*([\d.,]+)(M|K)?€/i);
            if (!match) return 0;

            let value = parseFloat(match[1].replace('.', '').replace(',', '.'));
            const unit = match[2]?.toUpperCase();

            if (unit === 'M') return value; // Ya está en millones
            if (unit === 'K') return value / 1000; // Convertir K a M
            return value / 1000; // Asumir que está en miles si no tiene unidad
        }

        // Clasificar empresa por tier según facturación
        function getRevenueTier(revenue) {
            if (revenue >= 100) return 'enterprise';  // > 100M€
            if (revenue >= 10) return 'midmarket';    // 10-100M€
            if (revenue >= 1) return 'pyme';          // 1-10M€
            return 'micro';                           // < 1M€
        }

        // Obtener nombre del tier
        function getTierName(tier) {
            const names = {
                'enterprise': 'Enterprise',
                'midmarket': 'Mid-Market',
                'pyme': 'PYME',
                'micro': 'Micro'
            };
            return names[tier] || tier;
        }

        // Formatear facturación para display
        function formatRevenue(revenue) {
            if (revenue >= 1000) return (revenue / 1000).toFixed(0) + 'B€';
            if (revenue >= 1) return revenue.toFixed(0) + 'M€';
            if (revenue >= 0.001) return (revenue * 1000).toFixed(0) + 'K€';
            return 'N/D';
        }

        // Calcular porcentaje para barra de revenue (escala logarítmica)
        function getRevenueBarWidth(revenue) {
            if (revenue <= 0) return 5;
            // Escala logarítmica: max ~12000M€ (Iberdrola)
            const maxLog = Math.log10(12000);
            const valueLog = Math.log10(Math.max(revenue, 0.1));
            return Math.min(100, Math.max(5, (valueLog / maxLog) * 100));
        }

        // Filtrar por tier (click en pills o dashboard)
        function filterByTier(tier) {
            activeTierFilter = tier;

            // Actualizar pills activos
            document.querySelectorAll('.filter-pill').forEach(pill => {
                pill.classList.toggle('active', pill.dataset.tier === tier);
            });

            // Actualizar dashboard - añadir clase has-filter si hay filtro
            const dashboard = document.getElementById('statsDashboard');
            if (dashboard) {
                dashboard.classList.toggle('has-filter', tier !== '');
            }

            // Actualizar stat cards
            document.querySelectorAll('.stat-card').forEach(card => {
                card.classList.remove('active');
            });
            if (tier) {
                const card = document.getElementById('stat' + tier.charAt(0).toUpperCase() + tier.slice(1));
                if (card) card.classList.add('active');
            }

            filterProspects();
        }

        // Actualizar dashboard de estadísticas
        function updateStatsDashboard() {
            const prospects = getByStatus('porcontactar');

            let counts = { enterprise: 0, midmarket: 0, pyme: 0, micro: 0 };
            let revenues = { enterprise: 0, midmarket: 0, pyme: 0, micro: 0 };

            prospects.forEach(p => {
                const revenue = parseRevenue(p.detail);
                const tier = getRevenueTier(revenue);
                counts[tier]++;
                revenues[tier] += revenue;
            });

            // Actualizar contadores
            document.getElementById('countEnterprise').textContent = counts.enterprise.toLocaleString();
            document.getElementById('countMidmarket').textContent = counts.midmarket.toLocaleString();
            document.getElementById('countPyme').textContent = counts.pyme.toLocaleString();
            document.getElementById('countMicro').textContent = counts.micro.toLocaleString();

            // Actualizar gráficos
            renderCharts(prospects);
        }

        // Renderizar gráficos de distribución
        function renderCharts(prospects) {
            // Contar por sector
            const sectorCounts = {};
            const provinciaCounts = {};

            prospects.forEach(p => {
                // Sector
                const sector = p.sector || 'Otros';
                sectorCounts[sector] = (sectorCounts[sector] || 0) + 1;

                // Provincia
                const location = p.location || '';
                let provincia = 'Otros';
                if (location.includes('Bizkaia')) provincia = 'Bizkaia';
                else if (location.includes('Gipuzkoa')) provincia = 'Gipuzkoa';
                else if (location.includes('Araba') || location.includes('Álava')) provincia = 'Araba';
                else if (location.includes('Euskadi')) provincia = 'Euskadi';
                provinciaCounts[provincia] = (provinciaCounts[provincia] || 0) + 1;
            });

            // Ordenar sectores por cantidad
            const sortedSectors = Object.entries(sectorCounts)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 8); // Top 8

            const sortedProvincias = Object.entries(provinciaCounts)
                .sort((a, b) => b[1] - a[1]);

            const maxSector = sortedSectors[0]?.[1] || 1;
            const maxProvincia = sortedProvincias[0]?.[1] || 1;

            // Render sector chart
            const sectorChart = document.getElementById('chartSector');
            if (sectorChart) {
                sectorChart.innerHTML = sortedSectors.map(([sector, count]) => {
                    const pct = (count / maxSector) * 100;
                    const barClass = 'bar-' + sector.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-z]/g, '');
                    return `
                        <div class="chart-bar-item">
                            <span class="chart-bar-label">${sector}</span>
                            <div class="chart-bar-container">
                                <div class="chart-bar-fill ${barClass || 'bar-default'}" style="width: ${pct}%"></div>
                            </div>
                            <span class="chart-bar-value">${count.toLocaleString()}</span>
                        </div>
                    `;
                }).join('');
            }

            // Render provincia chart
            const provinciaChart = document.getElementById('chartProvincia');
            if (provinciaChart) {
                provinciaChart.innerHTML = sortedProvincias.map(([provincia, count]) => {
                    const pct = (count / maxProvincia) * 100;
                    const barClass = 'bar-' + provincia.toLowerCase();
                    return `
                        <div class="chart-bar-item">
                            <span class="chart-bar-label">${provincia}</span>
                            <div class="chart-bar-container">
                                <div class="chart-bar-fill ${barClass || 'bar-default'}" style="width: ${pct}%"></div>
                            </div>
                            <span class="chart-bar-value">${count.toLocaleString()}</span>
                        </div>
                    `;
                }).join('');
            }
        }

        // Cargar datos desde localStorage o usar iniciales
        function loadData() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                try {
                    const parsed = JSON.parse(saved);
                    // Si hay menos empresas que las nuevas, actualizar manteniendo el progreso
                    if (parsed.prospects && parsed.prospects.length < initialProspects.length) {
                        console.log('Nuevas empresas detectadas. Actualizando de ' + parsed.prospects.length + ' a ' + initialProspects.length);
                        // Mantener el estado de las empresas existentes
                        const existingStatus = {};
                        parsed.prospects.forEach(p => { existingStatus[p.id] = p.status; });
                        // Crear nueva lista con todas las empresas
                        appData = {
                            prospects: initialProspects.map(p => ({
                                ...p,
                                status: existingStatus[p.id] || 'porcontactar'
                            })),
                            pipeline: parsed.pipeline || { contactado: [], reunion: [], piloto: [], cliente: [] }
                        };
                        saveData();
                    } else {
                        appData = parsed;
                    }
                    console.log('Datos cargados: ' + appData.prospects.length + ' empresas');
                } catch (e) {
                    console.log('Error cargando datos, usando iniciales');
                    resetToInitial();
                }
            } else {
                resetToInitial();
            }
        }

        // Resetear a datos iniciales
        function resetToInitial() {
            appData = {
                prospects: initialProspects.map(p => ({...p, status: 'porcontactar'})),
                pipeline: { contactado: [], reunion: [], piloto: [], cliente: [] }
            };
            saveData();
        }

        // Guardar datos en localStorage
        function saveData() {
            appData.lastUpdated = new Date().toISOString();
            localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
        }

        // Exportar datos como JSON
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const blob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'snaro_empresas_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            URL.revokeObjectURL(url);
            showNotification('Datos exportados');
        }

        // Obtener empresas por estado
        function getByStatus(status) {
            return appData.prospects.filter(p => p.status === status);
        }

        // Mover empresa a otra etapa
        function moveCompany(companyId, newStatus) {
            const company = appData.prospects.find(p => p.id === companyId);
            if (company) {
                const oldStatus = company.status;
                company.status = newStatus;
                saveData();
                renderAll();
                showNotification(`${company.name} → ${getStatusLabel(newStatus)}`);
            }
        }

        function getStatusLabel(status) {
            const labels = {
                'porcontactar': 'Por contactar',
                'contactado': 'Contactado',
                'reunion': 'Reunión',
                'piloto': 'Piloto',
                'cliente': 'Cliente'
            };
            return labels[status] || status;
        }

        // Render all views
        function renderAll() {
            updateStatsDashboard();
            renderProspects();
            renderPipeline();
            renderInformes();
        }

        function renderInformes() {
            const container = document.getElementById('informesContent');
            if (!container) return;

            const pipelineStages = ['contactado', 'reunion', 'piloto', 'cliente'];
            let html = '';
            let totalEmpresas = 0;

            pipelineStages.forEach(stage => {
                const companies = getByStatus(stage);
                if (companies.length === 0) return;
                totalEmpresas += companies.length;

                html += `<div class="informe-stage">
                    <div class="informe-stage-title">${getStatusLabel(stage)} — ${companies.length} empresa${companies.length > 1 ? 's' : ''}</div>`;

                companies.forEach(c => {
                    const revenue = parseRevenue(c.detail);
                    const detail = c.detail || '';
                    const employeesMatch = detail.match(/([\d.,]+)\s*empleados/i);
                    const employees = employeesMatch ? employeesMatch[1] : '-';

                    html += `
                    <div class="informe-card stage-${stage}" onclick="openClientDetail(${c.id})">
                        <div class="informe-header">
                            <div class="informe-name">${c.name}</div>
                            <span class="informe-badge ${stage}">${getStatusLabel(stage)}</span>
                        </div>
                        <div class="informe-grid">
                            <div>
                                <div class="informe-dato-label">Sector</div>
                                <div class="informe-dato-value">${c.sector || '-'}</div>
                            </div>
                            <div>
                                <div class="informe-dato-label">Ubicación</div>
                                <div class="informe-dato-value">${c.location || '-'}</div>
                            </div>
                            <div>
                                <div class="informe-dato-label">Facturación</div>
                                <div class="informe-dato-value">${revenue > 0 ? formatRevenue(revenue) : '-'}</div>
                            </div>
                            <div>
                                <div class="informe-dato-label">MRR</div>
                                <div class="informe-dato-value">${c.mrr ? c.mrr.toLocaleString() + '€/mes' : '-'}</div>
                            </div>
                        </div>
                        <div class="informe-grid" style="margin-top: 8px;">
                            <div>
                                <div class="informe-dato-label">Empleados</div>
                                <div class="informe-dato-value">${employees}</div>
                            </div>
                            <div>
                                <div class="informe-dato-label">Prioridad</div>
                                <div class="informe-dato-value">${c.priority || '-'}</div>
                            </div>
                        </div>
                        ${c.notes ? `<div class="informe-notes">${c.notes}</div>` : ''}
                    </div>`;
                });

                html += `</div>`;
            });

            if (totalEmpresas === 0) {
                html = '<div class="informe-empty">No hay empresas en el pipeline.<br>Mueve empresas desde "Por contactar" para ver sus informes aquí.</div>';
            }

            container.innerHTML = html;
        }

        // Vista actual (cards o table)
        let currentView = 'cards';

        function setProspectView(view) {
            currentView = view;
            document.getElementById('viewCards')?.classList.toggle('active', view === 'cards');
            document.getElementById('viewTable')?.classList.toggle('active', view === 'table');
            filterProspects();
        }

        // Render prospects list
        function renderProspects(filteredList = null) {
            const list = document.getElementById('prospectList');
            const count = document.getElementById('prospectCount');
            const filteredCountEl = document.getElementById('filteredCount');
            const prospects = getByStatus('porcontactar');
            const data = filteredList || prospects;

            count.textContent = prospects.length.toLocaleString();
            if (filteredCountEl) {
                filteredCountEl.textContent = `Mostrando ${data.length.toLocaleString()}`;
            }

            // Actualizar dashboard
            updateStatsDashboard();

            if (data.length === 0) {
                list.innerHTML = `
                    <div class="empty-state" style="text-align: center; padding: 60px 20px; color: #666;">
                        <p style="font-size: 18px; margin-bottom: 8px;">Sin resultados</p>
                        <p style="font-size: 13px;">Prueba con otros filtros o segmentos</p>
                    </div>
                `;
                return;
            }

            // Sorting - por defecto por facturación (mayor a menor)
            const sortBy = document.getElementById('sortBy')?.value || 'revenue-desc';
            const sorted = [...data].sort((a, b) => {
                const revA = parseRevenue(a.detail);
                const revB = parseRevenue(b.detail);

                if (sortBy === 'revenue-desc') {
                    return revB - revA;
                } else if (sortBy === 'revenue-asc') {
                    return revA - revB;
                } else if (sortBy === 'name') {
                    return a.name.localeCompare(b.name);
                } else if (sortBy === 'sector') {
                    return a.sector.localeCompare(b.sector);
                }
                return revB - revA; // Default: mayor facturación primero
            });

            // Limitar a 100 para rendimiento inicial (scroll infinito se puede añadir después)
            const displayData = sorted.slice(0, 100);

            // Render based on view
            if (currentView === 'table') {
                list.innerHTML = `
                    <table class="prospect-table">
                        <thead>
                            <tr>
                                <th style="width: 40%;">Empresa</th>
                                <th style="width: 15%;">Facturación</th>
                                <th style="width: 12%;">Tier</th>
                                <th style="width: 13%;">Sector</th>
                                <th style="width: 12%;">Provincia</th>
                                <th style="width: 8%;">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${displayData.map(p => {
                                const revenue = parseRevenue(p.detail);
                                const tier = getRevenueTier(revenue);
                                return `
                                <tr onclick="openProspectDetail(${p.id})" style="cursor: pointer;">
                                    <td>
                                        <span class="company-name" style="font-weight: 500;">${p.name}</span>
                                    </td>
                                    <td style="font-weight: 500; font-size: 14px;">${formatRevenue(revenue)}</td>
                                    <td><span class="tier-badge tier-${tier}">${getTierName(tier)}</span></td>
                                    <td style="font-size: 12px; color: #666;">${p.sector}</td>
                                    <td style="font-size: 12px; color: #666;">${p.location.split(',')[1]?.trim() || p.location}</td>
                                    <td>
                                        <div class="quick-actions" style="display: flex; gap: 4px;">
                                            <button class="quick-btn" onclick="event.stopPropagation(); moveToContactado(${p.id})" title="Contactar">→</button>
                                            <button class="quick-btn" onclick="event.stopPropagation(); markNotInterested(${p.id})" title="Descartar">✕</button>
                                        </div>
                                    </td>
                                </tr>
                            `}).join('')}
                        </tbody>
                    </table>
                    ${sorted.length > 100 ? `<div style="text-align: center; padding: 20px; color: #666; font-size: 13px;">Mostrando 100 de ${sorted.length.toLocaleString()} empresas. Usa filtros para refinar la búsqueda.</div>` : ''}
                `;
            } else {
                list.innerHTML = displayData.map(p => {
                    const revenue = parseRevenue(p.detail);
                    const tier = getRevenueTier(revenue);
                    const provincia = p.location.split(',')[1]?.trim() || p.location;
                    return `
                    <div class="prospect-card-enhanced" onclick="openProspectDetail(${p.id})">
                        <button class="card-dismiss-btn" onclick="event.stopPropagation(); markNotInterested(${p.id})" title="Descartar">✕</button>
                        <div class="tier-indicator ${tier}"></div>
                        <div class="prospect-main-info">
                            <div class="company-name">${p.name}</div>
                            <div class="company-tags">
                                <span class="tag-sector">${p.sector}</span>
                                <span class="tag-location">${provincia}</span>
                                <span class="tier-badge tier-${tier}">${getTierName(tier)}</span>
                            </div>
                        </div>
                        <div class="prospect-revenue-section">
                            <div class="revenue-amount">${formatRevenue(revenue)}</div>
                        </div>
                    </div>
                `}).join('') + (sorted.length > 100 ? `<div style="text-align: center; padding: 20px; color: #666; font-size: 13px;">Mostrando 100 de ${sorted.length.toLocaleString()} empresas. Usa filtros para refinar.</div>` : '');
            }
        }

        // Marcar como interesante (subir prioridad)
        function markInterested(id) {
            event.stopPropagation();
            const company = appData.prospects.find(p => p.id === id);
            if (company) {
                company.priority = 'high';
                saveData();
                filterProspects();
                showNotification(`${company.name} → Alta prioridad`);
            }
        }

        // Marcar como no interesa
        function markNotInterested(id) {
            event.stopPropagation();
            const company = appData.prospects.find(p => p.id === id);
            if (company && confirm(`¿Descartar "${company.name}"?`)) {
                company.status = 'descartado';
                saveData();
                filterProspects();
                showNotification(`${company.name} descartada`);
            }
        }

        // Filter prospects
        function filterProspects() {
            const search = document.getElementById('searchProspects')?.value.toLowerCase() || '';
            const sector = document.getElementById('filterSector')?.value || '';
            const location = document.getElementById('filterLocation')?.value || '';

            let filtered = getByStatus('porcontactar');

            // Tier filter (from pills or dashboard)
            if (activeTierFilter) {
                filtered = filtered.filter(p => {
                    const revenue = parseRevenue(p.detail);
                    const tier = getRevenueTier(revenue);
                    return tier === activeTierFilter;
                });
            }

            // Text search
            if (search) {
                filtered = filtered.filter(p =>
                    p.name.toLowerCase().includes(search) ||
                    p.sector.toLowerCase().includes(search) ||
                    p.location.toLowerCase().includes(search)
                );
            }

            // Sector filter
            if (sector) {
                filtered = filtered.filter(p =>
                    p.sector.toLowerCase().includes(sector.toLowerCase())
                );
            }

            // Location filter
            if (location) {
                filtered = filtered.filter(p =>
                    p.location.toLowerCase().includes(location.toLowerCase())
                );
            }

            renderProspects(filtered);
        }

        // Render pipeline columns
        function renderPipeline() {
            const stages = ['contactado', 'reunion', 'piloto', 'cliente'];
            let totalPotencial = 0;
            let totalActual = 0;
            let clientesActivos = 0;

            stages.forEach(stage => {
                const companies = getByStatus(stage);
                const col = document.getElementById('col-' + stage);
                const header = col.querySelector('.column-header');
                const countEl = header.querySelector('.column-count');

                // Calcular MRR real por empresa
                const mrr = companies.reduce((sum, c) => sum + (c.mrr || 0), 0);

                if (stage === 'cliente') {
                    totalActual = mrr;
                    clientesActivos = companies.length;
                    countEl.textContent = mrr.toLocaleString() + '€';
                } else {
                    totalPotencial += mrr;
                    countEl.textContent = mrr.toLocaleString() + '€';
                }

                // Render cards
                const stageColor = { contactado: '#ef4444', reunion: '#f59e0b', piloto: '#facc15', cliente: '#22c55e' };
                const cardsHtml = companies.length > 0
                    ? companies.map(c => `
                        <div class="client-card" onclick="openClientDetail(${c.id})" style="display:flex;align-items:flex-start">
                            <span class="semaforo" style="background:${stageColor[stage]};margin-top:5px"></span>
                            <div style="flex:1;min-width:0">
                                <div class="name">${c.name}</div>
                                <div class="sector">${c.sector}</div>
                                <div class="mrr ${stage === 'cliente' ? 'active' : ''}">${c.mrr ? c.mrr.toLocaleString() + '€/mes' : '-'}</div>
                            </div>
                        </div>
                    `).join('')
                    : `<div class="empty-column">Sin empresas</div>`;

                // Clear and re-render
                const existingCards = col.querySelectorAll('.client-card, .empty-column');
                existingCards.forEach(el => el.remove());
                col.insertAdjacentHTML('beforeend', cardsHtml);
            });

            // Update summary
            document.getElementById('mrrPotencial').textContent = totalPotencial.toLocaleString() + '€';
            document.getElementById('mrrActual').textContent = totalActual.toLocaleString() + '€';
            document.getElementById('empresasActivas').textContent = clientesActivos;
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            loadData();
            renderAll();
        });

        // View switching
        function showView(viewName) {
            // Hide all views
            document.querySelectorAll('.view').forEach(v => {
                v.style.display = 'none';
            });

            // Show selected view
            const view = document.getElementById('view-' + viewName);
            if (view) {
                view.style.display = 'block';
            }

            // Update sidebar active state
            document.querySelectorAll('.sidebar-item[data-view]').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === viewName) {
                    item.classList.add('active');
                }
            });

            // Update mobile menu active state
            document.querySelectorAll('.mobile-menu-item[data-view]').forEach(item => {
                item.classList.remove('active');
                if (item.dataset.view === viewName) {
                    item.classList.add('active');
                }
            });

            // Mostrar botón + solo en Empresas
            const addBtn = document.querySelector('.btn-add');
            if (addBtn) {
                addBtn.style.display = viewName === 'porcontactar' ? 'flex' : 'none';
            }
        }

        // Toggle mobile menu
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            const overlay = document.getElementById('mobileMenuOverlay');
            menu.classList.toggle('open');
            overlay.classList.toggle('open');
        }

        // Move company to Contactado
        function moveToContactado(companyId) {
            moveCompany(companyId, 'contactado');
        }

        // Simple notification
        function showNotification(message) {
            const notif = document.createElement('div');
            notif.style.cssText = `
                position: fixed;
                bottom: 40px;
                left: 50%;
                transform: translateX(-50%);
                background: #000;
                color: #fff;
                padding: 12px 24px;
                font-size: 13px;
                z-index: 2000;
            `;
            notif.textContent = message;
            document.body.appendChild(notif);

            setTimeout(() => {
                notif.remove();
            }, 2000);
        }

        // Open prospect detail
        function openProspectDetail(companyId) {
            const company = appData.prospects.find(p => p.id === companyId);
            if (!company) return;
            populateDetailModal(company);
            document.getElementById('clientDetailModal').classList.add('active');
        }

        // Modal functions
        function openAddModal() {
            document.getElementById('addModal').classList.add('active');
        }

        function closeAddModal() {
            document.getElementById('addModal').classList.remove('active');
            document.getElementById('investigationLoading').style.display = 'none';
            document.getElementById('investigationResults').style.display = 'none';
        }

        function openClientDetail(clientId) {
            const company = appData.prospects.find(p => p.id === clientId);
            if (!company) return;
            populateDetailModal(company);
            document.getElementById('clientDetailModal').classList.add('active');
        }

        let currentDetailCompanyId = null;

        function saveCompanyDetails() {
            if (!currentDetailCompanyId) return;
            const company = appData.prospects.find(p => p.id === currentDetailCompanyId);
            if (!company) return;

            company.name = document.getElementById('editName').value.trim() || company.name;
            company.sector = document.getElementById('editSector').value.trim();
            company.location = document.getElementById('editLocation').value.trim();
            company.priority = document.getElementById('editPriority').value;
            company.mrr = parseInt(document.getElementById('editMrr').value) || 0;
            company.notes = document.getElementById('editNotes').value.trim();

            const facVal = document.getElementById('editFacturacion').value.trim();
            const empVal = document.getElementById('editEmpleados').value.trim();
            company.detail = `Facturación: ${facVal || '0'}M€ · ${empVal || '0'} empleados`;

            // Update header in modal
            document.getElementById('detailName').textContent = company.name;
            document.getElementById('detailSector').textContent = company.sector;

            saveData();
            renderAll();
            syncToCloud(company);
            showNotification(company.name + ' guardado');
        }

        function saveInvestigation() {
            if (!currentDetailCompanyId) return;
            const company = appData.prospects.find(p => p.id === currentDetailCompanyId);
            if (!company) return;

            company.contacto = document.getElementById('editContacto').value.trim();
            company.cargo = document.getElementById('editCargo').value.trim();
            company.telefono = document.getElementById('editTelefono').value.trim();
            company.email = document.getElementById('editEmail').value.trim();
            company.cif = document.getElementById('editCif').value.trim();
            company.web = document.getElementById('editWeb').value.trim();
            company.necesidad = document.getElementById('editNecesidad').value.trim();
            company.notasInv = document.getElementById('editNotasInv').value.trim();
            company.oportunidades = document.getElementById('editOportunidades').value.trim();

            saveData();
            renderAll();
            syncToCloud(company);
            showNotification(company.name + ' — investigación guardada');
        }

        function updateCompanyStatus() {
            if (!currentDetailCompanyId) return;
            const newStatus = document.getElementById('moveStatusSelect').value;
            moveCompany(currentDetailCompanyId, newStatus);
            closeClientDetail();
        }

        function populateDetailModal(company) {
            currentDetailCompanyId = company.id;
            document.getElementById('detailName').textContent = company.name;
            document.getElementById('detailSector').textContent = company.sector || '';
            document.getElementById('detailStatus').textContent = getStatusLabel(company.status || 'porcontactar');

            // Pre-seleccionar estado actual en el select de "Mover a"
            const moveSelect = document.getElementById('moveStatusSelect');
            if (moveSelect) moveSelect.value = company.status || 'porcontactar';

            // Parse detail field for revenue and employees
            const revenue = parseRevenue(company.detail);
            const detail = company.detail || '';
            const employeesMatch = detail.match(/([\d.,]+)\s*empleados/i);
            const employees = employeesMatch ? employeesMatch[1] : '-';

            // Update info tab - all editable
            const infoTab = document.getElementById('tab-info');
            if (infoTab) {
                const facMatch = (company.detail || '').match(/([\d.,]+)M€/);
                const facValue = facMatch ? facMatch[1] : '';

                infoTab.innerHTML = `
                    <div class="form-group">
                        <label>Nombre</label>
                        <input type="text" id="editName" value="${company.name || ''}">
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Sector</label>
                            <input type="text" id="editSector" value="${company.sector || ''}">
                        </div>
                        <div class="form-group">
                            <label>Ubicación</label>
                            <input type="text" id="editLocation" value="${company.location || ''}">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Facturación (M€)</label>
                            <input type="text" id="editFacturacion" value="${facValue}" placeholder="0">
                        </div>
                        <div class="form-group">
                            <label>Empleados</label>
                            <input type="text" id="editEmpleados" value="${employees !== '-' ? employees : ''}" placeholder="0">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Prioridad</label>
                            <select id="editPriority">
                                <option value="low" ${company.priority === 'low' ? 'selected' : ''}>Baja</option>
                                <option value="medium" ${company.priority === 'medium' ? 'selected' : ''}>Media</option>
                                <option value="high" ${company.priority === 'high' ? 'selected' : ''}>Alta</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>MRR (€/mes)</label>
                            <input type="number" id="editMrr" value="${company.mrr || ''}" placeholder="0" min="0">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Notas</label>
                        <textarea id="editNotes" rows="3" placeholder="Añade notas sobre esta empresa...">${company.notes || ''}</textarea>
                    </div>
                    <div style="display: flex; gap: 12px; margin-top: 24px;">
                        <button class="btn btn-primary" style="flex: 1;" onclick="saveCompanyDetails()">Guardar cambios</button>
                        <button class="detail-contact-btn" onclick="moveToContactado(${company.id}); closeClientDetail();">Contactar</button>
                    </div>
                `;
            }

            // Update activity tab
            const actTab = document.getElementById('tab-activity');
            if (actTab) {
                const status = company.status || 'porcontactar';
                const actItems = [];
                if (status === 'cliente') actItems.push({ icon: '✓', text: 'Cliente activo', desc: 'Empresa convertida a cliente' });
                if (status === 'piloto') actItems.push({ icon: '◉', text: 'Piloto en curso', desc: 'Prueba de servicio iniciada' });
                if (status === 'reunion') actItems.push({ icon: '→', text: 'Reunión programada', desc: 'Pendiente de reunión comercial' });
                if (status === 'contactado') actItems.push({ icon: '·', text: 'Primer contacto realizado', desc: 'Empresa contactada' });
                if (status !== 'porcontactar') actItems.push({ icon: '○', text: 'Añadida al pipeline', desc: 'Empresa identificada como oportunidad' });

                actTab.innerHTML = `
                    <ul class="activity-log">
                        ${actItems.map(a => `
                            <li class="activity-item">
                                <div class="activity-icon">${a.icon}</div>
                                <div class="activity-content">
                                    <strong>${a.text}</strong>
                                    <p>${a.desc}</p>
                                </div>
                            </li>
                        `).join('')}
                        ${actItems.length === 0 ? '<li class="activity-item"><div class="activity-content"><p style="color:#999;">Sin actividad registrada</p></div></li>' : ''}
                    </ul>
                `;
            }

            // Update investigation tab - datos auto-generados + editable
            const invTab = document.getElementById('tab-investigation');
            if (invTab) {
                const rev = parseRevenue(company.detail);
                const detailStr = company.detail || '';
                const empMatch = detailStr.match(/([\d.,]+)\s*empleados/i);
                const empNum = empMatch ? empMatch[1] : '-';
                const facText = rev > 0 ? rev.toFixed(1) + 'M€' : '-';

                invTab.innerHTML = `
                    <div class="info-grid" style="margin-bottom: 24px;">
                        <div class="info-item">
                            <div class="label">Facturación</div>
                            <div class="value">${facText}</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Empleados</div>
                            <div class="value">${empNum}</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Sector</div>
                            <div class="value">${company.sector || '-'}</div>
                        </div>
                        <div class="info-item">
                            <div class="label">Ubicación</div>
                            <div class="value">${company.location || '-'}</div>
                        </div>
                    </div>

                    <div>
                        <h5 style="margin-bottom: 16px; font-size: 11px; text-transform: uppercase; letter-spacing: 0.1em; color: #999;">Datos de contacto</h5>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Contacto</label>
                                <input type="text" id="editContacto" value="${company.contacto || ''}" placeholder="Nombre del contacto">
                            </div>
                            <div class="form-group">
                                <label>Cargo</label>
                                <input type="text" id="editCargo" value="${company.cargo || ''}" placeholder="Director, Gerente...">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Teléfono</label>
                                <input type="text" id="editTelefono" value="${company.telefono || ''}" placeholder="944 123 456">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" id="editEmail" value="${company.email || ''}" placeholder="contacto@empresa.com">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>CIF</label>
                                <input type="text" id="editCif" value="${company.cif || ''}" placeholder="B12345678">
                            </div>
                            <div class="form-group">
                                <label>Web</label>
                                <input type="text" id="editWeb" value="${company.web || ''}" placeholder="www.empresa.com">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Necesidad detectada</label>
                            <textarea id="editNecesidad" rows="2" placeholder="¿Qué problema tienen? ¿Qué buscan?">${company.necesidad || ''}</textarea>
                        </div>
                        <div class="form-group">
                            <label>Notas de investigación</label>
                            <textarea id="editNotasInv" rows="3" placeholder="Datos del registro mercantil, noticias, LinkedIn...">${company.notasInv || ''}</textarea>
                        </div>
                    </div>

                    <button class="btn btn-primary" style="width: 100%; margin-top: 16px;" onclick="saveInvestigation()">Guardar investigación</button>
                `;
            }
        }

        function generateOpportunities(company) {
            const opps = [];
            const rev = parseRevenue(company.detail);
            const detail = company.detail || '';
            const employeesMatch = detail.match(/([\d.,]+)\s*empleados/i);
            const empCount = employeesMatch ? parseInt(employeesMatch[1].replace(/\./g, '')) : 0;
            const sector = (company.sector || '').toLowerCase();

            if (rev > 50) {
                opps.push('Facturación alta — Mayor capacidad de inversión en automatización');
            }
            if (empCount > 20) {
                opps.push('Plantilla amplia — Potencial ahorro en costes de personal con automatización');
            }
            if (sector.includes('distribu') || sector.includes('logist') || sector.includes('transporte')) {
                opps.push('Automatización de pedidos y rutas — Sector con muchos procesos repetitivos');
            }
            if (sector.includes('fabric') || sector.includes('industri')) {
                opps.push('Control de producción e inventario — Sector con alta complejidad operativa');
            }
            if (sector.includes('comercio') || sector.includes('alimenta')) {
                opps.push('Gestión de stock y proveedores — Sector con alto volumen transaccional');
            }
            if (sector.includes('servicio')) {
                opps.push('Gestión documental y facturación — Sector con mucha carga administrativa');
            }
            if (sector.includes('energía') || sector.includes('energia')) {
                opps.push('Reporting y cumplimiento normativo — Sector altamente regulado');
            }
            if (sector.includes('construc')) {
                opps.push('Control de obra y certificaciones — Sector con documentación intensiva');
            }
            if (opps.length === 0) {
                opps.push('Automatización de procesos administrativos — Aplicable a cualquier empresa');
            }

            return opps;
        }

        function generateOpportunitiesText(company) {
            return generateOpportunities(company).map(o => '→ ' + o).join('\n');
        }

        function generateOpportunitiesHtml(company) {
            return generateOpportunities(company).map(o => `
                <div class="opportunity-item">
                    <span>→</span>
                    <span>${o}</span>
                </div>
            `).join('');
        }

        function closeClientDetail() {
            document.getElementById('clientDetailModal').classList.remove('active');
        }

        // Tab switching
        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('tab-' + tabName).classList.add('active');
        }

        // Investigation simulation
        function investigateCompany() {
            const name = document.getElementById('companyName').value;
            if (!name) {
                alert('Introduce el nombre de la empresa');
                return;
            }

            document.getElementById('investigationLoading').style.display = 'block';
            document.getElementById('investigationResults').style.display = 'none';

            setTimeout(() => {
                document.getElementById('investigationLoading').style.display = 'none';
                document.getElementById('investigationResults').style.display = 'block';

                document.getElementById('resFacturacion').textContent = (Math.random() * 5 + 1).toFixed(1) + 'M€';
                document.getElementById('resEmpleados').textContent = Math.floor(Math.random() * 80 + 10);
                document.getElementById('resConstitucion').textContent = '12/05/' + (2000 + Math.floor(Math.random() * 20));

                const auditorias = ['15/03/2025', '22/06/2024', 'No consta', '08/11/2023'];
                document.getElementById('resAuditoria').textContent = auditorias[Math.floor(Math.random() * auditorias.length)];

                const alerts = [
                    { text: 'Retraso en depósito de cuentas anuales', date: 'BORME' },
                    { text: 'Cambio en la dirección de la empresa', date: 'Expansión — Enero 2026' },
                    { text: 'Sanción AEPD por incumplimiento RGPD', date: 'BOE — 2024' },
                    { text: 'Caída de facturación del 15% vs año anterior', date: 'Registro Mercantil' }
                ];

                const alertsList = document.getElementById('alertsList');
                alertsList.innerHTML = '';
                const numAlerts = Math.floor(Math.random() * 3) + 1;
                for (let i = 0; i < numAlerts; i++) {
                    const alert = alerts[Math.floor(Math.random() * alerts.length)];
                    alertsList.innerHTML += `
                        <div class="alert-item">
                            <span class="icon">—</span>
                            <div>
                                <div class="text">${alert.text}</div>
                                <div class="date">${alert.date}</div>
                            </div>
                        </div>
                    `;
                }

                const opportunities = [
                    'Automatización de facturas — Probable alto volumen',
                    'Gestión de pedidos — Sector distribución',
                    'Dashboard BI — Empresa en crecimiento',
                    'Cumplimiento RGPD — Tuvieron sanción',
                    'Gestión documental — Cuentas no al día'
                ];

                const oppList = document.getElementById('opportunitiesList');
                oppList.innerHTML = '';
                const numOpps = Math.floor(Math.random() * 2) + 2;
                for (let i = 0; i < numOpps; i++) {
                    const opp = opportunities[Math.floor(Math.random() * opportunities.length)];
                    oppList.innerHTML += `<div class="opportunity-item"><span>→</span><span>${opp}</span></div>`;
                }

            }, 1500);
        }

        function saveCompany() {
            alert('Empresa guardada en el pipeline');
            closeAddModal();
        }

        // Close modals on outside click
        document.querySelectorAll('.modal-overlay').forEach(overlay => {
            overlay.addEventListener('click', (e) => {
                if (e.target === overlay) {
                    overlay.classList.remove('active');
                }
            });
        });

        // Calendar
        let currentDate = new Date();
        const monthNames = ['Enero', 'Febrero', 'Marzo', 'Abril', 'Mayo', 'Junio',
                           'Julio', 'Agosto', 'Septiembre', 'Octubre', 'Noviembre', 'Diciembre'];
        const monthNamesShort = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun',
                                 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];

        // Auditorías - starts empty, se llenará cuando haya empresas
        const audits = [];

        function renderCalendar() {
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();

            document.getElementById('calendarMonth').textContent = monthNames[month] + ' ' + year;

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const daysInMonth = lastDay.getDate();

            let startDay = firstDay.getDay() - 1;
            if (startDay < 0) startDay = 6;

            const today = new Date();
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';

            // Empty cells before first day
            for (let i = 0; i < startDay; i++) {
                const cell = document.createElement('div');
                cell.className = 'mini-day empty';
                calendarDays.appendChild(cell);
            }

            // Days of month
            for (let day = 1; day <= daysInMonth; day++) {
                const cell = document.createElement('div');
                const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;

                const isToday = today.getDate() === day &&
                               today.getMonth() === month &&
                               today.getFullYear() === year;

                const hasAudit = audits.some(a => a.date === dateStr);

                let classes = 'mini-day';
                if (isToday) classes += ' today';
                if (hasAudit) classes += ' has-audit';

                cell.className = classes;
                cell.textContent = day;

                calendarDays.appendChild(cell);
            }

            // Fill remaining cells
            const totalCells = startDay + daysInMonth;
            const remaining = 7 - (totalCells % 7);
            if (remaining < 7) {
                for (let i = 0; i < remaining; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'mini-day empty';
                    calendarDays.appendChild(cell);
                }
            }

            renderAuditList();
        }

        function renderAuditList() {
            const list = document.getElementById('auditList');
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Filtrar auditorías futuras y ordenar por fecha
            const upcomingAudits = audits
                .filter(a => new Date(a.date) >= today)
                .sort((a, b) => new Date(a.date) - new Date(b.date));

            if (upcomingAudits.length === 0) {
                list.innerHTML = `
                    <div class="no-audits">
                        <p>Sin auditorías programadas</p>
                        <p class="no-audits-hint">Las auditorías aparecerán aquí cuando añadas empresas</p>
                    </div>
                `;
                return;
            }

            list.innerHTML = upcomingAudits.map(a => {
                const date = new Date(a.date);
                return `
                    <div class="audit-card">
                        <div class="audit-date-box">
                            <div class="audit-date-day">${date.getDate()}</div>
                            <div class="audit-date-month">${monthNamesShort[date.getMonth()]}</div>
                        </div>
                        <div class="audit-details">
                            <div class="audit-company">${a.company}</div>
                            <div class="audit-type">${a.type}</div>
                            <span class="audit-tag">${a.tag || 'Auditoría'}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function changeMonth(delta) {
            currentDate.setMonth(currentDate.getMonth() + delta);
            renderCalendar();
        }

        // Initialize calendar when viewing
        const origShowView = showView;
        showView = function(viewName) {
            origShowView(viewName);
            if (viewName === 'calendario') {
                renderCalendar();
            }
        };

        // ============================================
        // SUPABASE CLOUD SYNC
        // ============================================

        const SUPABASE_CONFIG_KEY = 'snaro_supabase_config';
        const SUPABASE_URL = 'https://ubdlhszgaehlzlfkxbcq.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InViZGxoc3pnYWVobHpsZmt4YmNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAzMDczNDUsImV4cCI6MjA4NTg4MzM0NX0._TLSNagvsjSp8Z8zB9I5Oh0dqtg1ARptmjqpXSngFd8';
        let supabaseClient = null;
        let isCloudConnected = false;

        // Initialize on load - auto connect
        (function initSupabase() {
            connectToSupabase(SUPABASE_URL, SUPABASE_KEY);
        })();

        async function connectToSupabase(url, key) {
            try {
                supabaseClient = window.supabase.createClient(url, key);
                const { error } = await supabaseClient.from('prospects').select('count');
                if (!error) {
                    isCloudConnected = true;
                    updateConnectionBadge(true);
                    await syncFromCloud();
                }
            } catch (e) {
                updateConnectionBadge(false);
            }
        }

        function updateConnectionBadge(online) {
            const badge = document.getElementById('connectionBadge');
            const text = document.getElementById('connectionText');
            const syncBtn = document.getElementById('syncBtn');
            badge.className = online ? 'connection-badge online' : 'connection-badge offline';
            text.textContent = online ? 'Nube' : 'Local';
            if (syncBtn) syncBtn.style.display = online ? 'block' : 'none';
        }

        async function syncFromCloud() {
            if (!supabaseClient) return;
            try {
                const { data, error } = await supabaseClient.from('prospects').select('*').order('id');
                if (!error && data && data.length > 0) {
                    // Merge: cloud wins unless local has newer changes
                    const localMap = {};
                    appData.prospects.forEach(p => { localMap[p.id] = p; });

                    const merged = initialProspects.map(ip => {
                        const cloud = data.find(d => d.id === ip.id);
                        const local = localMap[ip.id];

                        // Cloud has modifications → use cloud
                        if (cloud && (cloud.status !== 'porcontactar' || cloud.notes || cloud.contacto || cloud.notasInv)) {
                            return { ...ip, ...cloud };
                        }
                        // Local has modifications → use local
                        if (local && (local.status !== 'porcontactar' || local.notes || local.contacto || local.notasInv)) {
                            return { ...ip, ...local };
                        }
                        // Neither modified → use initial + cloud data
                        return cloud ? { ...ip, ...cloud } : { ...ip, status: 'porcontactar' };
                    });

                    appData.prospects = merged;
                    saveData();
                    renderAll();

                    // Push local modifications to cloud
                    await syncAllToCloud();
                    showNotification('Sincronizado');
                }
            } catch (e) {}
        }

        async function syncToCloud(prospect) {
            if (!supabaseClient || !isCloudConnected) return;
            try {
                await supabaseClient.from('prospects')
                    .update({
                        name: prospect.name,
                        sector: prospect.sector,
                        location: prospect.location,
                        priority: prospect.priority,
                        detail: prospect.detail,
                        status: prospect.status || 'porcontactar',
                        notes: prospect.notes || '',
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', prospect.id);
            } catch (e) {}
        }

        async function syncAllToCloud() {
            if (!supabaseClient || !isCloudConnected) return;
            const modified = appData.prospects.filter(p =>
                p.status !== 'porcontactar' || p.notes || p.contacto || p.notasInv || p.mrr
            );
            for (const p of modified) {
                await syncToCloud(p);
            }
        }

        // Override to sync
        const _origMove = moveCompany;
        moveCompany = function(id, status) {
            _origMove(id, status);
            const p = appData.prospects.find(x => x.id === id);
            if (p) syncToCloud(p);
        };

        function showSupabaseConfig() {
            const config = localStorage.getItem(SUPABASE_CONFIG_KEY);
            const parsed = config ? JSON.parse(config) : { url: '', key: '' };
            document.getElementById('supabaseModalContent').innerHTML = `
                <div style="padding: 8px;">
                    <p style="font-size: 13px; color: #666; margin-bottom: 20px;">
                        Conecta con <a href="https://supabase.com" target="_blank" style="color:#000">Supabase</a> (gratis) para sincronizar.
                    </p>
                    <div style="margin-bottom: 12px;">
                        <label style="font-size: 10px; color: #999;">PROJECT URL</label>
                        <input type="text" id="supabaseUrl" value="${parsed.url}" placeholder="https://xxx.supabase.co"
                            style="width:100%; padding:10px; border:1px solid #e0e0e0; border-radius:6px; font-size:12px; font-family:monospace; margin-top:4px;">
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="font-size: 10px; color: #999;">ANON KEY</label>
                        <input type="text" id="supabaseKey" value="${parsed.key}" placeholder="eyJhbGci..."
                            style="width:100%; padding:10px; border:1px solid #e0e0e0; border-radius:6px; font-size:12px; font-family:monospace; margin-top:4px;">
                    </div>
                    <div style="display:flex; gap:12px;">
                        <button onclick="saveSupabaseConfig()" style="flex:1; padding:12px; background:#000; color:#fff; border:none; border-radius:6px; cursor:pointer;">Conectar</button>
                        <button onclick="disconnectSupabase()" style="padding:12px 16px; background:#fff; border:1px solid #e0e0e0; border-radius:6px; cursor:pointer;">Desconectar</button>
                    </div>
                    <p style="font-size:11px; color:#999; margin-top:16px; text-align:center;">
                        ${isCloudConnected ? '✓ Conectado' : 'Modo local'} · ${appData.prospects.length} empresas
                    </p>
                </div>`;
            document.getElementById('supabaseModal').classList.add('active');
        }

        async function saveSupabaseConfig() {
            const url = document.getElementById('supabaseUrl').value.trim();
            const key = document.getElementById('supabaseKey').value.trim();
            if (!url || !key) { showNotification('Introduce URL y Key'); return; }
            localStorage.setItem(SUPABASE_CONFIG_KEY, JSON.stringify({ url, key }));
            await connectToSupabase(url, key);
            if (isCloudConnected) {
                document.getElementById('supabaseModal').classList.remove('active');
                showNotification('Conectado a Supabase');
            } else {
                showNotification('Error de conexión');
            }
        }

        function disconnectSupabase() {
            localStorage.removeItem(SUPABASE_CONFIG_KEY);
            supabaseClient = null;
            isCloudConnected = false;
            updateConnectionBadge(false);
            document.getElementById('supabaseModal').classList.remove('active');
            showNotification('Desconectado');
        }

        // Theme toggle
        function toggleTheme() {
            const body = document.body;
            body.classList.toggle('dark');
            const isDark = body.classList.contains('dark');
            document.querySelectorAll('.theme-toggle').forEach(btn => {
                btn.textContent = isDark ? '🌙' : '☀️';
            });
            localStorage.setItem('snaro-theme', isDark ? 'dark' : 'light');
        }

        // Load saved theme
        (function loadTheme() {
            const saved = localStorage.getItem('snaro-theme');
            if (saved === 'dark') {
                document.body.classList.add('dark');
                document.querySelectorAll('.theme-toggle').forEach(btn => {
                    btn.textContent = '🌙';
                });
            }
        })();

        // ============================================
        // AUTHENTICATION
        // ============================================

        const APP_PASSWORD = 'pipelinesnaro';
        const AUTH_KEY = 'snaro_auth';

        // Check session on load
        function checkAuth() {
            const auth = localStorage.getItem(AUTH_KEY);
            if (auth) {
                showApp();
            } else {
                showLogin();
            }
        }

        function showApp() {
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('appContainer').classList.remove('hidden');
            document.getElementById('sidebarLogout').style.display = 'block';
        }

        function showLogin() {
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('appContainer').classList.add('hidden');
            document.getElementById('sidebarLogout').style.display = 'none';
        }

        function handleLogin(event) {
            event.preventDefault();

            const name = document.getElementById('loginName').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            const btn = document.getElementById('loginBtn');

            if (password === APP_PASSWORD) {
                localStorage.setItem(AUTH_KEY, JSON.stringify({ name: name, loggedAt: Date.now() }));
                showApp();
            } else {
                errorEl.style.color = '#ff3b30';
                errorEl.textContent = 'Contraseña incorrecta';
                errorEl.style.display = 'block';
            }
        }

        function logout() {
            localStorage.removeItem(AUTH_KEY);
            showLogin();
            document.getElementById('loginName').value = '';
            document.getElementById('loginPassword').value = '';
            document.getElementById('loginError').style.display = 'none';
        }

        function getCurrentUser() {
            const auth = localStorage.getItem(AUTH_KEY);
            return auth ? JSON.parse(auth).name : null;
        }

        // Initialize auth check
        document.addEventListener('DOMContentLoaded', checkAuth);
    </script>

    </div><!-- End app-container -->

    <!-- Logout button removed - now in sidebar -->

    <!-- Menú móvil hamburguesa -->
    <button class="mobile-menu-btn" onclick="toggleMobileMenu()"><img src="logo.png" alt="Menu" class="mobile-menu-logo"></button>
    <div class="mobile-menu-overlay" id="mobileMenuOverlay" onclick="toggleMobileMenu()"></div>
    <nav class="mobile-menu" id="mobileMenu">
        <div class="mobile-menu-header">
            <button class="mobile-menu-close" onclick="toggleMobileMenu()">✕</button>
        </div>
        <div class="mobile-menu-items">
            <button class="mobile-menu-item active" onclick="showView('pipeline'); toggleMobileMenu();" data-view="pipeline">
                <span>◉</span> Pipeline
            </button>
            <button class="mobile-menu-item" onclick="showView('porcontactar'); toggleMobileMenu();" data-view="porcontactar">
                <span>▤</span> Empresas
            </button>
            <button class="mobile-menu-item" onclick="showView('calendario'); toggleMobileMenu();" data-view="calendario">
                <span>▦</span> Calendario
            </button>
            <button class="mobile-menu-item" onclick="showView('informes'); toggleMobileMenu();" data-view="informes">
                <span>◧</span> Informes
            </button>
            <button class="mobile-logout-btn" onclick="logout(); toggleMobileMenu();">
                Cerrar sesión
            </button>
        </div>
    </nav>
</body>
</html>
